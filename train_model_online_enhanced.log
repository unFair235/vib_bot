/Users/igorbulgakov/Library/Python/3.9/lib/python/site-packages/urllib3/__init__.py:35: NotOpenSSLWarning: urllib3 v2 only supports OpenSSL 1.1.1+, currently the 'ssl' module is compiled with 'LibreSSL 2.8.3'. See: https://github.com/urllib3/urllib3/issues/3020
  warnings.warn(
2025-03-27 07:53:41,157 [INFO] Training database initialized (merged_training_data and feedback tables ensured).
2025-03-27 07:53:41,158 [INFO] Model loaded successfully.
2025-03-27 07:53:41,171 [INFO] Loaded extras data from DB: 2000 rows.
2025-03-27 07:53:41,181 [INFO] Loaded trades data from DB: 4186 rows.
2025-03-27 07:53:41,182 [INFO] Loaded orderbook data from DB: 12 rows.
Traceback (most recent call last):
  File "/Users/igorbulgakov/Library/Python/3.9/lib/python/site-packages/pandas/core/indexes/base.py", line 3805, in get_loc
    return self._engine.get_loc(casted_key)
  File "index.pyx", line 167, in pandas._libs.index.IndexEngine.get_loc
  File "index.pyx", line 196, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 7081, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 7089, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'TradeTime'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/igorbulgakov/Documents/vib_bot/train_model_online_enhanced.py", line 306, in <module>
    main_loop()
  File "/Users/igorbulgakov/Documents/vib_bot/train_model_online_enhanced.py", line 302, in main_loop
    run_ml_inference(model)
  File "/Users/igorbulgakov/Documents/vib_bot/train_model_online_enhanced.py", line 272, in run_ml_inference
    merged_result = merge_data(df_extras, df_trades, df_orderbook)
  File "/Users/igorbulgakov/Documents/vib_bot/train_model_online_enhanced.py", line 179, in merge_data
    (df_trades["TradeTime"] >= latest_candle["close_time"] - timedelta(minutes=5)) &
  File "/Users/igorbulgakov/Library/Python/3.9/lib/python/site-packages/pandas/core/frame.py", line 4102, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/igorbulgakov/Library/Python/3.9/lib/python/site-packages/pandas/core/indexes/base.py", line 3812, in get_loc
    raise KeyError(key) from err
KeyError: 'TradeTime'
/Users/igorbulgakov/Library/Python/3.9/lib/python/site-packages/urllib3/__init__.py:35: NotOpenSSLWarning: urllib3 v2 only supports OpenSSL 1.1.1+, currently the 'ssl' module is compiled with 'LibreSSL 2.8.3'. See: https://github.com/urllib3/urllib3/issues/3020
  warnings.warn(
2025-03-27 07:54:10,164 [INFO] Training database initialized (merged_training_data and feedback tables ensured).
2025-03-27 07:54:10,165 [INFO] Model loaded successfully.
2025-03-27 07:54:10,172 [INFO] Loaded extras data from DB: 2000 rows.
2025-03-27 07:54:10,179 [INFO] Loaded trades data from DB: 4186 rows.
2025-03-27 07:54:10,180 [INFO] Loaded orderbook data from DB: 12 rows.
Traceback (most recent call last):
  File "/Users/igorbulgakov/Library/Python/3.9/lib/python/site-packages/pandas/core/indexes/base.py", line 3805, in get_loc
    return self._engine.get_loc(casted_key)
  File "index.pyx", line 167, in pandas._libs.index.IndexEngine.get_loc
  File "index.pyx", line 196, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 7081, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 7089, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'TradeTime'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/igorbulgakov/Documents/vib_bot/train_model_online_enhanced.py", line 306, in <module>
    main_loop()
  File "/Users/igorbulgakov/Documents/vib_bot/train_model_online_enhanced.py", line 302, in main_loop
    run_ml_inference(model)
  File "/Users/igorbulgakov/Documents/vib_bot/train_model_online_enhanced.py", line 272, in run_ml_inference
    merged_result = merge_data(df_extras, df_trades, df_orderbook)
  File "/Users/igorbulgakov/Documents/vib_bot/train_model_online_enhanced.py", line 179, in merge_data
    (df_trades["TradeTime"] >= latest_candle["close_time"] - timedelta(minutes=5)) &
  File "/Users/igorbulgakov/Library/Python/3.9/lib/python/site-packages/pandas/core/frame.py", line 4102, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/igorbulgakov/Library/Python/3.9/lib/python/site-packages/pandas/core/indexes/base.py", line 3812, in get_loc
    raise KeyError(key) from err
KeyError: 'TradeTime'
/Users/igorbulgakov/Library/Python/3.9/lib/python/site-packages/urllib3/__init__.py:35: NotOpenSSLWarning: urllib3 v2 only supports OpenSSL 1.1.1+, currently the 'ssl' module is compiled with 'LibreSSL 2.8.3'. See: https://github.com/urllib3/urllib3/issues/3020
  warnings.warn(
2025-03-27 07:54:40,154 [INFO] Training database initialized (merged_training_data and feedback tables ensured).
2025-03-27 07:54:40,154 [INFO] Model loaded successfully.
2025-03-27 07:54:40,161 [INFO] Loaded extras data from DB: 2000 rows.
2025-03-27 07:54:40,169 [INFO] Loaded trades data from DB: 4186 rows.
2025-03-27 07:54:40,170 [INFO] Loaded orderbook data from DB: 12 rows.
Traceback (most recent call last):
  File "/Users/igorbulgakov/Library/Python/3.9/lib/python/site-packages/pandas/core/indexes/base.py", line 3805, in get_loc
    return self._engine.get_loc(casted_key)
  File "index.pyx", line 167, in pandas._libs.index.IndexEngine.get_loc
  File "index.pyx", line 196, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 7081, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 7089, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'TradeTime'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/igorbulgakov/Documents/vib_bot/train_model_online_enhanced.py", line 306, in <module>
    main_loop()
  File "/Users/igorbulgakov/Documents/vib_bot/train_model_online_enhanced.py", line 302, in main_loop
    run_ml_inference(model)
  File "/Users/igorbulgakov/Documents/vib_bot/train_model_online_enhanced.py", line 272, in run_ml_inference
    merged_result = merge_data(df_extras, df_trades, df_orderbook)
  File "/Users/igorbulgakov/Documents/vib_bot/train_model_online_enhanced.py", line 179, in merge_data
    (df_trades["TradeTime"] >= latest_candle["close_time"] - timedelta(minutes=5)) &
  File "/Users/igorbulgakov/Library/Python/3.9/lib/python/site-packages/pandas/core/frame.py", line 4102, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/igorbulgakov/Library/Python/3.9/lib/python/site-packages/pandas/core/indexes/base.py", line 3812, in get_loc
    raise KeyError(key) from err
KeyError: 'TradeTime'
/Users/igorbulgakov/Library/Python/3.9/lib/python/site-packages/urllib3/__init__.py:35: NotOpenSSLWarning: urllib3 v2 only supports OpenSSL 1.1.1+, currently the 'ssl' module is compiled with 'LibreSSL 2.8.3'. See: https://github.com/urllib3/urllib3/issues/3020
  warnings.warn(
2025-03-27 07:55:10,169 [INFO] Training database initialized (merged_training_data and feedback tables ensured).
2025-03-27 07:55:10,170 [INFO] Model loaded successfully.
2025-03-27 07:55:10,177 [INFO] Loaded extras data from DB: 2000 rows.
2025-03-27 07:55:10,184 [INFO] Loaded trades data from DB: 4186 rows.
2025-03-27 07:55:10,185 [INFO] Loaded orderbook data from DB: 12 rows.
Traceback (most recent call last):
  File "/Users/igorbulgakov/Library/Python/3.9/lib/python/site-packages/pandas/core/indexes/base.py", line 3805, in get_loc
    return self._engine.get_loc(casted_key)
  File "index.pyx", line 167, in pandas._libs.index.IndexEngine.get_loc
  File "index.pyx", line 196, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 7081, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 7089, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'TradeTime'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/igorbulgakov/Documents/vib_bot/train_model_online_enhanced.py", line 306, in <module>
    main_loop()
  File "/Users/igorbulgakov/Documents/vib_bot/train_model_online_enhanced.py", line 302, in main_loop
    run_ml_inference(model)
  File "/Users/igorbulgakov/Documents/vib_bot/train_model_online_enhanced.py", line 272, in run_ml_inference
    merged_result = merge_data(df_extras, df_trades, df_orderbook)
  File "/Users/igorbulgakov/Documents/vib_bot/train_model_online_enhanced.py", line 179, in merge_data
    (df_trades["TradeTime"] >= latest_candle["close_time"] - timedelta(minutes=5)) &
  File "/Users/igorbulgakov/Library/Python/3.9/lib/python/site-packages/pandas/core/frame.py", line 4102, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/igorbulgakov/Library/Python/3.9/lib/python/site-packages/pandas/core/indexes/base.py", line 3812, in get_loc
    raise KeyError(key) from err
KeyError: 'TradeTime'
/Users/igorbulgakov/Library/Python/3.9/lib/python/site-packages/urllib3/__init__.py:35: NotOpenSSLWarning: urllib3 v2 only supports OpenSSL 1.1.1+, currently the 'ssl' module is compiled with 'LibreSSL 2.8.3'. See: https://github.com/urllib3/urllib3/issues/3020
  warnings.warn(
2025-03-27 07:55:40,158 [INFO] Training database initialized (merged_training_data and feedback tables ensured).
2025-03-27 07:55:40,158 [INFO] Model loaded successfully.
2025-03-27 07:55:40,165 [INFO] Loaded extras data from DB: 2000 rows.
2025-03-27 07:55:40,172 [INFO] Loaded trades data from DB: 4186 rows.
2025-03-27 07:55:40,173 [INFO] Loaded orderbook data from DB: 12 rows.
Traceback (most recent call last):
  File "/Users/igorbulgakov/Library/Python/3.9/lib/python/site-packages/pandas/core/indexes/base.py", line 3805, in get_loc
    return self._engine.get_loc(casted_key)
  File "index.pyx", line 167, in pandas._libs.index.IndexEngine.get_loc
  File "index.pyx", line 196, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 7081, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 7089, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'TradeTime'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/igorbulgakov/Documents/vib_bot/train_model_online_enhanced.py", line 306, in <module>
    main_loop()
  File "/Users/igorbulgakov/Documents/vib_bot/train_model_online_enhanced.py", line 302, in main_loop
    run_ml_inference(model)
  File "/Users/igorbulgakov/Documents/vib_bot/train_model_online_enhanced.py", line 272, in run_ml_inference
    merged_result = merge_data(df_extras, df_trades, df_orderbook)
  File "/Users/igorbulgakov/Documents/vib_bot/train_model_online_enhanced.py", line 179, in merge_data
    (df_trades["TradeTime"] >= latest_candle["close_time"] - timedelta(minutes=5)) &
  File "/Users/igorbulgakov/Library/Python/3.9/lib/python/site-packages/pandas/core/frame.py", line 4102, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/igorbulgakov/Library/Python/3.9/lib/python/site-packages/pandas/core/indexes/base.py", line 3812, in get_loc
    raise KeyError(key) from err
KeyError: 'TradeTime'
/Users/igorbulgakov/Library/Python/3.9/lib/python/site-packages/urllib3/__init__.py:35: NotOpenSSLWarning: urllib3 v2 only supports OpenSSL 1.1.1+, currently the 'ssl' module is compiled with 'LibreSSL 2.8.3'. See: https://github.com/urllib3/urllib3/issues/3020
  warnings.warn(
2025-03-27 07:56:10,157 [INFO] Training database initialized (merged_training_data and feedback tables ensured).
2025-03-27 07:56:10,158 [INFO] Model loaded successfully.
2025-03-27 07:56:10,165 [INFO] Loaded extras data from DB: 2000 rows.
2025-03-27 07:56:10,172 [INFO] Loaded trades data from DB: 4186 rows.
2025-03-27 07:56:10,173 [INFO] Loaded orderbook data from DB: 12 rows.
Traceback (most recent call last):
  File "/Users/igorbulgakov/Library/Python/3.9/lib/python/site-packages/pandas/core/indexes/base.py", line 3805, in get_loc
    return self._engine.get_loc(casted_key)
  File "index.pyx", line 167, in pandas._libs.index.IndexEngine.get_loc
  File "index.pyx", line 196, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 7081, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 7089, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'TradeTime'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/igorbulgakov/Documents/vib_bot/train_model_online_enhanced.py", line 306, in <module>
    main_loop()
  File "/Users/igorbulgakov/Documents/vib_bot/train_model_online_enhanced.py", line 302, in main_loop
    run_ml_inference(model)
  File "/Users/igorbulgakov/Documents/vib_bot/train_model_online_enhanced.py", line 272, in run_ml_inference
    merged_result = merge_data(df_extras, df_trades, df_orderbook)
  File "/Users/igorbulgakov/Documents/vib_bot/train_model_online_enhanced.py", line 179, in merge_data
    (df_trades["TradeTime"] >= latest_candle["close_time"] - timedelta(minutes=5)) &
  File "/Users/igorbulgakov/Library/Python/3.9/lib/python/site-packages/pandas/core/frame.py", line 4102, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/igorbulgakov/Library/Python/3.9/lib/python/site-packages/pandas/core/indexes/base.py", line 3812, in get_loc
    raise KeyError(key) from err
KeyError: 'TradeTime'
/Users/igorbulgakov/Library/Python/3.9/lib/python/site-packages/urllib3/__init__.py:35: NotOpenSSLWarning: urllib3 v2 only supports OpenSSL 1.1.1+, currently the 'ssl' module is compiled with 'LibreSSL 2.8.3'. See: https://github.com/urllib3/urllib3/issues/3020
  warnings.warn(
2025-03-27 07:56:40,179 [INFO] Training database initialized (merged_training_data and feedback tables ensured).
2025-03-27 07:56:40,179 [INFO] Model loaded successfully.
2025-03-27 07:56:40,186 [INFO] Loaded extras data from DB: 2000 rows.
2025-03-27 07:56:40,193 [INFO] Loaded trades data from DB: 4186 rows.
2025-03-27 07:56:40,194 [INFO] Loaded orderbook data from DB: 12 rows.
Traceback (most recent call last):
  File "/Users/igorbulgakov/Library/Python/3.9/lib/python/site-packages/pandas/core/indexes/base.py", line 3805, in get_loc
    return self._engine.get_loc(casted_key)
  File "index.pyx", line 167, in pandas._libs.index.IndexEngine.get_loc
  File "index.pyx", line 196, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 7081, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 7089, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'TradeTime'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/igorbulgakov/Documents/vib_bot/train_model_online_enhanced.py", line 306, in <module>
    main_loop()
  File "/Users/igorbulgakov/Documents/vib_bot/train_model_online_enhanced.py", line 302, in main_loop
    run_ml_inference(model)
  File "/Users/igorbulgakov/Documents/vib_bot/train_model_online_enhanced.py", line 272, in run_ml_inference
    merged_result = merge_data(df_extras, df_trades, df_orderbook)
  File "/Users/igorbulgakov/Documents/vib_bot/train_model_online_enhanced.py", line 179, in merge_data
    (df_trades["TradeTime"] >= latest_candle["close_time"] - timedelta(minutes=5)) &
  File "/Users/igorbulgakov/Library/Python/3.9/lib/python/site-packages/pandas/core/frame.py", line 4102, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/igorbulgakov/Library/Python/3.9/lib/python/site-packages/pandas/core/indexes/base.py", line 3812, in get_loc
    raise KeyError(key) from err
KeyError: 'TradeTime'
/Users/igorbulgakov/Library/Python/3.9/lib/python/site-packages/urllib3/__init__.py:35: NotOpenSSLWarning: urllib3 v2 only supports OpenSSL 1.1.1+, currently the 'ssl' module is compiled with 'LibreSSL 2.8.3'. See: https://github.com/urllib3/urllib3/issues/3020
  warnings.warn(
2025-03-27 07:57:10,191 [INFO] Training database initialized (merged_training_data and feedback tables ensured).
2025-03-27 07:57:10,191 [INFO] Model loaded successfully.
2025-03-27 07:57:10,198 [INFO] Loaded extras data from DB: 2000 rows.
2025-03-27 07:57:10,205 [INFO] Loaded trades data from DB: 4186 rows.
2025-03-27 07:57:10,206 [INFO] Loaded orderbook data from DB: 12 rows.
Traceback (most recent call last):
  File "/Users/igorbulgakov/Library/Python/3.9/lib/python/site-packages/pandas/core/indexes/base.py", line 3805, in get_loc
    return self._engine.get_loc(casted_key)
  File "index.pyx", line 167, in pandas._libs.index.IndexEngine.get_loc
  File "index.pyx", line 196, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 7081, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 7089, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'TradeTime'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/igorbulgakov/Documents/vib_bot/train_model_online_enhanced.py", line 306, in <module>
    main_loop()
  File "/Users/igorbulgakov/Documents/vib_bot/train_model_online_enhanced.py", line 302, in main_loop
    run_ml_inference(model)
  File "/Users/igorbulgakov/Documents/vib_bot/train_model_online_enhanced.py", line 272, in run_ml_inference
    merged_result = merge_data(df_extras, df_trades, df_orderbook)
  File "/Users/igorbulgakov/Documents/vib_bot/train_model_online_enhanced.py", line 179, in merge_data
    (df_trades["TradeTime"] >= latest_candle["close_time"] - timedelta(minutes=5)) &
  File "/Users/igorbulgakov/Library/Python/3.9/lib/python/site-packages/pandas/core/frame.py", line 4102, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/igorbulgakov/Library/Python/3.9/lib/python/site-packages/pandas/core/indexes/base.py", line 3812, in get_loc
    raise KeyError(key) from err
KeyError: 'TradeTime'
/Users/igorbulgakov/Library/Python/3.9/lib/python/site-packages/urllib3/__init__.py:35: NotOpenSSLWarning: urllib3 v2 only supports OpenSSL 1.1.1+, currently the 'ssl' module is compiled with 'LibreSSL 2.8.3'. See: https://github.com/urllib3/urllib3/issues/3020
  warnings.warn(
2025-03-27 07:57:40,191 [INFO] Training database initialized (merged_training_data and feedback tables ensured).
2025-03-27 07:57:40,191 [INFO] Model loaded successfully.
2025-03-27 07:57:40,198 [INFO] Loaded extras data from DB: 2000 rows.
2025-03-27 07:57:40,205 [INFO] Loaded trades data from DB: 4186 rows.
2025-03-27 07:57:40,206 [INFO] Loaded orderbook data from DB: 12 rows.
Traceback (most recent call last):
  File "/Users/igorbulgakov/Library/Python/3.9/lib/python/site-packages/pandas/core/indexes/base.py", line 3805, in get_loc
    return self._engine.get_loc(casted_key)
  File "index.pyx", line 167, in pandas._libs.index.IndexEngine.get_loc
  File "index.pyx", line 196, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 7081, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 7089, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'TradeTime'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/igorbulgakov/Documents/vib_bot/train_model_online_enhanced.py", line 306, in <module>
    main_loop()
  File "/Users/igorbulgakov/Documents/vib_bot/train_model_online_enhanced.py", line 302, in main_loop
    run_ml_inference(model)
  File "/Users/igorbulgakov/Documents/vib_bot/train_model_online_enhanced.py", line 272, in run_ml_inference
    merged_result = merge_data(df_extras, df_trades, df_orderbook)
  File "/Users/igorbulgakov/Documents/vib_bot/train_model_online_enhanced.py", line 179, in merge_data
    (df_trades["TradeTime"] >= latest_candle["close_time"] - timedelta(minutes=5)) &
  File "/Users/igorbulgakov/Library/Python/3.9/lib/python/site-packages/pandas/core/frame.py", line 4102, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/igorbulgakov/Library/Python/3.9/lib/python/site-packages/pandas/core/indexes/base.py", line 3812, in get_loc
    raise KeyError(key) from err
KeyError: 'TradeTime'
/Users/igorbulgakov/Library/Python/3.9/lib/python/site-packages/urllib3/__init__.py:35: NotOpenSSLWarning: urllib3 v2 only supports OpenSSL 1.1.1+, currently the 'ssl' module is compiled with 'LibreSSL 2.8.3'. See: https://github.com/urllib3/urllib3/issues/3020
  warnings.warn(
2025-03-27 07:58:10,227 [INFO] Training database initialized (merged_training_data and feedback tables ensured).
2025-03-27 07:58:10,227 [INFO] Model loaded successfully.
2025-03-27 07:58:10,234 [INFO] Loaded extras data from DB: 2000 rows.
2025-03-27 07:58:10,242 [INFO] Loaded trades data from DB: 4186 rows.
2025-03-27 07:58:10,242 [INFO] Loaded orderbook data from DB: 12 rows.
Traceback (most recent call last):
  File "/Users/igorbulgakov/Library/Python/3.9/lib/python/site-packages/pandas/core/indexes/base.py", line 3805, in get_loc
    return self._engine.get_loc(casted_key)
  File "index.pyx", line 167, in pandas._libs.index.IndexEngine.get_loc
  File "index.pyx", line 196, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 7081, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 7089, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'TradeTime'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/igorbulgakov/Documents/vib_bot/train_model_online_enhanced.py", line 306, in <module>
    main_loop()
  File "/Users/igorbulgakov/Documents/vib_bot/train_model_online_enhanced.py", line 302, in main_loop
    run_ml_inference(model)
  File "/Users/igorbulgakov/Documents/vib_bot/train_model_online_enhanced.py", line 272, in run_ml_inference
    merged_result = merge_data(df_extras, df_trades, df_orderbook)
  File "/Users/igorbulgakov/Documents/vib_bot/train_model_online_enhanced.py", line 179, in merge_data
    (df_trades["TradeTime"] >= latest_candle["close_time"] - timedelta(minutes=5)) &
  File "/Users/igorbulgakov/Library/Python/3.9/lib/python/site-packages/pandas/core/frame.py", line 4102, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/igorbulgakov/Library/Python/3.9/lib/python/site-packages/pandas/core/indexes/base.py", line 3812, in get_loc
    raise KeyError(key) from err
KeyError: 'TradeTime'
/Users/igorbulgakov/Library/Python/3.9/lib/python/site-packages/urllib3/__init__.py:35: NotOpenSSLWarning: urllib3 v2 only supports OpenSSL 1.1.1+, currently the 'ssl' module is compiled with 'LibreSSL 2.8.3'. See: https://github.com/urllib3/urllib3/issues/3020
  warnings.warn(
2025-03-27 07:58:40,235 [INFO] Training database initialized (merged_training_data and feedback tables ensured).
2025-03-27 07:58:40,235 [INFO] Model loaded successfully.
2025-03-27 07:58:40,242 [INFO] Loaded extras data from DB: 2000 rows.
2025-03-27 07:58:40,250 [INFO] Loaded trades data from DB: 4187 rows.
2025-03-27 07:58:40,251 [INFO] Loaded orderbook data from DB: 12 rows.
Traceback (most recent call last):
  File "/Users/igorbulgakov/Library/Python/3.9/lib/python/site-packages/pandas/core/indexes/base.py", line 3805, in get_loc
    return self._engine.get_loc(casted_key)
  File "index.pyx", line 167, in pandas._libs.index.IndexEngine.get_loc
  File "index.pyx", line 196, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 7081, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 7089, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'TradeTime'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/igorbulgakov/Documents/vib_bot/train_model_online_enhanced.py", line 306, in <module>
    main_loop()
  File "/Users/igorbulgakov/Documents/vib_bot/train_model_online_enhanced.py", line 302, in main_loop
    run_ml_inference(model)
  File "/Users/igorbulgakov/Documents/vib_bot/train_model_online_enhanced.py", line 272, in run_ml_inference
    merged_result = merge_data(df_extras, df_trades, df_orderbook)
  File "/Users/igorbulgakov/Documents/vib_bot/train_model_online_enhanced.py", line 179, in merge_data
    (df_trades["TradeTime"] >= latest_candle["close_time"] - timedelta(minutes=5)) &
  File "/Users/igorbulgakov/Library/Python/3.9/lib/python/site-packages/pandas/core/frame.py", line 4102, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/igorbulgakov/Library/Python/3.9/lib/python/site-packages/pandas/core/indexes/base.py", line 3812, in get_loc
    raise KeyError(key) from err
KeyError: 'TradeTime'
/Users/igorbulgakov/Library/Python/3.9/lib/python/site-packages/urllib3/__init__.py:35: NotOpenSSLWarning: urllib3 v2 only supports OpenSSL 1.1.1+, currently the 'ssl' module is compiled with 'LibreSSL 2.8.3'. See: https://github.com/urllib3/urllib3/issues/3020
  warnings.warn(
2025-03-27 07:59:10,240 [INFO] Training database initialized (merged_training_data and feedback tables ensured).
2025-03-27 07:59:10,240 [INFO] Model loaded successfully.
2025-03-27 07:59:10,247 [INFO] Loaded extras data from DB: 2000 rows.
2025-03-27 07:59:10,255 [INFO] Loaded trades data from DB: 4194 rows.
2025-03-27 07:59:10,255 [INFO] Loaded orderbook data from DB: 12 rows.
Traceback (most recent call last):
  File "/Users/igorbulgakov/Library/Python/3.9/lib/python/site-packages/pandas/core/indexes/base.py", line 3805, in get_loc
    return self._engine.get_loc(casted_key)
  File "index.pyx", line 167, in pandas._libs.index.IndexEngine.get_loc
  File "index.pyx", line 196, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 7081, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 7089, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'TradeTime'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/igorbulgakov/Documents/vib_bot/train_model_online_enhanced.py", line 306, in <module>
    main_loop()
  File "/Users/igorbulgakov/Documents/vib_bot/train_model_online_enhanced.py", line 302, in main_loop
    run_ml_inference(model)
  File "/Users/igorbulgakov/Documents/vib_bot/train_model_online_enhanced.py", line 272, in run_ml_inference
    merged_result = merge_data(df_extras, df_trades, df_orderbook)
  File "/Users/igorbulgakov/Documents/vib_bot/train_model_online_enhanced.py", line 179, in merge_data
    (df_trades["TradeTime"] >= latest_candle["close_time"] - timedelta(minutes=5)) &
  File "/Users/igorbulgakov/Library/Python/3.9/lib/python/site-packages/pandas/core/frame.py", line 4102, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/igorbulgakov/Library/Python/3.9/lib/python/site-packages/pandas/core/indexes/base.py", line 3812, in get_loc
    raise KeyError(key) from err
KeyError: 'TradeTime'
/Users/igorbulgakov/Library/Python/3.9/lib/python/site-packages/urllib3/__init__.py:35: NotOpenSSLWarning: urllib3 v2 only supports OpenSSL 1.1.1+, currently the 'ssl' module is compiled with 'LibreSSL 2.8.3'. See: https://github.com/urllib3/urllib3/issues/3020
  warnings.warn(
2025-03-27 07:59:40,230 [INFO] Training database initialized (merged_training_data and feedback tables ensured).
2025-03-27 07:59:40,231 [INFO] Model loaded successfully.
2025-03-27 07:59:40,238 [INFO] Loaded extras data from DB: 2000 rows.
2025-03-27 07:59:40,246 [INFO] Loaded trades data from DB: 4204 rows.
2025-03-27 07:59:40,246 [INFO] Loaded orderbook data from DB: 12 rows.
Traceback (most recent call last):
  File "/Users/igorbulgakov/Library/Python/3.9/lib/python/site-packages/pandas/core/indexes/base.py", line 3805, in get_loc
    return self._engine.get_loc(casted_key)
  File "index.pyx", line 167, in pandas._libs.index.IndexEngine.get_loc
  File "index.pyx", line 196, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 7081, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 7089, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'TradeTime'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/igorbulgakov/Documents/vib_bot/train_model_online_enhanced.py", line 306, in <module>
    main_loop()
  File "/Users/igorbulgakov/Documents/vib_bot/train_model_online_enhanced.py", line 302, in main_loop
    run_ml_inference(model)
  File "/Users/igorbulgakov/Documents/vib_bot/train_model_online_enhanced.py", line 272, in run_ml_inference
    merged_result = merge_data(df_extras, df_trades, df_orderbook)
  File "/Users/igorbulgakov/Documents/vib_bot/train_model_online_enhanced.py", line 179, in merge_data
    (df_trades["TradeTime"] >= latest_candle["close_time"] - timedelta(minutes=5)) &
  File "/Users/igorbulgakov/Library/Python/3.9/lib/python/site-packages/pandas/core/frame.py", line 4102, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/igorbulgakov/Library/Python/3.9/lib/python/site-packages/pandas/core/indexes/base.py", line 3812, in get_loc
    raise KeyError(key) from err
KeyError: 'TradeTime'
/Users/igorbulgakov/Library/Python/3.9/lib/python/site-packages/urllib3/__init__.py:35: NotOpenSSLWarning: urllib3 v2 only supports OpenSSL 1.1.1+, currently the 'ssl' module is compiled with 'LibreSSL 2.8.3'. See: https://github.com/urllib3/urllib3/issues/3020
  warnings.warn(
2025-03-27 08:00:10,253 [INFO] Training database initialized (merged_training_data and feedback tables ensured).
2025-03-27 08:00:10,254 [INFO] Model loaded successfully.
2025-03-27 08:00:10,261 [INFO] Loaded extras data from DB: 2000 rows.
2025-03-27 08:00:10,269 [INFO] Loaded trades data from DB: 4215 rows.
2025-03-27 08:00:10,269 [INFO] Loaded orderbook data from DB: 12 rows.
Traceback (most recent call last):
  File "/Users/igorbulgakov/Library/Python/3.9/lib/python/site-packages/pandas/core/indexes/base.py", line 3805, in get_loc
    return self._engine.get_loc(casted_key)
  File "index.pyx", line 167, in pandas._libs.index.IndexEngine.get_loc
  File "index.pyx", line 196, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 7081, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 7089, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'TradeTime'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/igorbulgakov/Documents/vib_bot/train_model_online_enhanced.py", line 306, in <module>
    main_loop()
  File "/Users/igorbulgakov/Documents/vib_bot/train_model_online_enhanced.py", line 302, in main_loop
    run_ml_inference(model)
  File "/Users/igorbulgakov/Documents/vib_bot/train_model_online_enhanced.py", line 272, in run_ml_inference
    merged_result = merge_data(df_extras, df_trades, df_orderbook)
  File "/Users/igorbulgakov/Documents/vib_bot/train_model_online_enhanced.py", line 179, in merge_data
    (df_trades["TradeTime"] >= latest_candle["close_time"] - timedelta(minutes=5)) &
  File "/Users/igorbulgakov/Library/Python/3.9/lib/python/site-packages/pandas/core/frame.py", line 4102, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/igorbulgakov/Library/Python/3.9/lib/python/site-packages/pandas/core/indexes/base.py", line 3812, in get_loc
    raise KeyError(key) from err
KeyError: 'TradeTime'
/Users/igorbulgakov/Library/Python/3.9/lib/python/site-packages/urllib3/__init__.py:35: NotOpenSSLWarning: urllib3 v2 only supports OpenSSL 1.1.1+, currently the 'ssl' module is compiled with 'LibreSSL 2.8.3'. See: https://github.com/urllib3/urllib3/issues/3020
  warnings.warn(
2025-03-27 08:00:40,295 [INFO] Training database initialized (merged_training_data and feedback tables ensured).
2025-03-27 08:00:40,296 [INFO] Model loaded successfully.
2025-03-27 08:00:40,303 [INFO] Loaded extras data from DB: 2000 rows.
2025-03-27 08:00:40,311 [INFO] Loaded trades data from DB: 4243 rows.
2025-03-27 08:00:40,312 [INFO] Loaded orderbook data from DB: 12 rows.
Traceback (most recent call last):
  File "/Users/igorbulgakov/Library/Python/3.9/lib/python/site-packages/pandas/core/indexes/base.py", line 3805, in get_loc
    return self._engine.get_loc(casted_key)
  File "index.pyx", line 167, in pandas._libs.index.IndexEngine.get_loc
  File "index.pyx", line 196, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 7081, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 7089, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'TradeTime'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/igorbulgakov/Documents/vib_bot/train_model_online_enhanced.py", line 306, in <module>
    main_loop()
  File "/Users/igorbulgakov/Documents/vib_bot/train_model_online_enhanced.py", line 302, in main_loop
    run_ml_inference(model)
  File "/Users/igorbulgakov/Documents/vib_bot/train_model_online_enhanced.py", line 272, in run_ml_inference
    merged_result = merge_data(df_extras, df_trades, df_orderbook)
  File "/Users/igorbulgakov/Documents/vib_bot/train_model_online_enhanced.py", line 179, in merge_data
    (df_trades["TradeTime"] >= latest_candle["close_time"] - timedelta(minutes=5)) &
  File "/Users/igorbulgakov/Library/Python/3.9/lib/python/site-packages/pandas/core/frame.py", line 4102, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/igorbulgakov/Library/Python/3.9/lib/python/site-packages/pandas/core/indexes/base.py", line 3812, in get_loc
    raise KeyError(key) from err
KeyError: 'TradeTime'
/Users/igorbulgakov/Library/Python/3.9/lib/python/site-packages/urllib3/__init__.py:35: NotOpenSSLWarning: urllib3 v2 only supports OpenSSL 1.1.1+, currently the 'ssl' module is compiled with 'LibreSSL 2.8.3'. See: https://github.com/urllib3/urllib3/issues/3020
  warnings.warn(
2025-03-27 08:01:10,310 [INFO] Training database initialized (merged_training_data and feedback tables ensured).
2025-03-27 08:01:10,311 [INFO] Model loaded successfully.
2025-03-27 08:01:10,318 [INFO] Loaded extras data from DB: 2000 rows.
2025-03-27 08:01:10,326 [INFO] Loaded trades data from DB: 4249 rows.
2025-03-27 08:01:10,327 [INFO] Loaded orderbook data from DB: 12 rows.
Traceback (most recent call last):
  File "/Users/igorbulgakov/Library/Python/3.9/lib/python/site-packages/pandas/core/indexes/base.py", line 3805, in get_loc
    return self._engine.get_loc(casted_key)
  File "index.pyx", line 167, in pandas._libs.index.IndexEngine.get_loc
  File "index.pyx", line 196, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 7081, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 7089, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'TradeTime'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/igorbulgakov/Documents/vib_bot/train_model_online_enhanced.py", line 306, in <module>
    main_loop()
  File "/Users/igorbulgakov/Documents/vib_bot/train_model_online_enhanced.py", line 302, in main_loop
    run_ml_inference(model)
  File "/Users/igorbulgakov/Documents/vib_bot/train_model_online_enhanced.py", line 272, in run_ml_inference
    merged_result = merge_data(df_extras, df_trades, df_orderbook)
  File "/Users/igorbulgakov/Documents/vib_bot/train_model_online_enhanced.py", line 179, in merge_data
    (df_trades["TradeTime"] >= latest_candle["close_time"] - timedelta(minutes=5)) &
  File "/Users/igorbulgakov/Library/Python/3.9/lib/python/site-packages/pandas/core/frame.py", line 4102, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/igorbulgakov/Library/Python/3.9/lib/python/site-packages/pandas/core/indexes/base.py", line 3812, in get_loc
    raise KeyError(key) from err
KeyError: 'TradeTime'
/Users/igorbulgakov/Library/Python/3.9/lib/python/site-packages/urllib3/__init__.py:35: NotOpenSSLWarning: urllib3 v2 only supports OpenSSL 1.1.1+, currently the 'ssl' module is compiled with 'LibreSSL 2.8.3'. See: https://github.com/urllib3/urllib3/issues/3020
  warnings.warn(
2025-03-27 08:01:40,317 [INFO] Training database initialized (merged_training_data and feedback tables ensured).
2025-03-27 08:01:40,317 [INFO] Model loaded successfully.
2025-03-27 08:01:40,325 [INFO] Loaded extras data from DB: 2000 rows.
2025-03-27 08:01:40,333 [INFO] Loaded trades data from DB: 4253 rows.
2025-03-27 08:01:40,334 [INFO] Loaded orderbook data from DB: 12 rows.
Traceback (most recent call last):
  File "/Users/igorbulgakov/Library/Python/3.9/lib/python/site-packages/pandas/core/indexes/base.py", line 3805, in get_loc
    return self._engine.get_loc(casted_key)
  File "index.pyx", line 167, in pandas._libs.index.IndexEngine.get_loc
  File "index.pyx", line 196, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 7081, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 7089, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'TradeTime'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/igorbulgakov/Documents/vib_bot/train_model_online_enhanced.py", line 306, in <module>
    main_loop()
  File "/Users/igorbulgakov/Documents/vib_bot/train_model_online_enhanced.py", line 302, in main_loop
    run_ml_inference(model)
  File "/Users/igorbulgakov/Documents/vib_bot/train_model_online_enhanced.py", line 272, in run_ml_inference
    merged_result = merge_data(df_extras, df_trades, df_orderbook)
  File "/Users/igorbulgakov/Documents/vib_bot/train_model_online_enhanced.py", line 179, in merge_data
    (df_trades["TradeTime"] >= latest_candle["close_time"] - timedelta(minutes=5)) &
  File "/Users/igorbulgakov/Library/Python/3.9/lib/python/site-packages/pandas/core/frame.py", line 4102, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/igorbulgakov/Library/Python/3.9/lib/python/site-packages/pandas/core/indexes/base.py", line 3812, in get_loc
    raise KeyError(key) from err
KeyError: 'TradeTime'
/Users/igorbulgakov/Library/Python/3.9/lib/python/site-packages/urllib3/__init__.py:35: NotOpenSSLWarning: urllib3 v2 only supports OpenSSL 1.1.1+, currently the 'ssl' module is compiled with 'LibreSSL 2.8.3'. See: https://github.com/urllib3/urllib3/issues/3020
  warnings.warn(
2025-03-27 08:02:10,335 [INFO] Training database initialized (merged_training_data and feedback tables ensured).
2025-03-27 08:02:10,335 [INFO] Model loaded successfully.
2025-03-27 08:02:10,342 [INFO] Loaded extras data from DB: 2000 rows.
2025-03-27 08:02:10,350 [INFO] Loaded trades data from DB: 4256 rows.
2025-03-27 08:02:10,351 [INFO] Loaded orderbook data from DB: 12 rows.
Traceback (most recent call last):
  File "/Users/igorbulgakov/Library/Python/3.9/lib/python/site-packages/pandas/core/indexes/base.py", line 3805, in get_loc
    return self._engine.get_loc(casted_key)
  File "index.pyx", line 167, in pandas._libs.index.IndexEngine.get_loc
  File "index.pyx", line 196, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 7081, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 7089, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'TradeTime'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/igorbulgakov/Documents/vib_bot/train_model_online_enhanced.py", line 306, in <module>
    main_loop()
  File "/Users/igorbulgakov/Documents/vib_bot/train_model_online_enhanced.py", line 302, in main_loop
    run_ml_inference(model)
  File "/Users/igorbulgakov/Documents/vib_bot/train_model_online_enhanced.py", line 272, in run_ml_inference
    merged_result = merge_data(df_extras, df_trades, df_orderbook)
  File "/Users/igorbulgakov/Documents/vib_bot/train_model_online_enhanced.py", line 179, in merge_data
    (df_trades["TradeTime"] >= latest_candle["close_time"] - timedelta(minutes=5)) &
  File "/Users/igorbulgakov/Library/Python/3.9/lib/python/site-packages/pandas/core/frame.py", line 4102, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/igorbulgakov/Library/Python/3.9/lib/python/site-packages/pandas/core/indexes/base.py", line 3812, in get_loc
    raise KeyError(key) from err
KeyError: 'TradeTime'
/Users/igorbulgakov/Library/Python/3.9/lib/python/site-packages/urllib3/__init__.py:35: NotOpenSSLWarning: urllib3 v2 only supports OpenSSL 1.1.1+, currently the 'ssl' module is compiled with 'LibreSSL 2.8.3'. See: https://github.com/urllib3/urllib3/issues/3020
  warnings.warn(
2025-03-27 08:02:40,344 [INFO] Training database initialized (merged_training_data and feedback tables ensured).
2025-03-27 08:02:40,344 [INFO] Model loaded successfully.
2025-03-27 08:02:40,351 [INFO] Loaded extras data from DB: 2000 rows.
2025-03-27 08:02:40,359 [INFO] Loaded trades data from DB: 4265 rows.
2025-03-27 08:02:40,360 [INFO] Loaded orderbook data from DB: 12 rows.
Traceback (most recent call last):
  File "/Users/igorbulgakov/Library/Python/3.9/lib/python/site-packages/pandas/core/indexes/base.py", line 3805, in get_loc
    return self._engine.get_loc(casted_key)
  File "index.pyx", line 167, in pandas._libs.index.IndexEngine.get_loc
  File "index.pyx", line 196, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 7081, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 7089, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'TradeTime'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/igorbulgakov/Documents/vib_bot/train_model_online_enhanced.py", line 306, in <module>
    main_loop()
  File "/Users/igorbulgakov/Documents/vib_bot/train_model_online_enhanced.py", line 302, in main_loop
    run_ml_inference(model)
  File "/Users/igorbulgakov/Documents/vib_bot/train_model_online_enhanced.py", line 272, in run_ml_inference
    merged_result = merge_data(df_extras, df_trades, df_orderbook)
  File "/Users/igorbulgakov/Documents/vib_bot/train_model_online_enhanced.py", line 179, in merge_data
    (df_trades["TradeTime"] >= latest_candle["close_time"] - timedelta(minutes=5)) &
  File "/Users/igorbulgakov/Library/Python/3.9/lib/python/site-packages/pandas/core/frame.py", line 4102, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/igorbulgakov/Library/Python/3.9/lib/python/site-packages/pandas/core/indexes/base.py", line 3812, in get_loc
    raise KeyError(key) from err
KeyError: 'TradeTime'
/Users/igorbulgakov/Library/Python/3.9/lib/python/site-packages/urllib3/__init__.py:35: NotOpenSSLWarning: urllib3 v2 only supports OpenSSL 1.1.1+, currently the 'ssl' module is compiled with 'LibreSSL 2.8.3'. See: https://github.com/urllib3/urllib3/issues/3020
  warnings.warn(
2025-03-27 08:03:10,343 [INFO] Training database initialized (merged_training_data and feedback tables ensured).
2025-03-27 08:03:10,344 [INFO] Model loaded successfully.
2025-03-27 08:03:10,351 [INFO] Loaded extras data from DB: 2000 rows.
2025-03-27 08:03:10,359 [INFO] Loaded trades data from DB: 4274 rows.
2025-03-27 08:03:10,360 [INFO] Loaded orderbook data from DB: 12 rows.
Traceback (most recent call last):
  File "/Users/igorbulgakov/Library/Python/3.9/lib/python/site-packages/pandas/core/indexes/base.py", line 3805, in get_loc
    return self._engine.get_loc(casted_key)
  File "index.pyx", line 167, in pandas._libs.index.IndexEngine.get_loc
  File "index.pyx", line 196, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 7081, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 7089, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'TradeTime'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/igorbulgakov/Documents/vib_bot/train_model_online_enhanced.py", line 306, in <module>
    main_loop()
  File "/Users/igorbulgakov/Documents/vib_bot/train_model_online_enhanced.py", line 302, in main_loop
    run_ml_inference(model)
  File "/Users/igorbulgakov/Documents/vib_bot/train_model_online_enhanced.py", line 272, in run_ml_inference
    merged_result = merge_data(df_extras, df_trades, df_orderbook)
  File "/Users/igorbulgakov/Documents/vib_bot/train_model_online_enhanced.py", line 179, in merge_data
    (df_trades["TradeTime"] >= latest_candle["close_time"] - timedelta(minutes=5)) &
  File "/Users/igorbulgakov/Library/Python/3.9/lib/python/site-packages/pandas/core/frame.py", line 4102, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/igorbulgakov/Library/Python/3.9/lib/python/site-packages/pandas/core/indexes/base.py", line 3812, in get_loc
    raise KeyError(key) from err
KeyError: 'TradeTime'
/Users/igorbulgakov/Library/Python/3.9/lib/python/site-packages/urllib3/__init__.py:35: NotOpenSSLWarning: urllib3 v2 only supports OpenSSL 1.1.1+, currently the 'ssl' module is compiled with 'LibreSSL 2.8.3'. See: https://github.com/urllib3/urllib3/issues/3020
  warnings.warn(
2025-03-27 08:03:40,408 [INFO] Training database initialized (merged_training_data and feedback tables ensured).
2025-03-27 08:03:40,409 [INFO] Model loaded successfully.
2025-03-27 08:03:40,416 [INFO] Loaded extras data from DB: 2000 rows.
2025-03-27 08:03:40,425 [INFO] Loaded trades data from DB: 4280 rows.
2025-03-27 08:03:40,425 [INFO] Loaded orderbook data from DB: 12 rows.
Traceback (most recent call last):
  File "/Users/igorbulgakov/Library/Python/3.9/lib/python/site-packages/pandas/core/indexes/base.py", line 3805, in get_loc
    return self._engine.get_loc(casted_key)
  File "index.pyx", line 167, in pandas._libs.index.IndexEngine.get_loc
  File "index.pyx", line 196, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 7081, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 7089, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'TradeTime'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/igorbulgakov/Documents/vib_bot/train_model_online_enhanced.py", line 306, in <module>
    main_loop()
  File "/Users/igorbulgakov/Documents/vib_bot/train_model_online_enhanced.py", line 302, in main_loop
    run_ml_inference(model)
  File "/Users/igorbulgakov/Documents/vib_bot/train_model_online_enhanced.py", line 272, in run_ml_inference
    merged_result = merge_data(df_extras, df_trades, df_orderbook)
  File "/Users/igorbulgakov/Documents/vib_bot/train_model_online_enhanced.py", line 179, in merge_data
    (df_trades["TradeTime"] >= latest_candle["close_time"] - timedelta(minutes=5)) &
  File "/Users/igorbulgakov/Library/Python/3.9/lib/python/site-packages/pandas/core/frame.py", line 4102, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/igorbulgakov/Library/Python/3.9/lib/python/site-packages/pandas/core/indexes/base.py", line 3812, in get_loc
    raise KeyError(key) from err
KeyError: 'TradeTime'
/Users/igorbulgakov/Library/Python/3.9/lib/python/site-packages/urllib3/__init__.py:35: NotOpenSSLWarning: urllib3 v2 only supports OpenSSL 1.1.1+, currently the 'ssl' module is compiled with 'LibreSSL 2.8.3'. See: https://github.com/urllib3/urllib3/issues/3020
  warnings.warn(
2025-03-27 08:04:10,428 [INFO] Training database initialized (merged_training_data and feedback tables ensured).
2025-03-27 08:04:10,428 [INFO] Model loaded successfully.
2025-03-27 08:04:10,435 [INFO] Loaded extras data from DB: 2000 rows.
2025-03-27 08:04:10,443 [INFO] Loaded trades data from DB: 4295 rows.
2025-03-27 08:04:10,444 [INFO] Loaded orderbook data from DB: 12 rows.
Traceback (most recent call last):
  File "/Users/igorbulgakov/Library/Python/3.9/lib/python/site-packages/pandas/core/indexes/base.py", line 3805, in get_loc
    return self._engine.get_loc(casted_key)
  File "index.pyx", line 167, in pandas._libs.index.IndexEngine.get_loc
  File "index.pyx", line 196, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 7081, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 7089, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'TradeTime'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/igorbulgakov/Documents/vib_bot/train_model_online_enhanced.py", line 306, in <module>
    main_loop()
  File "/Users/igorbulgakov/Documents/vib_bot/train_model_online_enhanced.py", line 302, in main_loop
    run_ml_inference(model)
  File "/Users/igorbulgakov/Documents/vib_bot/train_model_online_enhanced.py", line 272, in run_ml_inference
    merged_result = merge_data(df_extras, df_trades, df_orderbook)
  File "/Users/igorbulgakov/Documents/vib_bot/train_model_online_enhanced.py", line 179, in merge_data
    (df_trades["TradeTime"] >= latest_candle["close_time"] - timedelta(minutes=5)) &
  File "/Users/igorbulgakov/Library/Python/3.9/lib/python/site-packages/pandas/core/frame.py", line 4102, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/igorbulgakov/Library/Python/3.9/lib/python/site-packages/pandas/core/indexes/base.py", line 3812, in get_loc
    raise KeyError(key) from err
KeyError: 'TradeTime'
/Users/igorbulgakov/Library/Python/3.9/lib/python/site-packages/urllib3/__init__.py:35: NotOpenSSLWarning: urllib3 v2 only supports OpenSSL 1.1.1+, currently the 'ssl' module is compiled with 'LibreSSL 2.8.3'. See: https://github.com/urllib3/urllib3/issues/3020
  warnings.warn(
2025-03-27 08:04:40,375 [INFO] Training database initialized (merged_training_data and feedback tables ensured).
2025-03-27 08:04:40,375 [INFO] Model loaded successfully.
2025-03-27 08:04:40,382 [INFO] Loaded extras data from DB: 2000 rows.
2025-03-27 08:04:40,390 [INFO] Loaded trades data from DB: 4302 rows.
2025-03-27 08:04:40,391 [INFO] Loaded orderbook data from DB: 12 rows.
Traceback (most recent call last):
  File "/Users/igorbulgakov/Library/Python/3.9/lib/python/site-packages/pandas/core/indexes/base.py", line 3805, in get_loc
    return self._engine.get_loc(casted_key)
  File "index.pyx", line 167, in pandas._libs.index.IndexEngine.get_loc
  File "index.pyx", line 196, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 7081, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 7089, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'TradeTime'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/igorbulgakov/Documents/vib_bot/train_model_online_enhanced.py", line 306, in <module>
    main_loop()
  File "/Users/igorbulgakov/Documents/vib_bot/train_model_online_enhanced.py", line 302, in main_loop
    run_ml_inference(model)
  File "/Users/igorbulgakov/Documents/vib_bot/train_model_online_enhanced.py", line 272, in run_ml_inference
    merged_result = merge_data(df_extras, df_trades, df_orderbook)
  File "/Users/igorbulgakov/Documents/vib_bot/train_model_online_enhanced.py", line 179, in merge_data
    (df_trades["TradeTime"] >= latest_candle["close_time"] - timedelta(minutes=5)) &
  File "/Users/igorbulgakov/Library/Python/3.9/lib/python/site-packages/pandas/core/frame.py", line 4102, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/igorbulgakov/Library/Python/3.9/lib/python/site-packages/pandas/core/indexes/base.py", line 3812, in get_loc
    raise KeyError(key) from err
KeyError: 'TradeTime'
/Users/igorbulgakov/Library/Python/3.9/lib/python/site-packages/urllib3/__init__.py:35: NotOpenSSLWarning: urllib3 v2 only supports OpenSSL 1.1.1+, currently the 'ssl' module is compiled with 'LibreSSL 2.8.3'. See: https://github.com/urllib3/urllib3/issues/3020
  warnings.warn(
2025-03-27 08:05:10,423 [INFO] Training database initialized (merged_training_data and feedback tables ensured).
2025-03-27 08:05:10,424 [INFO] Model loaded successfully.
2025-03-27 08:05:10,431 [INFO] Loaded extras data from DB: 2000 rows.
2025-03-27 08:05:10,439 [INFO] Loaded trades data from DB: 4312 rows.
2025-03-27 08:05:10,440 [INFO] Loaded orderbook data from DB: 12 rows.
Traceback (most recent call last):
  File "/Users/igorbulgakov/Library/Python/3.9/lib/python/site-packages/pandas/core/indexes/base.py", line 3805, in get_loc
    return self._engine.get_loc(casted_key)
  File "index.pyx", line 167, in pandas._libs.index.IndexEngine.get_loc
  File "index.pyx", line 196, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 7081, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 7089, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'TradeTime'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/igorbulgakov/Documents/vib_bot/train_model_online_enhanced.py", line 306, in <module>
    main_loop()
  File "/Users/igorbulgakov/Documents/vib_bot/train_model_online_enhanced.py", line 302, in main_loop
    run_ml_inference(model)
  File "/Users/igorbulgakov/Documents/vib_bot/train_model_online_enhanced.py", line 272, in run_ml_inference
    merged_result = merge_data(df_extras, df_trades, df_orderbook)
  File "/Users/igorbulgakov/Documents/vib_bot/train_model_online_enhanced.py", line 179, in merge_data
    (df_trades["TradeTime"] >= latest_candle["close_time"] - timedelta(minutes=5)) &
  File "/Users/igorbulgakov/Library/Python/3.9/lib/python/site-packages/pandas/core/frame.py", line 4102, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/igorbulgakov/Library/Python/3.9/lib/python/site-packages/pandas/core/indexes/base.py", line 3812, in get_loc
    raise KeyError(key) from err
KeyError: 'TradeTime'
/Users/igorbulgakov/Library/Python/3.9/lib/python/site-packages/urllib3/__init__.py:35: NotOpenSSLWarning: urllib3 v2 only supports OpenSSL 1.1.1+, currently the 'ssl' module is compiled with 'LibreSSL 2.8.3'. See: https://github.com/urllib3/urllib3/issues/3020
  warnings.warn(
2025-03-27 08:05:40,436 [INFO] Training database initialized (merged_training_data and feedback tables ensured).
2025-03-27 08:05:40,437 [INFO] Model loaded successfully.
2025-03-27 08:05:40,444 [INFO] Loaded extras data from DB: 2000 rows.
2025-03-27 08:05:40,451 [INFO] Loaded trades data from DB: 4312 rows.
2025-03-27 08:05:40,452 [INFO] Loaded orderbook data from DB: 12 rows.
Traceback (most recent call last):
  File "/Users/igorbulgakov/Library/Python/3.9/lib/python/site-packages/pandas/core/indexes/base.py", line 3805, in get_loc
    return self._engine.get_loc(casted_key)
  File "index.pyx", line 167, in pandas._libs.index.IndexEngine.get_loc
  File "index.pyx", line 196, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 7081, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 7089, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'TradeTime'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/igorbulgakov/Documents/vib_bot/train_model_online_enhanced.py", line 306, in <module>
    main_loop()
  File "/Users/igorbulgakov/Documents/vib_bot/train_model_online_enhanced.py", line 302, in main_loop
    run_ml_inference(model)
  File "/Users/igorbulgakov/Documents/vib_bot/train_model_online_enhanced.py", line 272, in run_ml_inference
    merged_result = merge_data(df_extras, df_trades, df_orderbook)
  File "/Users/igorbulgakov/Documents/vib_bot/train_model_online_enhanced.py", line 179, in merge_data
    (df_trades["TradeTime"] >= latest_candle["close_time"] - timedelta(minutes=5)) &
  File "/Users/igorbulgakov/Library/Python/3.9/lib/python/site-packages/pandas/core/frame.py", line 4102, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/igorbulgakov/Library/Python/3.9/lib/python/site-packages/pandas/core/indexes/base.py", line 3812, in get_loc
    raise KeyError(key) from err
KeyError: 'TradeTime'
/Users/igorbulgakov/Library/Python/3.9/lib/python/site-packages/urllib3/__init__.py:35: NotOpenSSLWarning: urllib3 v2 only supports OpenSSL 1.1.1+, currently the 'ssl' module is compiled with 'LibreSSL 2.8.3'. See: https://github.com/urllib3/urllib3/issues/3020
  warnings.warn(
2025-03-27 08:06:10,412 [INFO] Training database initialized (merged_training_data and feedback tables ensured).
2025-03-27 08:06:10,412 [INFO] Model loaded successfully.
2025-03-27 08:06:10,419 [INFO] Loaded extras data from DB: 2000 rows.
2025-03-27 08:06:10,427 [INFO] Loaded trades data from DB: 4313 rows.
2025-03-27 08:06:10,428 [INFO] Loaded orderbook data from DB: 12 rows.
Traceback (most recent call last):
  File "/Users/igorbulgakov/Library/Python/3.9/lib/python/site-packages/pandas/core/indexes/base.py", line 3805, in get_loc
    return self._engine.get_loc(casted_key)
  File "index.pyx", line 167, in pandas._libs.index.IndexEngine.get_loc
  File "index.pyx", line 196, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 7081, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 7089, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'TradeTime'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/igorbulgakov/Documents/vib_bot/train_model_online_enhanced.py", line 306, in <module>
    main_loop()
  File "/Users/igorbulgakov/Documents/vib_bot/train_model_online_enhanced.py", line 302, in main_loop
    run_ml_inference(model)
  File "/Users/igorbulgakov/Documents/vib_bot/train_model_online_enhanced.py", line 272, in run_ml_inference
    merged_result = merge_data(df_extras, df_trades, df_orderbook)
  File "/Users/igorbulgakov/Documents/vib_bot/train_model_online_enhanced.py", line 179, in merge_data
    (df_trades["TradeTime"] >= latest_candle["close_time"] - timedelta(minutes=5)) &
  File "/Users/igorbulgakov/Library/Python/3.9/lib/python/site-packages/pandas/core/frame.py", line 4102, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/igorbulgakov/Library/Python/3.9/lib/python/site-packages/pandas/core/indexes/base.py", line 3812, in get_loc
    raise KeyError(key) from err
KeyError: 'TradeTime'
/Users/igorbulgakov/Library/Python/3.9/lib/python/site-packages/urllib3/__init__.py:35: NotOpenSSLWarning: urllib3 v2 only supports OpenSSL 1.1.1+, currently the 'ssl' module is compiled with 'LibreSSL 2.8.3'. See: https://github.com/urllib3/urllib3/issues/3020
  warnings.warn(
2025-03-27 08:06:40,484 [INFO] Training database initialized (merged_training_data and feedback tables ensured).
2025-03-27 08:06:40,484 [INFO] Model loaded successfully.
2025-03-27 08:06:40,492 [INFO] Loaded extras data from DB: 2000 rows.
2025-03-27 08:06:40,500 [INFO] Loaded trades data from DB: 4318 rows.
2025-03-27 08:06:40,501 [INFO] Loaded orderbook data from DB: 12 rows.
Traceback (most recent call last):
  File "/Users/igorbulgakov/Library/Python/3.9/lib/python/site-packages/pandas/core/indexes/base.py", line 3805, in get_loc
    return self._engine.get_loc(casted_key)
  File "index.pyx", line 167, in pandas._libs.index.IndexEngine.get_loc
  File "index.pyx", line 196, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 7081, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 7089, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'TradeTime'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/igorbulgakov/Documents/vib_bot/train_model_online_enhanced.py", line 306, in <module>
    main_loop()
  File "/Users/igorbulgakov/Documents/vib_bot/train_model_online_enhanced.py", line 302, in main_loop
    run_ml_inference(model)
  File "/Users/igorbulgakov/Documents/vib_bot/train_model_online_enhanced.py", line 272, in run_ml_inference
    merged_result = merge_data(df_extras, df_trades, df_orderbook)
  File "/Users/igorbulgakov/Documents/vib_bot/train_model_online_enhanced.py", line 179, in merge_data
    (df_trades["TradeTime"] >= latest_candle["close_time"] - timedelta(minutes=5)) &
  File "/Users/igorbulgakov/Library/Python/3.9/lib/python/site-packages/pandas/core/frame.py", line 4102, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/igorbulgakov/Library/Python/3.9/lib/python/site-packages/pandas/core/indexes/base.py", line 3812, in get_loc
    raise KeyError(key) from err
KeyError: 'TradeTime'
/Users/igorbulgakov/Library/Python/3.9/lib/python/site-packages/urllib3/__init__.py:35: NotOpenSSLWarning: urllib3 v2 only supports OpenSSL 1.1.1+, currently the 'ssl' module is compiled with 'LibreSSL 2.8.3'. See: https://github.com/urllib3/urllib3/issues/3020
  warnings.warn(
2025-03-27 08:07:10,441 [INFO] Training database initialized (merged_training_data and feedback tables ensured).
2025-03-27 08:07:10,442 [INFO] Model loaded successfully.
2025-03-27 08:07:10,449 [INFO] Loaded extras data from DB: 2000 rows.
2025-03-27 08:07:10,457 [INFO] Loaded trades data from DB: 4319 rows.
2025-03-27 08:07:10,458 [INFO] Loaded orderbook data from DB: 12 rows.
Traceback (most recent call last):
  File "/Users/igorbulgakov/Library/Python/3.9/lib/python/site-packages/pandas/core/indexes/base.py", line 3805, in get_loc
    return self._engine.get_loc(casted_key)
  File "index.pyx", line 167, in pandas._libs.index.IndexEngine.get_loc
  File "index.pyx", line 196, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 7081, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 7089, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'TradeTime'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/igorbulgakov/Documents/vib_bot/train_model_online_enhanced.py", line 306, in <module>
    main_loop()
  File "/Users/igorbulgakov/Documents/vib_bot/train_model_online_enhanced.py", line 302, in main_loop
    run_ml_inference(model)
  File "/Users/igorbulgakov/Documents/vib_bot/train_model_online_enhanced.py", line 272, in run_ml_inference
    merged_result = merge_data(df_extras, df_trades, df_orderbook)
  File "/Users/igorbulgakov/Documents/vib_bot/train_model_online_enhanced.py", line 179, in merge_data
    (df_trades["TradeTime"] >= latest_candle["close_time"] - timedelta(minutes=5)) &
  File "/Users/igorbulgakov/Library/Python/3.9/lib/python/site-packages/pandas/core/frame.py", line 4102, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/igorbulgakov/Library/Python/3.9/lib/python/site-packages/pandas/core/indexes/base.py", line 3812, in get_loc
    raise KeyError(key) from err
KeyError: 'TradeTime'
/Users/igorbulgakov/Library/Python/3.9/lib/python/site-packages/urllib3/__init__.py:35: NotOpenSSLWarning: urllib3 v2 only supports OpenSSL 1.1.1+, currently the 'ssl' module is compiled with 'LibreSSL 2.8.3'. See: https://github.com/urllib3/urllib3/issues/3020
  warnings.warn(
2025-03-27 08:07:40,406 [INFO] Training database initialized (merged_training_data and feedback tables ensured).
2025-03-27 08:07:40,407 [INFO] Model loaded successfully.
2025-03-27 08:07:40,414 [INFO] Loaded extras data from DB: 2000 rows.
2025-03-27 08:07:40,422 [INFO] Loaded trades data from DB: 4323 rows.
2025-03-27 08:07:40,423 [INFO] Loaded orderbook data from DB: 12 rows.
Traceback (most recent call last):
  File "/Users/igorbulgakov/Library/Python/3.9/lib/python/site-packages/pandas/core/indexes/base.py", line 3805, in get_loc
    return self._engine.get_loc(casted_key)
  File "index.pyx", line 167, in pandas._libs.index.IndexEngine.get_loc
  File "index.pyx", line 196, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 7081, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 7089, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'TradeTime'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/igorbulgakov/Documents/vib_bot/train_model_online_enhanced.py", line 306, in <module>
    main_loop()
  File "/Users/igorbulgakov/Documents/vib_bot/train_model_online_enhanced.py", line 302, in main_loop
    run_ml_inference(model)
  File "/Users/igorbulgakov/Documents/vib_bot/train_model_online_enhanced.py", line 272, in run_ml_inference
    merged_result = merge_data(df_extras, df_trades, df_orderbook)
  File "/Users/igorbulgakov/Documents/vib_bot/train_model_online_enhanced.py", line 179, in merge_data
    (df_trades["TradeTime"] >= latest_candle["close_time"] - timedelta(minutes=5)) &
  File "/Users/igorbulgakov/Library/Python/3.9/lib/python/site-packages/pandas/core/frame.py", line 4102, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/igorbulgakov/Library/Python/3.9/lib/python/site-packages/pandas/core/indexes/base.py", line 3812, in get_loc
    raise KeyError(key) from err
KeyError: 'TradeTime'
/Users/igorbulgakov/Library/Python/3.9/lib/python/site-packages/urllib3/__init__.py:35: NotOpenSSLWarning: urllib3 v2 only supports OpenSSL 1.1.1+, currently the 'ssl' module is compiled with 'LibreSSL 2.8.3'. See: https://github.com/urllib3/urllib3/issues/3020
  warnings.warn(
2025-03-27 08:08:10,440 [INFO] Training database initialized (merged_training_data and feedback tables ensured).
2025-03-27 08:08:10,440 [INFO] Model loaded successfully.
2025-03-27 08:08:10,448 [INFO] Loaded extras data from DB: 2000 rows.
2025-03-27 08:08:10,456 [INFO] Loaded trades data from DB: 4345 rows.
2025-03-27 08:08:10,457 [INFO] Loaded orderbook data from DB: 12 rows.
Traceback (most recent call last):
  File "/Users/igorbulgakov/Library/Python/3.9/lib/python/site-packages/pandas/core/indexes/base.py", line 3805, in get_loc
    return self._engine.get_loc(casted_key)
  File "index.pyx", line 167, in pandas._libs.index.IndexEngine.get_loc
  File "index.pyx", line 196, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 7081, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 7089, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'TradeTime'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/igorbulgakov/Documents/vib_bot/train_model_online_enhanced.py", line 306, in <module>
    main_loop()
  File "/Users/igorbulgakov/Documents/vib_bot/train_model_online_enhanced.py", line 302, in main_loop
    run_ml_inference(model)
  File "/Users/igorbulgakov/Documents/vib_bot/train_model_online_enhanced.py", line 272, in run_ml_inference
    merged_result = merge_data(df_extras, df_trades, df_orderbook)
  File "/Users/igorbulgakov/Documents/vib_bot/train_model_online_enhanced.py", line 179, in merge_data
    (df_trades["TradeTime"] >= latest_candle["close_time"] - timedelta(minutes=5)) &
  File "/Users/igorbulgakov/Library/Python/3.9/lib/python/site-packages/pandas/core/frame.py", line 4102, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/igorbulgakov/Library/Python/3.9/lib/python/site-packages/pandas/core/indexes/base.py", line 3812, in get_loc
    raise KeyError(key) from err
KeyError: 'TradeTime'
/Users/igorbulgakov/Library/Python/3.9/lib/python/site-packages/urllib3/__init__.py:35: NotOpenSSLWarning: urllib3 v2 only supports OpenSSL 1.1.1+, currently the 'ssl' module is compiled with 'LibreSSL 2.8.3'. See: https://github.com/urllib3/urllib3/issues/3020
  warnings.warn(
2025-03-27 08:08:40,455 [INFO] Training database initialized (merged_training_data and feedback tables ensured).
2025-03-27 08:08:40,456 [INFO] Model loaded successfully.
2025-03-27 08:08:40,463 [INFO] Loaded extras data from DB: 2000 rows.
2025-03-27 08:08:40,470 [INFO] Loaded trades data from DB: 4345 rows.
2025-03-27 08:08:40,471 [INFO] Loaded orderbook data from DB: 12 rows.
Traceback (most recent call last):
  File "/Users/igorbulgakov/Library/Python/3.9/lib/python/site-packages/pandas/core/indexes/base.py", line 3805, in get_loc
    return self._engine.get_loc(casted_key)
  File "index.pyx", line 167, in pandas._libs.index.IndexEngine.get_loc
  File "index.pyx", line 196, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 7081, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 7089, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'TradeTime'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/igorbulgakov/Documents/vib_bot/train_model_online_enhanced.py", line 306, in <module>
    main_loop()
  File "/Users/igorbulgakov/Documents/vib_bot/train_model_online_enhanced.py", line 302, in main_loop
    run_ml_inference(model)
  File "/Users/igorbulgakov/Documents/vib_bot/train_model_online_enhanced.py", line 272, in run_ml_inference
    merged_result = merge_data(df_extras, df_trades, df_orderbook)
  File "/Users/igorbulgakov/Documents/vib_bot/train_model_online_enhanced.py", line 179, in merge_data
    (df_trades["TradeTime"] >= latest_candle["close_time"] - timedelta(minutes=5)) &
  File "/Users/igorbulgakov/Library/Python/3.9/lib/python/site-packages/pandas/core/frame.py", line 4102, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/igorbulgakov/Library/Python/3.9/lib/python/site-packages/pandas/core/indexes/base.py", line 3812, in get_loc
    raise KeyError(key) from err
KeyError: 'TradeTime'
/Users/igorbulgakov/Library/Python/3.9/lib/python/site-packages/urllib3/__init__.py:35: NotOpenSSLWarning: urllib3 v2 only supports OpenSSL 1.1.1+, currently the 'ssl' module is compiled with 'LibreSSL 2.8.3'. See: https://github.com/urllib3/urllib3/issues/3020
  warnings.warn(
2025-03-27 08:09:10,471 [INFO] Training database initialized (merged_training_data and feedback tables ensured).
2025-03-27 08:09:10,472 [INFO] Model loaded successfully.
2025-03-27 08:09:10,479 [INFO] Loaded extras data from DB: 2000 rows.
2025-03-27 08:09:10,487 [INFO] Loaded trades data from DB: 4346 rows.
2025-03-27 08:09:10,488 [INFO] Loaded orderbook data from DB: 12 rows.
Traceback (most recent call last):
  File "/Users/igorbulgakov/Library/Python/3.9/lib/python/site-packages/pandas/core/indexes/base.py", line 3805, in get_loc
    return self._engine.get_loc(casted_key)
  File "index.pyx", line 167, in pandas._libs.index.IndexEngine.get_loc
  File "index.pyx", line 196, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 7081, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 7089, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'TradeTime'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/igorbulgakov/Documents/vib_bot/train_model_online_enhanced.py", line 306, in <module>
    main_loop()
  File "/Users/igorbulgakov/Documents/vib_bot/train_model_online_enhanced.py", line 302, in main_loop
    run_ml_inference(model)
  File "/Users/igorbulgakov/Documents/vib_bot/train_model_online_enhanced.py", line 272, in run_ml_inference
    merged_result = merge_data(df_extras, df_trades, df_orderbook)
  File "/Users/igorbulgakov/Documents/vib_bot/train_model_online_enhanced.py", line 179, in merge_data
    (df_trades["TradeTime"] >= latest_candle["close_time"] - timedelta(minutes=5)) &
  File "/Users/igorbulgakov/Library/Python/3.9/lib/python/site-packages/pandas/core/frame.py", line 4102, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/igorbulgakov/Library/Python/3.9/lib/python/site-packages/pandas/core/indexes/base.py", line 3812, in get_loc
    raise KeyError(key) from err
KeyError: 'TradeTime'
/Users/igorbulgakov/Library/Python/3.9/lib/python/site-packages/urllib3/__init__.py:35: NotOpenSSLWarning: urllib3 v2 only supports OpenSSL 1.1.1+, currently the 'ssl' module is compiled with 'LibreSSL 2.8.3'. See: https://github.com/urllib3/urllib3/issues/3020
  warnings.warn(
2025-03-27 08:09:40,498 [INFO] Training database initialized (merged_training_data and feedback tables ensured).
2025-03-27 08:09:40,498 [INFO] Model loaded successfully.
2025-03-27 08:09:40,505 [INFO] Loaded extras data from DB: 2000 rows.
2025-03-27 08:09:40,513 [INFO] Loaded trades data from DB: 4346 rows.
2025-03-27 08:09:40,514 [INFO] Loaded orderbook data from DB: 12 rows.
Traceback (most recent call last):
  File "/Users/igorbulgakov/Library/Python/3.9/lib/python/site-packages/pandas/core/indexes/base.py", line 3805, in get_loc
    return self._engine.get_loc(casted_key)
  File "index.pyx", line 167, in pandas._libs.index.IndexEngine.get_loc
  File "index.pyx", line 196, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 7081, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 7089, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'TradeTime'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/igorbulgakov/Documents/vib_bot/train_model_online_enhanced.py", line 306, in <module>
    main_loop()
  File "/Users/igorbulgakov/Documents/vib_bot/train_model_online_enhanced.py", line 302, in main_loop
    run_ml_inference(model)
  File "/Users/igorbulgakov/Documents/vib_bot/train_model_online_enhanced.py", line 272, in run_ml_inference
    merged_result = merge_data(df_extras, df_trades, df_orderbook)
  File "/Users/igorbulgakov/Documents/vib_bot/train_model_online_enhanced.py", line 179, in merge_data
    (df_trades["TradeTime"] >= latest_candle["close_time"] - timedelta(minutes=5)) &
  File "/Users/igorbulgakov/Library/Python/3.9/lib/python/site-packages/pandas/core/frame.py", line 4102, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/igorbulgakov/Library/Python/3.9/lib/python/site-packages/pandas/core/indexes/base.py", line 3812, in get_loc
    raise KeyError(key) from err
KeyError: 'TradeTime'
/Users/igorbulgakov/Library/Python/3.9/lib/python/site-packages/urllib3/__init__.py:35: NotOpenSSLWarning: urllib3 v2 only supports OpenSSL 1.1.1+, currently the 'ssl' module is compiled with 'LibreSSL 2.8.3'. See: https://github.com/urllib3/urllib3/issues/3020
  warnings.warn(
2025-03-27 08:10:10,496 [INFO] Training database initialized (merged_training_data and feedback tables ensured).
2025-03-27 08:10:10,496 [INFO] Model loaded successfully.
2025-03-27 08:10:10,503 [INFO] Loaded extras data from DB: 2000 rows.
2025-03-27 08:10:10,511 [INFO] Loaded trades data from DB: 4346 rows.
2025-03-27 08:10:10,512 [INFO] Loaded orderbook data from DB: 12 rows.
Traceback (most recent call last):
  File "/Users/igorbulgakov/Library/Python/3.9/lib/python/site-packages/pandas/core/indexes/base.py", line 3805, in get_loc
    return self._engine.get_loc(casted_key)
  File "index.pyx", line 167, in pandas._libs.index.IndexEngine.get_loc
  File "index.pyx", line 196, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 7081, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 7089, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'TradeTime'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/igorbulgakov/Documents/vib_bot/train_model_online_enhanced.py", line 306, in <module>
    main_loop()
  File "/Users/igorbulgakov/Documents/vib_bot/train_model_online_enhanced.py", line 302, in main_loop
    run_ml_inference(model)
  File "/Users/igorbulgakov/Documents/vib_bot/train_model_online_enhanced.py", line 272, in run_ml_inference
    merged_result = merge_data(df_extras, df_trades, df_orderbook)
  File "/Users/igorbulgakov/Documents/vib_bot/train_model_online_enhanced.py", line 179, in merge_data
    (df_trades["TradeTime"] >= latest_candle["close_time"] - timedelta(minutes=5)) &
  File "/Users/igorbulgakov/Library/Python/3.9/lib/python/site-packages/pandas/core/frame.py", line 4102, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/igorbulgakov/Library/Python/3.9/lib/python/site-packages/pandas/core/indexes/base.py", line 3812, in get_loc
    raise KeyError(key) from err
KeyError: 'TradeTime'
/Users/igorbulgakov/Library/Python/3.9/lib/python/site-packages/urllib3/__init__.py:35: NotOpenSSLWarning: urllib3 v2 only supports OpenSSL 1.1.1+, currently the 'ssl' module is compiled with 'LibreSSL 2.8.3'. See: https://github.com/urllib3/urllib3/issues/3020
  warnings.warn(
2025-03-27 08:10:40,522 [INFO] Training database initialized (merged_training_data and feedback tables ensured).
2025-03-27 08:10:40,522 [INFO] Model loaded successfully.
2025-03-27 08:10:40,530 [INFO] Loaded extras data from DB: 2000 rows.
2025-03-27 08:10:40,538 [INFO] Loaded trades data from DB: 4346 rows.
2025-03-27 08:10:40,539 [INFO] Loaded orderbook data from DB: 12 rows.
Traceback (most recent call last):
  File "/Users/igorbulgakov/Library/Python/3.9/lib/python/site-packages/pandas/core/indexes/base.py", line 3805, in get_loc
    return self._engine.get_loc(casted_key)
  File "index.pyx", line 167, in pandas._libs.index.IndexEngine.get_loc
  File "index.pyx", line 196, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 7081, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 7089, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'TradeTime'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/igorbulgakov/Documents/vib_bot/train_model_online_enhanced.py", line 306, in <module>
    main_loop()
  File "/Users/igorbulgakov/Documents/vib_bot/train_model_online_enhanced.py", line 302, in main_loop
    run_ml_inference(model)
  File "/Users/igorbulgakov/Documents/vib_bot/train_model_online_enhanced.py", line 272, in run_ml_inference
    merged_result = merge_data(df_extras, df_trades, df_orderbook)
  File "/Users/igorbulgakov/Documents/vib_bot/train_model_online_enhanced.py", line 179, in merge_data
    (df_trades["TradeTime"] >= latest_candle["close_time"] - timedelta(minutes=5)) &
  File "/Users/igorbulgakov/Library/Python/3.9/lib/python/site-packages/pandas/core/frame.py", line 4102, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/igorbulgakov/Library/Python/3.9/lib/python/site-packages/pandas/core/indexes/base.py", line 3812, in get_loc
    raise KeyError(key) from err
KeyError: 'TradeTime'
/Users/igorbulgakov/Library/Python/3.9/lib/python/site-packages/urllib3/__init__.py:35: NotOpenSSLWarning: urllib3 v2 only supports OpenSSL 1.1.1+, currently the 'ssl' module is compiled with 'LibreSSL 2.8.3'. See: https://github.com/urllib3/urllib3/issues/3020
  warnings.warn(
2025-03-27 08:11:10,521 [INFO] Training database initialized (merged_training_data and feedback tables ensured).
2025-03-27 08:11:10,521 [INFO] Model loaded successfully.
2025-03-27 08:11:10,529 [INFO] Loaded extras data from DB: 2000 rows.
2025-03-27 08:11:10,538 [INFO] Loaded trades data from DB: 4346 rows.
2025-03-27 08:11:10,539 [INFO] Loaded orderbook data from DB: 12 rows.
Traceback (most recent call last):
  File "/Users/igorbulgakov/Library/Python/3.9/lib/python/site-packages/pandas/core/indexes/base.py", line 3805, in get_loc
    return self._engine.get_loc(casted_key)
  File "index.pyx", line 167, in pandas._libs.index.IndexEngine.get_loc
  File "index.pyx", line 196, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 7081, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 7089, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'TradeTime'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/igorbulgakov/Documents/vib_bot/train_model_online_enhanced.py", line 306, in <module>
    main_loop()
  File "/Users/igorbulgakov/Documents/vib_bot/train_model_online_enhanced.py", line 302, in main_loop
    run_ml_inference(model)
  File "/Users/igorbulgakov/Documents/vib_bot/train_model_online_enhanced.py", line 272, in run_ml_inference
    merged_result = merge_data(df_extras, df_trades, df_orderbook)
  File "/Users/igorbulgakov/Documents/vib_bot/train_model_online_enhanced.py", line 179, in merge_data
    (df_trades["TradeTime"] >= latest_candle["close_time"] - timedelta(minutes=5)) &
  File "/Users/igorbulgakov/Library/Python/3.9/lib/python/site-packages/pandas/core/frame.py", line 4102, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/igorbulgakov/Library/Python/3.9/lib/python/site-packages/pandas/core/indexes/base.py", line 3812, in get_loc
    raise KeyError(key) from err
KeyError: 'TradeTime'
/Users/igorbulgakov/Library/Python/3.9/lib/python/site-packages/urllib3/__init__.py:35: NotOpenSSLWarning: urllib3 v2 only supports OpenSSL 1.1.1+, currently the 'ssl' module is compiled with 'LibreSSL 2.8.3'. See: https://github.com/urllib3/urllib3/issues/3020
  warnings.warn(
2025-03-27 08:11:40,544 [INFO] Training database initialized (merged_training_data and feedback tables ensured).
2025-03-27 08:11:40,544 [INFO] Model loaded successfully.
2025-03-27 08:11:40,551 [INFO] Loaded extras data from DB: 2000 rows.
2025-03-27 08:11:40,559 [INFO] Loaded trades data from DB: 4348 rows.
2025-03-27 08:11:40,560 [INFO] Loaded orderbook data from DB: 12 rows.
Traceback (most recent call last):
  File "/Users/igorbulgakov/Library/Python/3.9/lib/python/site-packages/pandas/core/indexes/base.py", line 3805, in get_loc
    return self._engine.get_loc(casted_key)
  File "index.pyx", line 167, in pandas._libs.index.IndexEngine.get_loc
  File "index.pyx", line 196, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 7081, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 7089, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'TradeTime'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/igorbulgakov/Documents/vib_bot/train_model_online_enhanced.py", line 306, in <module>
    main_loop()
  File "/Users/igorbulgakov/Documents/vib_bot/train_model_online_enhanced.py", line 302, in main_loop
    run_ml_inference(model)
  File "/Users/igorbulgakov/Documents/vib_bot/train_model_online_enhanced.py", line 272, in run_ml_inference
    merged_result = merge_data(df_extras, df_trades, df_orderbook)
  File "/Users/igorbulgakov/Documents/vib_bot/train_model_online_enhanced.py", line 179, in merge_data
    (df_trades["TradeTime"] >= latest_candle["close_time"] - timedelta(minutes=5)) &
  File "/Users/igorbulgakov/Library/Python/3.9/lib/python/site-packages/pandas/core/frame.py", line 4102, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/igorbulgakov/Library/Python/3.9/lib/python/site-packages/pandas/core/indexes/base.py", line 3812, in get_loc
    raise KeyError(key) from err
KeyError: 'TradeTime'
/Users/igorbulgakov/Library/Python/3.9/lib/python/site-packages/urllib3/__init__.py:35: NotOpenSSLWarning: urllib3 v2 only supports OpenSSL 1.1.1+, currently the 'ssl' module is compiled with 'LibreSSL 2.8.3'. See: https://github.com/urllib3/urllib3/issues/3020
  warnings.warn(
2025-03-27 08:12:10,624 [INFO] Training database initialized (merged_training_data and feedback tables ensured).
2025-03-27 08:12:10,624 [INFO] Model loaded successfully.
2025-03-27 08:12:10,632 [INFO] Loaded extras data from DB: 2000 rows.
2025-03-27 08:12:10,641 [INFO] Loaded trades data from DB: 4353 rows.
2025-03-27 08:12:10,642 [INFO] Loaded orderbook data from DB: 12 rows.
Traceback (most recent call last):
  File "/Users/igorbulgakov/Library/Python/3.9/lib/python/site-packages/pandas/core/indexes/base.py", line 3805, in get_loc
    return self._engine.get_loc(casted_key)
  File "index.pyx", line 167, in pandas._libs.index.IndexEngine.get_loc
  File "index.pyx", line 196, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 7081, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 7089, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'TradeTime'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/igorbulgakov/Documents/vib_bot/train_model_online_enhanced.py", line 306, in <module>
    main_loop()
  File "/Users/igorbulgakov/Documents/vib_bot/train_model_online_enhanced.py", line 302, in main_loop
    run_ml_inference(model)
  File "/Users/igorbulgakov/Documents/vib_bot/train_model_online_enhanced.py", line 272, in run_ml_inference
    merged_result = merge_data(df_extras, df_trades, df_orderbook)
  File "/Users/igorbulgakov/Documents/vib_bot/train_model_online_enhanced.py", line 179, in merge_data
    (df_trades["TradeTime"] >= latest_candle["close_time"] - timedelta(minutes=5)) &
  File "/Users/igorbulgakov/Library/Python/3.9/lib/python/site-packages/pandas/core/frame.py", line 4102, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/igorbulgakov/Library/Python/3.9/lib/python/site-packages/pandas/core/indexes/base.py", line 3812, in get_loc
    raise KeyError(key) from err
KeyError: 'TradeTime'
/Users/igorbulgakov/Library/Python/3.9/lib/python/site-packages/urllib3/__init__.py:35: NotOpenSSLWarning: urllib3 v2 only supports OpenSSL 1.1.1+, currently the 'ssl' module is compiled with 'LibreSSL 2.8.3'. See: https://github.com/urllib3/urllib3/issues/3020
  warnings.warn(
2025-03-27 08:12:40,583 [INFO] Training database initialized (merged_training_data and feedback tables ensured).
2025-03-27 08:12:40,584 [INFO] Model loaded successfully.
2025-03-27 08:12:40,591 [INFO] Loaded extras data from DB: 2000 rows.
2025-03-27 08:12:40,599 [INFO] Loaded trades data from DB: 4359 rows.
2025-03-27 08:12:40,600 [INFO] Loaded orderbook data from DB: 12 rows.
Traceback (most recent call last):
  File "/Users/igorbulgakov/Library/Python/3.9/lib/python/site-packages/pandas/core/indexes/base.py", line 3805, in get_loc
    return self._engine.get_loc(casted_key)
  File "index.pyx", line 167, in pandas._libs.index.IndexEngine.get_loc
  File "index.pyx", line 196, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 7081, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 7089, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'TradeTime'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/igorbulgakov/Documents/vib_bot/train_model_online_enhanced.py", line 306, in <module>
    main_loop()
  File "/Users/igorbulgakov/Documents/vib_bot/train_model_online_enhanced.py", line 302, in main_loop
    run_ml_inference(model)
  File "/Users/igorbulgakov/Documents/vib_bot/train_model_online_enhanced.py", line 272, in run_ml_inference
    merged_result = merge_data(df_extras, df_trades, df_orderbook)
  File "/Users/igorbulgakov/Documents/vib_bot/train_model_online_enhanced.py", line 179, in merge_data
    (df_trades["TradeTime"] >= latest_candle["close_time"] - timedelta(minutes=5)) &
  File "/Users/igorbulgakov/Library/Python/3.9/lib/python/site-packages/pandas/core/frame.py", line 4102, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/igorbulgakov/Library/Python/3.9/lib/python/site-packages/pandas/core/indexes/base.py", line 3812, in get_loc
    raise KeyError(key) from err
KeyError: 'TradeTime'
/Users/igorbulgakov/Library/Python/3.9/lib/python/site-packages/urllib3/__init__.py:35: NotOpenSSLWarning: urllib3 v2 only supports OpenSSL 1.1.1+, currently the 'ssl' module is compiled with 'LibreSSL 2.8.3'. See: https://github.com/urllib3/urllib3/issues/3020
  warnings.warn(
2025-03-27 08:13:10,598 [INFO] Training database initialized (merged_training_data and feedback tables ensured).
2025-03-27 08:13:10,599 [INFO] Model loaded successfully.
2025-03-27 08:13:10,606 [INFO] Loaded extras data from DB: 2000 rows.
2025-03-27 08:13:10,615 [INFO] Loaded trades data from DB: 4371 rows.
2025-03-27 08:13:10,615 [INFO] Loaded orderbook data from DB: 12 rows.
Traceback (most recent call last):
  File "/Users/igorbulgakov/Library/Python/3.9/lib/python/site-packages/pandas/core/indexes/base.py", line 3805, in get_loc
    return self._engine.get_loc(casted_key)
  File "index.pyx", line 167, in pandas._libs.index.IndexEngine.get_loc
  File "index.pyx", line 196, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 7081, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 7089, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'TradeTime'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/igorbulgakov/Documents/vib_bot/train_model_online_enhanced.py", line 306, in <module>
    main_loop()
  File "/Users/igorbulgakov/Documents/vib_bot/train_model_online_enhanced.py", line 302, in main_loop
    run_ml_inference(model)
  File "/Users/igorbulgakov/Documents/vib_bot/train_model_online_enhanced.py", line 272, in run_ml_inference
    merged_result = merge_data(df_extras, df_trades, df_orderbook)
  File "/Users/igorbulgakov/Documents/vib_bot/train_model_online_enhanced.py", line 179, in merge_data
    (df_trades["TradeTime"] >= latest_candle["close_time"] - timedelta(minutes=5)) &
  File "/Users/igorbulgakov/Library/Python/3.9/lib/python/site-packages/pandas/core/frame.py", line 4102, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/igorbulgakov/Library/Python/3.9/lib/python/site-packages/pandas/core/indexes/base.py", line 3812, in get_loc
    raise KeyError(key) from err
KeyError: 'TradeTime'
/Users/igorbulgakov/Library/Python/3.9/lib/python/site-packages/urllib3/__init__.py:35: NotOpenSSLWarning: urllib3 v2 only supports OpenSSL 1.1.1+, currently the 'ssl' module is compiled with 'LibreSSL 2.8.3'. See: https://github.com/urllib3/urllib3/issues/3020
  warnings.warn(
2025-03-27 08:13:40,587 [INFO] Training database initialized (merged_training_data and feedback tables ensured).
2025-03-27 08:13:40,587 [INFO] Model loaded successfully.
2025-03-27 08:13:40,594 [INFO] Loaded extras data from DB: 2000 rows.
2025-03-27 08:13:40,603 [INFO] Loaded trades data from DB: 4378 rows.
2025-03-27 08:13:40,603 [INFO] Loaded orderbook data from DB: 12 rows.
Traceback (most recent call last):
  File "/Users/igorbulgakov/Library/Python/3.9/lib/python/site-packages/pandas/core/indexes/base.py", line 3805, in get_loc
    return self._engine.get_loc(casted_key)
  File "index.pyx", line 167, in pandas._libs.index.IndexEngine.get_loc
  File "index.pyx", line 196, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 7081, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 7089, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'TradeTime'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/igorbulgakov/Documents/vib_bot/train_model_online_enhanced.py", line 306, in <module>
    main_loop()
  File "/Users/igorbulgakov/Documents/vib_bot/train_model_online_enhanced.py", line 302, in main_loop
    run_ml_inference(model)
  File "/Users/igorbulgakov/Documents/vib_bot/train_model_online_enhanced.py", line 272, in run_ml_inference
    merged_result = merge_data(df_extras, df_trades, df_orderbook)
  File "/Users/igorbulgakov/Documents/vib_bot/train_model_online_enhanced.py", line 179, in merge_data
    (df_trades["TradeTime"] >= latest_candle["close_time"] - timedelta(minutes=5)) &
  File "/Users/igorbulgakov/Library/Python/3.9/lib/python/site-packages/pandas/core/frame.py", line 4102, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/igorbulgakov/Library/Python/3.9/lib/python/site-packages/pandas/core/indexes/base.py", line 3812, in get_loc
    raise KeyError(key) from err
KeyError: 'TradeTime'
/Users/igorbulgakov/Library/Python/3.9/lib/python/site-packages/urllib3/__init__.py:35: NotOpenSSLWarning: urllib3 v2 only supports OpenSSL 1.1.1+, currently the 'ssl' module is compiled with 'LibreSSL 2.8.3'. See: https://github.com/urllib3/urllib3/issues/3020
  warnings.warn(
2025-03-27 08:14:10,594 [INFO] Training database initialized (merged_training_data and feedback tables ensured).
2025-03-27 08:14:10,594 [INFO] Model loaded successfully.
2025-03-27 08:14:10,602 [INFO] Loaded extras data from DB: 2000 rows.
2025-03-27 08:14:10,611 [INFO] Loaded trades data from DB: 4378 rows.
2025-03-27 08:14:10,612 [INFO] Loaded orderbook data from DB: 12 rows.
Traceback (most recent call last):
  File "/Users/igorbulgakov/Library/Python/3.9/lib/python/site-packages/pandas/core/indexes/base.py", line 3805, in get_loc
    return self._engine.get_loc(casted_key)
  File "index.pyx", line 167, in pandas._libs.index.IndexEngine.get_loc
  File "index.pyx", line 196, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 7081, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 7089, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'TradeTime'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/igorbulgakov/Documents/vib_bot/train_model_online_enhanced.py", line 306, in <module>
    main_loop()
  File "/Users/igorbulgakov/Documents/vib_bot/train_model_online_enhanced.py", line 302, in main_loop
    run_ml_inference(model)
  File "/Users/igorbulgakov/Documents/vib_bot/train_model_online_enhanced.py", line 272, in run_ml_inference
    merged_result = merge_data(df_extras, df_trades, df_orderbook)
  File "/Users/igorbulgakov/Documents/vib_bot/train_model_online_enhanced.py", line 179, in merge_data
    (df_trades["TradeTime"] >= latest_candle["close_time"] - timedelta(minutes=5)) &
  File "/Users/igorbulgakov/Library/Python/3.9/lib/python/site-packages/pandas/core/frame.py", line 4102, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/igorbulgakov/Library/Python/3.9/lib/python/site-packages/pandas/core/indexes/base.py", line 3812, in get_loc
    raise KeyError(key) from err
KeyError: 'TradeTime'
/Users/igorbulgakov/Library/Python/3.9/lib/python/site-packages/urllib3/__init__.py:35: NotOpenSSLWarning: urllib3 v2 only supports OpenSSL 1.1.1+, currently the 'ssl' module is compiled with 'LibreSSL 2.8.3'. See: https://github.com/urllib3/urllib3/issues/3020
  warnings.warn(
2025-03-27 08:14:40,602 [INFO] Training database initialized (merged_training_data and feedback tables ensured).
2025-03-27 08:14:40,602 [INFO] Model loaded successfully.
2025-03-27 08:14:40,609 [INFO] Loaded extras data from DB: 2000 rows.
2025-03-27 08:14:40,618 [INFO] Loaded trades data from DB: 4381 rows.
2025-03-27 08:14:40,619 [INFO] Loaded orderbook data from DB: 12 rows.
Traceback (most recent call last):
  File "/Users/igorbulgakov/Library/Python/3.9/lib/python/site-packages/pandas/core/indexes/base.py", line 3805, in get_loc
    return self._engine.get_loc(casted_key)
  File "index.pyx", line 167, in pandas._libs.index.IndexEngine.get_loc
  File "index.pyx", line 196, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 7081, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 7089, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'TradeTime'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/igorbulgakov/Documents/vib_bot/train_model_online_enhanced.py", line 306, in <module>
    main_loop()
  File "/Users/igorbulgakov/Documents/vib_bot/train_model_online_enhanced.py", line 302, in main_loop
    run_ml_inference(model)
  File "/Users/igorbulgakov/Documents/vib_bot/train_model_online_enhanced.py", line 272, in run_ml_inference
    merged_result = merge_data(df_extras, df_trades, df_orderbook)
  File "/Users/igorbulgakov/Documents/vib_bot/train_model_online_enhanced.py", line 179, in merge_data
    (df_trades["TradeTime"] >= latest_candle["close_time"] - timedelta(minutes=5)) &
  File "/Users/igorbulgakov/Library/Python/3.9/lib/python/site-packages/pandas/core/frame.py", line 4102, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/igorbulgakov/Library/Python/3.9/lib/python/site-packages/pandas/core/indexes/base.py", line 3812, in get_loc
    raise KeyError(key) from err
KeyError: 'TradeTime'
/Users/igorbulgakov/Library/Python/3.9/lib/python/site-packages/urllib3/__init__.py:35: NotOpenSSLWarning: urllib3 v2 only supports OpenSSL 1.1.1+, currently the 'ssl' module is compiled with 'LibreSSL 2.8.3'. See: https://github.com/urllib3/urllib3/issues/3020
  warnings.warn(
2025-03-27 08:15:10,664 [INFO] Training database initialized (merged_training_data and feedback tables ensured).
2025-03-27 08:15:10,664 [INFO] Model loaded successfully.
2025-03-27 08:15:10,672 [INFO] Loaded extras data from DB: 2000 rows.
2025-03-27 08:15:10,680 [INFO] Loaded trades data from DB: 4386 rows.
2025-03-27 08:15:10,681 [INFO] Loaded orderbook data from DB: 12 rows.
Traceback (most recent call last):
  File "/Users/igorbulgakov/Library/Python/3.9/lib/python/site-packages/pandas/core/indexes/base.py", line 3805, in get_loc
    return self._engine.get_loc(casted_key)
  File "index.pyx", line 167, in pandas._libs.index.IndexEngine.get_loc
  File "index.pyx", line 196, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 7081, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 7089, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'TradeTime'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/igorbulgakov/Documents/vib_bot/train_model_online_enhanced.py", line 306, in <module>
    main_loop()
  File "/Users/igorbulgakov/Documents/vib_bot/train_model_online_enhanced.py", line 302, in main_loop
    run_ml_inference(model)
  File "/Users/igorbulgakov/Documents/vib_bot/train_model_online_enhanced.py", line 272, in run_ml_inference
    merged_result = merge_data(df_extras, df_trades, df_orderbook)
  File "/Users/igorbulgakov/Documents/vib_bot/train_model_online_enhanced.py", line 179, in merge_data
    (df_trades["TradeTime"] >= latest_candle["close_time"] - timedelta(minutes=5)) &
  File "/Users/igorbulgakov/Library/Python/3.9/lib/python/site-packages/pandas/core/frame.py", line 4102, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/igorbulgakov/Library/Python/3.9/lib/python/site-packages/pandas/core/indexes/base.py", line 3812, in get_loc
    raise KeyError(key) from err
KeyError: 'TradeTime'
/Users/igorbulgakov/Library/Python/3.9/lib/python/site-packages/urllib3/__init__.py:35: NotOpenSSLWarning: urllib3 v2 only supports OpenSSL 1.1.1+, currently the 'ssl' module is compiled with 'LibreSSL 2.8.3'. See: https://github.com/urllib3/urllib3/issues/3020
  warnings.warn(
2025-03-27 08:15:40,676 [INFO] Training database initialized (merged_training_data and feedback tables ensured).
2025-03-27 08:15:40,677 [INFO] Model loaded successfully.
2025-03-27 08:15:40,684 [INFO] Loaded extras data from DB: 2000 rows.
2025-03-27 08:15:40,693 [INFO] Loaded trades data from DB: 4387 rows.
2025-03-27 08:15:40,694 [INFO] Loaded orderbook data from DB: 12 rows.
Traceback (most recent call last):
  File "/Users/igorbulgakov/Library/Python/3.9/lib/python/site-packages/pandas/core/indexes/base.py", line 3805, in get_loc
    return self._engine.get_loc(casted_key)
  File "index.pyx", line 167, in pandas._libs.index.IndexEngine.get_loc
  File "index.pyx", line 196, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 7081, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 7089, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'TradeTime'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/igorbulgakov/Documents/vib_bot/train_model_online_enhanced.py", line 306, in <module>
    main_loop()
  File "/Users/igorbulgakov/Documents/vib_bot/train_model_online_enhanced.py", line 302, in main_loop
    run_ml_inference(model)
  File "/Users/igorbulgakov/Documents/vib_bot/train_model_online_enhanced.py", line 272, in run_ml_inference
    merged_result = merge_data(df_extras, df_trades, df_orderbook)
  File "/Users/igorbulgakov/Documents/vib_bot/train_model_online_enhanced.py", line 179, in merge_data
    (df_trades["TradeTime"] >= latest_candle["close_time"] - timedelta(minutes=5)) &
  File "/Users/igorbulgakov/Library/Python/3.9/lib/python/site-packages/pandas/core/frame.py", line 4102, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/igorbulgakov/Library/Python/3.9/lib/python/site-packages/pandas/core/indexes/base.py", line 3812, in get_loc
    raise KeyError(key) from err
KeyError: 'TradeTime'
/Users/igorbulgakov/Library/Python/3.9/lib/python/site-packages/urllib3/__init__.py:35: NotOpenSSLWarning: urllib3 v2 only supports OpenSSL 1.1.1+, currently the 'ssl' module is compiled with 'LibreSSL 2.8.3'. See: https://github.com/urllib3/urllib3/issues/3020
  warnings.warn(
2025-03-27 08:16:10,661 [INFO] Training database initialized (merged_training_data and feedback tables ensured).
2025-03-27 08:16:10,661 [INFO] Model loaded successfully.
2025-03-27 08:16:10,668 [INFO] Loaded extras data from DB: 2000 rows.
2025-03-27 08:16:10,678 [INFO] Loaded trades data from DB: 4388 rows.
2025-03-27 08:16:10,679 [INFO] Loaded orderbook data from DB: 12 rows.
Traceback (most recent call last):
  File "/Users/igorbulgakov/Library/Python/3.9/lib/python/site-packages/pandas/core/indexes/base.py", line 3805, in get_loc
    return self._engine.get_loc(casted_key)
  File "index.pyx", line 167, in pandas._libs.index.IndexEngine.get_loc
  File "index.pyx", line 196, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 7081, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 7089, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'TradeTime'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/igorbulgakov/Documents/vib_bot/train_model_online_enhanced.py", line 306, in <module>
    main_loop()
  File "/Users/igorbulgakov/Documents/vib_bot/train_model_online_enhanced.py", line 302, in main_loop
    run_ml_inference(model)
  File "/Users/igorbulgakov/Documents/vib_bot/train_model_online_enhanced.py", line 272, in run_ml_inference
    merged_result = merge_data(df_extras, df_trades, df_orderbook)
  File "/Users/igorbulgakov/Documents/vib_bot/train_model_online_enhanced.py", line 179, in merge_data
    (df_trades["TradeTime"] >= latest_candle["close_time"] - timedelta(minutes=5)) &
  File "/Users/igorbulgakov/Library/Python/3.9/lib/python/site-packages/pandas/core/frame.py", line 4102, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/igorbulgakov/Library/Python/3.9/lib/python/site-packages/pandas/core/indexes/base.py", line 3812, in get_loc
    raise KeyError(key) from err
KeyError: 'TradeTime'
/Users/igorbulgakov/Library/Python/3.9/lib/python/site-packages/urllib3/__init__.py:35: NotOpenSSLWarning: urllib3 v2 only supports OpenSSL 1.1.1+, currently the 'ssl' module is compiled with 'LibreSSL 2.8.3'. See: https://github.com/urllib3/urllib3/issues/3020
  warnings.warn(
2025-03-27 08:16:40,697 [INFO] Training database initialized (merged_training_data and feedback tables ensured).
2025-03-27 08:16:40,698 [INFO] Model loaded successfully.
2025-03-27 08:16:40,705 [INFO] Loaded extras data from DB: 2000 rows.
2025-03-27 08:16:40,713 [INFO] Loaded trades data from DB: 4393 rows.
2025-03-27 08:16:40,714 [INFO] Loaded orderbook data from DB: 12 rows.
Traceback (most recent call last):
  File "/Users/igorbulgakov/Library/Python/3.9/lib/python/site-packages/pandas/core/indexes/base.py", line 3805, in get_loc
    return self._engine.get_loc(casted_key)
  File "index.pyx", line 167, in pandas._libs.index.IndexEngine.get_loc
  File "index.pyx", line 196, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 7081, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 7089, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'TradeTime'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/igorbulgakov/Documents/vib_bot/train_model_online_enhanced.py", line 306, in <module>
    main_loop()
  File "/Users/igorbulgakov/Documents/vib_bot/train_model_online_enhanced.py", line 302, in main_loop
    run_ml_inference(model)
  File "/Users/igorbulgakov/Documents/vib_bot/train_model_online_enhanced.py", line 272, in run_ml_inference
    merged_result = merge_data(df_extras, df_trades, df_orderbook)
  File "/Users/igorbulgakov/Documents/vib_bot/train_model_online_enhanced.py", line 179, in merge_data
    (df_trades["TradeTime"] >= latest_candle["close_time"] - timedelta(minutes=5)) &
  File "/Users/igorbulgakov/Library/Python/3.9/lib/python/site-packages/pandas/core/frame.py", line 4102, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/igorbulgakov/Library/Python/3.9/lib/python/site-packages/pandas/core/indexes/base.py", line 3812, in get_loc
    raise KeyError(key) from err
KeyError: 'TradeTime'
/Users/igorbulgakov/Library/Python/3.9/lib/python/site-packages/urllib3/__init__.py:35: NotOpenSSLWarning: urllib3 v2 only supports OpenSSL 1.1.1+, currently the 'ssl' module is compiled with 'LibreSSL 2.8.3'. See: https://github.com/urllib3/urllib3/issues/3020
  warnings.warn(
2025-03-27 08:17:10,678 [INFO] Training database initialized (merged_training_data and feedback tables ensured).
2025-03-27 08:17:10,678 [INFO] Model loaded successfully.
2025-03-27 08:17:10,685 [INFO] Loaded extras data from DB: 2000 rows.
2025-03-27 08:17:10,694 [INFO] Loaded trades data from DB: 4410 rows.
2025-03-27 08:17:10,695 [INFO] Loaded orderbook data from DB: 12 rows.
Traceback (most recent call last):
  File "/Users/igorbulgakov/Library/Python/3.9/lib/python/site-packages/pandas/core/indexes/base.py", line 3805, in get_loc
    return self._engine.get_loc(casted_key)
  File "index.pyx", line 167, in pandas._libs.index.IndexEngine.get_loc
  File "index.pyx", line 196, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 7081, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 7089, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'TradeTime'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/igorbulgakov/Documents/vib_bot/train_model_online_enhanced.py", line 306, in <module>
    main_loop()
  File "/Users/igorbulgakov/Documents/vib_bot/train_model_online_enhanced.py", line 302, in main_loop
    run_ml_inference(model)
  File "/Users/igorbulgakov/Documents/vib_bot/train_model_online_enhanced.py", line 272, in run_ml_inference
    merged_result = merge_data(df_extras, df_trades, df_orderbook)
  File "/Users/igorbulgakov/Documents/vib_bot/train_model_online_enhanced.py", line 179, in merge_data
    (df_trades["TradeTime"] >= latest_candle["close_time"] - timedelta(minutes=5)) &
  File "/Users/igorbulgakov/Library/Python/3.9/lib/python/site-packages/pandas/core/frame.py", line 4102, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/igorbulgakov/Library/Python/3.9/lib/python/site-packages/pandas/core/indexes/base.py", line 3812, in get_loc
    raise KeyError(key) from err
KeyError: 'TradeTime'
/Users/igorbulgakov/Library/Python/3.9/lib/python/site-packages/urllib3/__init__.py:35: NotOpenSSLWarning: urllib3 v2 only supports OpenSSL 1.1.1+, currently the 'ssl' module is compiled with 'LibreSSL 2.8.3'. See: https://github.com/urllib3/urllib3/issues/3020
  warnings.warn(
2025-03-27 08:17:40,663 [INFO] Training database initialized (merged_training_data and feedback tables ensured).
2025-03-27 08:17:40,664 [INFO] Model loaded successfully.
2025-03-27 08:17:40,671 [INFO] Loaded extras data from DB: 2000 rows.
2025-03-27 08:17:40,680 [INFO] Loaded trades data from DB: 4417 rows.
2025-03-27 08:17:40,681 [INFO] Loaded orderbook data from DB: 12 rows.
Traceback (most recent call last):
  File "/Users/igorbulgakov/Library/Python/3.9/lib/python/site-packages/pandas/core/indexes/base.py", line 3805, in get_loc
    return self._engine.get_loc(casted_key)
  File "index.pyx", line 167, in pandas._libs.index.IndexEngine.get_loc
  File "index.pyx", line 196, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 7081, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 7089, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'TradeTime'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/igorbulgakov/Documents/vib_bot/train_model_online_enhanced.py", line 306, in <module>
    main_loop()
  File "/Users/igorbulgakov/Documents/vib_bot/train_model_online_enhanced.py", line 302, in main_loop
    run_ml_inference(model)
  File "/Users/igorbulgakov/Documents/vib_bot/train_model_online_enhanced.py", line 272, in run_ml_inference
    merged_result = merge_data(df_extras, df_trades, df_orderbook)
  File "/Users/igorbulgakov/Documents/vib_bot/train_model_online_enhanced.py", line 179, in merge_data
    (df_trades["TradeTime"] >= latest_candle["close_time"] - timedelta(minutes=5)) &
  File "/Users/igorbulgakov/Library/Python/3.9/lib/python/site-packages/pandas/core/frame.py", line 4102, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/igorbulgakov/Library/Python/3.9/lib/python/site-packages/pandas/core/indexes/base.py", line 3812, in get_loc
    raise KeyError(key) from err
KeyError: 'TradeTime'
/Users/igorbulgakov/Library/Python/3.9/lib/python/site-packages/urllib3/__init__.py:35: NotOpenSSLWarning: urllib3 v2 only supports OpenSSL 1.1.1+, currently the 'ssl' module is compiled with 'LibreSSL 2.8.3'. See: https://github.com/urllib3/urllib3/issues/3020
  warnings.warn(
2025-03-27 08:18:10,707 [INFO] Training database initialized (merged_training_data and feedback tables ensured).
2025-03-27 08:18:10,707 [INFO] Model loaded successfully.
2025-03-27 08:18:10,715 [INFO] Loaded extras data from DB: 2000 rows.
2025-03-27 08:18:10,724 [INFO] Loaded trades data from DB: 4421 rows.
2025-03-27 08:18:10,725 [INFO] Loaded orderbook data from DB: 12 rows.
Traceback (most recent call last):
  File "/Users/igorbulgakov/Library/Python/3.9/lib/python/site-packages/pandas/core/indexes/base.py", line 3805, in get_loc
    return self._engine.get_loc(casted_key)
  File "index.pyx", line 167, in pandas._libs.index.IndexEngine.get_loc
  File "index.pyx", line 196, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 7081, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 7089, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'TradeTime'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/igorbulgakov/Documents/vib_bot/train_model_online_enhanced.py", line 306, in <module>
    main_loop()
  File "/Users/igorbulgakov/Documents/vib_bot/train_model_online_enhanced.py", line 302, in main_loop
    run_ml_inference(model)
  File "/Users/igorbulgakov/Documents/vib_bot/train_model_online_enhanced.py", line 272, in run_ml_inference
    merged_result = merge_data(df_extras, df_trades, df_orderbook)
  File "/Users/igorbulgakov/Documents/vib_bot/train_model_online_enhanced.py", line 179, in merge_data
    (df_trades["TradeTime"] >= latest_candle["close_time"] - timedelta(minutes=5)) &
  File "/Users/igorbulgakov/Library/Python/3.9/lib/python/site-packages/pandas/core/frame.py", line 4102, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/igorbulgakov/Library/Python/3.9/lib/python/site-packages/pandas/core/indexes/base.py", line 3812, in get_loc
    raise KeyError(key) from err
KeyError: 'TradeTime'
/Users/igorbulgakov/Library/Python/3.9/lib/python/site-packages/urllib3/__init__.py:35: NotOpenSSLWarning: urllib3 v2 only supports OpenSSL 1.1.1+, currently the 'ssl' module is compiled with 'LibreSSL 2.8.3'. See: https://github.com/urllib3/urllib3/issues/3020
  warnings.warn(
2025-03-27 08:18:40,716 [INFO] Training database initialized (merged_training_data and feedback tables ensured).
2025-03-27 08:18:40,717 [INFO] Model loaded successfully.
2025-03-27 08:18:40,724 [INFO] Loaded extras data from DB: 2000 rows.
2025-03-27 08:18:40,733 [INFO] Loaded trades data from DB: 4425 rows.
2025-03-27 08:18:40,734 [INFO] Loaded orderbook data from DB: 12 rows.
Traceback (most recent call last):
  File "/Users/igorbulgakov/Library/Python/3.9/lib/python/site-packages/pandas/core/indexes/base.py", line 3805, in get_loc
    return self._engine.get_loc(casted_key)
  File "index.pyx", line 167, in pandas._libs.index.IndexEngine.get_loc
  File "index.pyx", line 196, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 7081, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 7089, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'TradeTime'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/igorbulgakov/Documents/vib_bot/train_model_online_enhanced.py", line 306, in <module>
    main_loop()
  File "/Users/igorbulgakov/Documents/vib_bot/train_model_online_enhanced.py", line 302, in main_loop
    run_ml_inference(model)
  File "/Users/igorbulgakov/Documents/vib_bot/train_model_online_enhanced.py", line 272, in run_ml_inference
    merged_result = merge_data(df_extras, df_trades, df_orderbook)
  File "/Users/igorbulgakov/Documents/vib_bot/train_model_online_enhanced.py", line 179, in merge_data
    (df_trades["TradeTime"] >= latest_candle["close_time"] - timedelta(minutes=5)) &
  File "/Users/igorbulgakov/Library/Python/3.9/lib/python/site-packages/pandas/core/frame.py", line 4102, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/igorbulgakov/Library/Python/3.9/lib/python/site-packages/pandas/core/indexes/base.py", line 3812, in get_loc
    raise KeyError(key) from err
KeyError: 'TradeTime'
/Users/igorbulgakov/Library/Python/3.9/lib/python/site-packages/urllib3/__init__.py:35: NotOpenSSLWarning: urllib3 v2 only supports OpenSSL 1.1.1+, currently the 'ssl' module is compiled with 'LibreSSL 2.8.3'. See: https://github.com/urllib3/urllib3/issues/3020
  warnings.warn(
2025-03-27 08:19:10,711 [INFO] Training database initialized (merged_training_data and feedback tables ensured).
2025-03-27 08:19:10,711 [INFO] Model loaded successfully.
2025-03-27 08:19:10,718 [INFO] Loaded extras data from DB: 2000 rows.
2025-03-27 08:19:10,726 [INFO] Loaded trades data from DB: 4426 rows.
2025-03-27 08:19:10,727 [INFO] Loaded orderbook data from DB: 12 rows.
Traceback (most recent call last):
  File "/Users/igorbulgakov/Library/Python/3.9/lib/python/site-packages/pandas/core/indexes/base.py", line 3805, in get_loc
    return self._engine.get_loc(casted_key)
  File "index.pyx", line 167, in pandas._libs.index.IndexEngine.get_loc
  File "index.pyx", line 196, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 7081, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 7089, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'TradeTime'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/igorbulgakov/Documents/vib_bot/train_model_online_enhanced.py", line 306, in <module>
    main_loop()
  File "/Users/igorbulgakov/Documents/vib_bot/train_model_online_enhanced.py", line 302, in main_loop
    run_ml_inference(model)
  File "/Users/igorbulgakov/Documents/vib_bot/train_model_online_enhanced.py", line 272, in run_ml_inference
    merged_result = merge_data(df_extras, df_trades, df_orderbook)
  File "/Users/igorbulgakov/Documents/vib_bot/train_model_online_enhanced.py", line 179, in merge_data
    (df_trades["TradeTime"] >= latest_candle["close_time"] - timedelta(minutes=5)) &
  File "/Users/igorbulgakov/Library/Python/3.9/lib/python/site-packages/pandas/core/frame.py", line 4102, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/igorbulgakov/Library/Python/3.9/lib/python/site-packages/pandas/core/indexes/base.py", line 3812, in get_loc
    raise KeyError(key) from err
KeyError: 'TradeTime'
/Users/igorbulgakov/Library/Python/3.9/lib/python/site-packages/urllib3/__init__.py:35: NotOpenSSLWarning: urllib3 v2 only supports OpenSSL 1.1.1+, currently the 'ssl' module is compiled with 'LibreSSL 2.8.3'. See: https://github.com/urllib3/urllib3/issues/3020
  warnings.warn(
2025-03-27 08:19:40,766 [INFO] Training database initialized (merged_training_data and feedback tables ensured).
2025-03-27 08:19:40,767 [INFO] Model loaded successfully.
2025-03-27 08:19:40,774 [INFO] Loaded extras data from DB: 2000 rows.
2025-03-27 08:19:40,782 [INFO] Loaded trades data from DB: 4431 rows.
2025-03-27 08:19:40,783 [INFO] Loaded orderbook data from DB: 12 rows.
Traceback (most recent call last):
  File "/Users/igorbulgakov/Library/Python/3.9/lib/python/site-packages/pandas/core/indexes/base.py", line 3805, in get_loc
    return self._engine.get_loc(casted_key)
  File "index.pyx", line 167, in pandas._libs.index.IndexEngine.get_loc
  File "index.pyx", line 196, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 7081, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 7089, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'TradeTime'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/igorbulgakov/Documents/vib_bot/train_model_online_enhanced.py", line 306, in <module>
    main_loop()
  File "/Users/igorbulgakov/Documents/vib_bot/train_model_online_enhanced.py", line 302, in main_loop
    run_ml_inference(model)
  File "/Users/igorbulgakov/Documents/vib_bot/train_model_online_enhanced.py", line 272, in run_ml_inference
    merged_result = merge_data(df_extras, df_trades, df_orderbook)
  File "/Users/igorbulgakov/Documents/vib_bot/train_model_online_enhanced.py", line 179, in merge_data
    (df_trades["TradeTime"] >= latest_candle["close_time"] - timedelta(minutes=5)) &
  File "/Users/igorbulgakov/Library/Python/3.9/lib/python/site-packages/pandas/core/frame.py", line 4102, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/igorbulgakov/Library/Python/3.9/lib/python/site-packages/pandas/core/indexes/base.py", line 3812, in get_loc
    raise KeyError(key) from err
KeyError: 'TradeTime'
/Users/igorbulgakov/Library/Python/3.9/lib/python/site-packages/urllib3/__init__.py:35: NotOpenSSLWarning: urllib3 v2 only supports OpenSSL 1.1.1+, currently the 'ssl' module is compiled with 'LibreSSL 2.8.3'. See: https://github.com/urllib3/urllib3/issues/3020
  warnings.warn(
2025-03-27 08:20:10,823 [INFO] Training database initialized (merged_training_data and feedback tables ensured).
2025-03-27 08:20:10,823 [INFO] Model loaded successfully.
2025-03-27 08:20:10,831 [INFO] Loaded extras data from DB: 2000 rows.
2025-03-27 08:20:10,840 [INFO] Loaded trades data from DB: 4431 rows.
2025-03-27 08:20:10,841 [INFO] Loaded orderbook data from DB: 12 rows.
Traceback (most recent call last):
  File "/Users/igorbulgakov/Library/Python/3.9/lib/python/site-packages/pandas/core/indexes/base.py", line 3805, in get_loc
    return self._engine.get_loc(casted_key)
  File "index.pyx", line 167, in pandas._libs.index.IndexEngine.get_loc
  File "index.pyx", line 196, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 7081, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 7089, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'TradeTime'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/igorbulgakov/Documents/vib_bot/train_model_online_enhanced.py", line 306, in <module>
    main_loop()
  File "/Users/igorbulgakov/Documents/vib_bot/train_model_online_enhanced.py", line 302, in main_loop
    run_ml_inference(model)
  File "/Users/igorbulgakov/Documents/vib_bot/train_model_online_enhanced.py", line 272, in run_ml_inference
    merged_result = merge_data(df_extras, df_trades, df_orderbook)
  File "/Users/igorbulgakov/Documents/vib_bot/train_model_online_enhanced.py", line 179, in merge_data
    (df_trades["TradeTime"] >= latest_candle["close_time"] - timedelta(minutes=5)) &
  File "/Users/igorbulgakov/Library/Python/3.9/lib/python/site-packages/pandas/core/frame.py", line 4102, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/igorbulgakov/Library/Python/3.9/lib/python/site-packages/pandas/core/indexes/base.py", line 3812, in get_loc
    raise KeyError(key) from err
KeyError: 'TradeTime'
/Users/igorbulgakov/Library/Python/3.9/lib/python/site-packages/urllib3/__init__.py:35: NotOpenSSLWarning: urllib3 v2 only supports OpenSSL 1.1.1+, currently the 'ssl' module is compiled with 'LibreSSL 2.8.3'. See: https://github.com/urllib3/urllib3/issues/3020
  warnings.warn(
2025-03-27 08:20:40,827 [INFO] Training database initialized (merged_training_data and feedback tables ensured).
2025-03-27 08:20:40,828 [INFO] Model loaded successfully.
2025-03-27 08:20:40,835 [INFO] Loaded extras data from DB: 2000 rows.
2025-03-27 08:20:40,845 [INFO] Loaded trades data from DB: 4433 rows.
2025-03-27 08:20:40,846 [INFO] Loaded orderbook data from DB: 12 rows.
Traceback (most recent call last):
  File "/Users/igorbulgakov/Library/Python/3.9/lib/python/site-packages/pandas/core/indexes/base.py", line 3805, in get_loc
    return self._engine.get_loc(casted_key)
  File "index.pyx", line 167, in pandas._libs.index.IndexEngine.get_loc
  File "index.pyx", line 196, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 7081, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 7089, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'TradeTime'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/igorbulgakov/Documents/vib_bot/train_model_online_enhanced.py", line 306, in <module>
    main_loop()
  File "/Users/igorbulgakov/Documents/vib_bot/train_model_online_enhanced.py", line 302, in main_loop
    run_ml_inference(model)
  File "/Users/igorbulgakov/Documents/vib_bot/train_model_online_enhanced.py", line 272, in run_ml_inference
    merged_result = merge_data(df_extras, df_trades, df_orderbook)
  File "/Users/igorbulgakov/Documents/vib_bot/train_model_online_enhanced.py", line 179, in merge_data
    (df_trades["TradeTime"] >= latest_candle["close_time"] - timedelta(minutes=5)) &
  File "/Users/igorbulgakov/Library/Python/3.9/lib/python/site-packages/pandas/core/frame.py", line 4102, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/igorbulgakov/Library/Python/3.9/lib/python/site-packages/pandas/core/indexes/base.py", line 3812, in get_loc
    raise KeyError(key) from err
KeyError: 'TradeTime'
/Users/igorbulgakov/Library/Python/3.9/lib/python/site-packages/urllib3/__init__.py:35: NotOpenSSLWarning: urllib3 v2 only supports OpenSSL 1.1.1+, currently the 'ssl' module is compiled with 'LibreSSL 2.8.3'. See: https://github.com/urllib3/urllib3/issues/3020
  warnings.warn(
2025-03-27 08:21:10,838 [INFO] Training database initialized (merged_training_data and feedback tables ensured).
2025-03-27 08:21:10,839 [INFO] Model loaded successfully.
2025-03-27 08:21:10,846 [INFO] Loaded extras data from DB: 2000 rows.
2025-03-27 08:21:10,855 [INFO] Loaded trades data from DB: 4437 rows.
2025-03-27 08:21:10,856 [INFO] Loaded orderbook data from DB: 12 rows.
Traceback (most recent call last):
  File "/Users/igorbulgakov/Library/Python/3.9/lib/python/site-packages/pandas/core/indexes/base.py", line 3805, in get_loc
    return self._engine.get_loc(casted_key)
  File "index.pyx", line 167, in pandas._libs.index.IndexEngine.get_loc
  File "index.pyx", line 196, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 7081, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 7089, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'TradeTime'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/igorbulgakov/Documents/vib_bot/train_model_online_enhanced.py", line 306, in <module>
    main_loop()
  File "/Users/igorbulgakov/Documents/vib_bot/train_model_online_enhanced.py", line 302, in main_loop
    run_ml_inference(model)
  File "/Users/igorbulgakov/Documents/vib_bot/train_model_online_enhanced.py", line 272, in run_ml_inference
    merged_result = merge_data(df_extras, df_trades, df_orderbook)
  File "/Users/igorbulgakov/Documents/vib_bot/train_model_online_enhanced.py", line 179, in merge_data
    (df_trades["TradeTime"] >= latest_candle["close_time"] - timedelta(minutes=5)) &
  File "/Users/igorbulgakov/Library/Python/3.9/lib/python/site-packages/pandas/core/frame.py", line 4102, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/igorbulgakov/Library/Python/3.9/lib/python/site-packages/pandas/core/indexes/base.py", line 3812, in get_loc
    raise KeyError(key) from err
KeyError: 'TradeTime'
/Users/igorbulgakov/Library/Python/3.9/lib/python/site-packages/urllib3/__init__.py:35: NotOpenSSLWarning: urllib3 v2 only supports OpenSSL 1.1.1+, currently the 'ssl' module is compiled with 'LibreSSL 2.8.3'. See: https://github.com/urllib3/urllib3/issues/3020
  warnings.warn(
2025-03-27 08:21:40,806 [INFO] Training database initialized (merged_training_data and feedback tables ensured).
2025-03-27 08:21:40,807 [INFO] Model loaded successfully.
2025-03-27 08:21:40,814 [INFO] Loaded extras data from DB: 2000 rows.
2025-03-27 08:21:40,822 [INFO] Loaded trades data from DB: 4450 rows.
2025-03-27 08:21:40,823 [INFO] Loaded orderbook data from DB: 12 rows.
Traceback (most recent call last):
  File "/Users/igorbulgakov/Library/Python/3.9/lib/python/site-packages/pandas/core/indexes/base.py", line 3805, in get_loc
    return self._engine.get_loc(casted_key)
  File "index.pyx", line 167, in pandas._libs.index.IndexEngine.get_loc
  File "index.pyx", line 196, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 7081, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 7089, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'TradeTime'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/igorbulgakov/Documents/vib_bot/train_model_online_enhanced.py", line 306, in <module>
    main_loop()
  File "/Users/igorbulgakov/Documents/vib_bot/train_model_online_enhanced.py", line 302, in main_loop
    run_ml_inference(model)
  File "/Users/igorbulgakov/Documents/vib_bot/train_model_online_enhanced.py", line 272, in run_ml_inference
    merged_result = merge_data(df_extras, df_trades, df_orderbook)
  File "/Users/igorbulgakov/Documents/vib_bot/train_model_online_enhanced.py", line 179, in merge_data
    (df_trades["TradeTime"] >= latest_candle["close_time"] - timedelta(minutes=5)) &
  File "/Users/igorbulgakov/Library/Python/3.9/lib/python/site-packages/pandas/core/frame.py", line 4102, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/igorbulgakov/Library/Python/3.9/lib/python/site-packages/pandas/core/indexes/base.py", line 3812, in get_loc
    raise KeyError(key) from err
KeyError: 'TradeTime'
/Users/igorbulgakov/Library/Python/3.9/lib/python/site-packages/urllib3/__init__.py:35: NotOpenSSLWarning: urllib3 v2 only supports OpenSSL 1.1.1+, currently the 'ssl' module is compiled with 'LibreSSL 2.8.3'. See: https://github.com/urllib3/urllib3/issues/3020
  warnings.warn(
2025-03-27 08:22:10,817 [INFO] Training database initialized (merged_training_data and feedback tables ensured).
2025-03-27 08:22:10,818 [INFO] Model loaded successfully.
2025-03-27 08:22:10,825 [INFO] Loaded extras data from DB: 2000 rows.
2025-03-27 08:22:10,834 [INFO] Loaded trades data from DB: 4456 rows.
2025-03-27 08:22:10,835 [INFO] Loaded orderbook data from DB: 12 rows.
Traceback (most recent call last):
  File "/Users/igorbulgakov/Library/Python/3.9/lib/python/site-packages/pandas/core/indexes/base.py", line 3805, in get_loc
    return self._engine.get_loc(casted_key)
  File "index.pyx", line 167, in pandas._libs.index.IndexEngine.get_loc
  File "index.pyx", line 196, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 7081, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 7089, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'TradeTime'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/igorbulgakov/Documents/vib_bot/train_model_online_enhanced.py", line 306, in <module>
    main_loop()
  File "/Users/igorbulgakov/Documents/vib_bot/train_model_online_enhanced.py", line 302, in main_loop
    run_ml_inference(model)
  File "/Users/igorbulgakov/Documents/vib_bot/train_model_online_enhanced.py", line 272, in run_ml_inference
    merged_result = merge_data(df_extras, df_trades, df_orderbook)
  File "/Users/igorbulgakov/Documents/vib_bot/train_model_online_enhanced.py", line 179, in merge_data
    (df_trades["TradeTime"] >= latest_candle["close_time"] - timedelta(minutes=5)) &
  File "/Users/igorbulgakov/Library/Python/3.9/lib/python/site-packages/pandas/core/frame.py", line 4102, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/igorbulgakov/Library/Python/3.9/lib/python/site-packages/pandas/core/indexes/base.py", line 3812, in get_loc
    raise KeyError(key) from err
KeyError: 'TradeTime'
/Users/igorbulgakov/Library/Python/3.9/lib/python/site-packages/urllib3/__init__.py:35: NotOpenSSLWarning: urllib3 v2 only supports OpenSSL 1.1.1+, currently the 'ssl' module is compiled with 'LibreSSL 2.8.3'. See: https://github.com/urllib3/urllib3/issues/3020
  warnings.warn(
2025-03-27 08:22:40,881 [INFO] Training database initialized (merged_training_data and feedback tables ensured).
2025-03-27 08:22:40,882 [INFO] Model loaded successfully.
2025-03-27 08:22:40,889 [INFO] Loaded extras data from DB: 2000 rows.
2025-03-27 08:22:40,897 [INFO] Loaded trades data from DB: 4459 rows.
2025-03-27 08:22:40,898 [INFO] Loaded orderbook data from DB: 12 rows.
Traceback (most recent call last):
  File "/Users/igorbulgakov/Library/Python/3.9/lib/python/site-packages/pandas/core/indexes/base.py", line 3805, in get_loc
    return self._engine.get_loc(casted_key)
  File "index.pyx", line 167, in pandas._libs.index.IndexEngine.get_loc
  File "index.pyx", line 196, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 7081, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 7089, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'TradeTime'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/igorbulgakov/Documents/vib_bot/train_model_online_enhanced.py", line 306, in <module>
    main_loop()
  File "/Users/igorbulgakov/Documents/vib_bot/train_model_online_enhanced.py", line 302, in main_loop
    run_ml_inference(model)
  File "/Users/igorbulgakov/Documents/vib_bot/train_model_online_enhanced.py", line 272, in run_ml_inference
    merged_result = merge_data(df_extras, df_trades, df_orderbook)
  File "/Users/igorbulgakov/Documents/vib_bot/train_model_online_enhanced.py", line 179, in merge_data
    (df_trades["TradeTime"] >= latest_candle["close_time"] - timedelta(minutes=5)) &
  File "/Users/igorbulgakov/Library/Python/3.9/lib/python/site-packages/pandas/core/frame.py", line 4102, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/igorbulgakov/Library/Python/3.9/lib/python/site-packages/pandas/core/indexes/base.py", line 3812, in get_loc
    raise KeyError(key) from err
KeyError: 'TradeTime'
/Users/igorbulgakov/Library/Python/3.9/lib/python/site-packages/urllib3/__init__.py:35: NotOpenSSLWarning: urllib3 v2 only supports OpenSSL 1.1.1+, currently the 'ssl' module is compiled with 'LibreSSL 2.8.3'. See: https://github.com/urllib3/urllib3/issues/3020
  warnings.warn(
2025-03-27 08:23:10,874 [INFO] Training database initialized (merged_training_data and feedback tables ensured).
2025-03-27 08:23:10,874 [INFO] Model loaded successfully.
2025-03-27 08:23:10,881 [INFO] Loaded extras data from DB: 2000 rows.
2025-03-27 08:23:10,889 [INFO] Loaded trades data from DB: 4460 rows.
2025-03-27 08:23:10,890 [INFO] Loaded orderbook data from DB: 12 rows.
Traceback (most recent call last):
  File "/Users/igorbulgakov/Library/Python/3.9/lib/python/site-packages/pandas/core/indexes/base.py", line 3805, in get_loc
    return self._engine.get_loc(casted_key)
  File "index.pyx", line 167, in pandas._libs.index.IndexEngine.get_loc
  File "index.pyx", line 196, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 7081, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 7089, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'TradeTime'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/igorbulgakov/Documents/vib_bot/train_model_online_enhanced.py", line 306, in <module>
    main_loop()
  File "/Users/igorbulgakov/Documents/vib_bot/train_model_online_enhanced.py", line 302, in main_loop
    run_ml_inference(model)
  File "/Users/igorbulgakov/Documents/vib_bot/train_model_online_enhanced.py", line 272, in run_ml_inference
    merged_result = merge_data(df_extras, df_trades, df_orderbook)
  File "/Users/igorbulgakov/Documents/vib_bot/train_model_online_enhanced.py", line 179, in merge_data
    (df_trades["TradeTime"] >= latest_candle["close_time"] - timedelta(minutes=5)) &
  File "/Users/igorbulgakov/Library/Python/3.9/lib/python/site-packages/pandas/core/frame.py", line 4102, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/igorbulgakov/Library/Python/3.9/lib/python/site-packages/pandas/core/indexes/base.py", line 3812, in get_loc
    raise KeyError(key) from err
KeyError: 'TradeTime'
/Users/igorbulgakov/Library/Python/3.9/lib/python/site-packages/urllib3/__init__.py:35: NotOpenSSLWarning: urllib3 v2 only supports OpenSSL 1.1.1+, currently the 'ssl' module is compiled with 'LibreSSL 2.8.3'. See: https://github.com/urllib3/urllib3/issues/3020
  warnings.warn(
2025-03-27 08:23:40,885 [INFO] Training database initialized (merged_training_data and feedback tables ensured).
2025-03-27 08:23:40,885 [INFO] Model loaded successfully.
2025-03-27 08:23:40,892 [INFO] Loaded extras data from DB: 2000 rows.
2025-03-27 08:23:40,900 [INFO] Loaded trades data from DB: 4474 rows.
2025-03-27 08:23:40,901 [INFO] Loaded orderbook data from DB: 12 rows.
Traceback (most recent call last):
  File "/Users/igorbulgakov/Library/Python/3.9/lib/python/site-packages/pandas/core/indexes/base.py", line 3805, in get_loc
    return self._engine.get_loc(casted_key)
  File "index.pyx", line 167, in pandas._libs.index.IndexEngine.get_loc
  File "index.pyx", line 196, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 7081, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 7089, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'TradeTime'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/igorbulgakov/Documents/vib_bot/train_model_online_enhanced.py", line 306, in <module>
    main_loop()
  File "/Users/igorbulgakov/Documents/vib_bot/train_model_online_enhanced.py", line 302, in main_loop
    run_ml_inference(model)
  File "/Users/igorbulgakov/Documents/vib_bot/train_model_online_enhanced.py", line 272, in run_ml_inference
    merged_result = merge_data(df_extras, df_trades, df_orderbook)
  File "/Users/igorbulgakov/Documents/vib_bot/train_model_online_enhanced.py", line 179, in merge_data
    (df_trades["TradeTime"] >= latest_candle["close_time"] - timedelta(minutes=5)) &
  File "/Users/igorbulgakov/Library/Python/3.9/lib/python/site-packages/pandas/core/frame.py", line 4102, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/igorbulgakov/Library/Python/3.9/lib/python/site-packages/pandas/core/indexes/base.py", line 3812, in get_loc
    raise KeyError(key) from err
KeyError: 'TradeTime'
/Users/igorbulgakov/Library/Python/3.9/lib/python/site-packages/urllib3/__init__.py:35: NotOpenSSLWarning: urllib3 v2 only supports OpenSSL 1.1.1+, currently the 'ssl' module is compiled with 'LibreSSL 2.8.3'. See: https://github.com/urllib3/urllib3/issues/3020
  warnings.warn(
2025-03-27 08:24:10,881 [INFO] Training database initialized (merged_training_data and feedback tables ensured).
2025-03-27 08:24:10,881 [INFO] Model loaded successfully.
2025-03-27 08:24:10,888 [INFO] Loaded extras data from DB: 2000 rows.
2025-03-27 08:24:10,896 [INFO] Loaded trades data from DB: 4476 rows.
2025-03-27 08:24:10,897 [INFO] Loaded orderbook data from DB: 12 rows.
Traceback (most recent call last):
  File "/Users/igorbulgakov/Library/Python/3.9/lib/python/site-packages/pandas/core/indexes/base.py", line 3805, in get_loc
    return self._engine.get_loc(casted_key)
  File "index.pyx", line 167, in pandas._libs.index.IndexEngine.get_loc
  File "index.pyx", line 196, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 7081, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 7089, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'TradeTime'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/igorbulgakov/Documents/vib_bot/train_model_online_enhanced.py", line 306, in <module>
    main_loop()
  File "/Users/igorbulgakov/Documents/vib_bot/train_model_online_enhanced.py", line 302, in main_loop
    run_ml_inference(model)
  File "/Users/igorbulgakov/Documents/vib_bot/train_model_online_enhanced.py", line 272, in run_ml_inference
    merged_result = merge_data(df_extras, df_trades, df_orderbook)
  File "/Users/igorbulgakov/Documents/vib_bot/train_model_online_enhanced.py", line 179, in merge_data
    (df_trades["TradeTime"] >= latest_candle["close_time"] - timedelta(minutes=5)) &
  File "/Users/igorbulgakov/Library/Python/3.9/lib/python/site-packages/pandas/core/frame.py", line 4102, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/igorbulgakov/Library/Python/3.9/lib/python/site-packages/pandas/core/indexes/base.py", line 3812, in get_loc
    raise KeyError(key) from err
KeyError: 'TradeTime'
/Users/igorbulgakov/Library/Python/3.9/lib/python/site-packages/urllib3/__init__.py:35: NotOpenSSLWarning: urllib3 v2 only supports OpenSSL 1.1.1+, currently the 'ssl' module is compiled with 'LibreSSL 2.8.3'. See: https://github.com/urllib3/urllib3/issues/3020
  warnings.warn(
2025-03-27 08:24:40,869 [INFO] Training database initialized (merged_training_data and feedback tables ensured).
2025-03-27 08:24:40,869 [INFO] Model loaded successfully.
2025-03-27 08:24:40,876 [INFO] Loaded extras data from DB: 2000 rows.
2025-03-27 08:24:40,884 [INFO] Loaded trades data from DB: 4493 rows.
2025-03-27 08:24:40,885 [INFO] Loaded orderbook data from DB: 12 rows.
Traceback (most recent call last):
  File "/Users/igorbulgakov/Library/Python/3.9/lib/python/site-packages/pandas/core/indexes/base.py", line 3805, in get_loc
    return self._engine.get_loc(casted_key)
  File "index.pyx", line 167, in pandas._libs.index.IndexEngine.get_loc
  File "index.pyx", line 196, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 7081, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 7089, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'TradeTime'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/igorbulgakov/Documents/vib_bot/train_model_online_enhanced.py", line 306, in <module>
    main_loop()
  File "/Users/igorbulgakov/Documents/vib_bot/train_model_online_enhanced.py", line 302, in main_loop
    run_ml_inference(model)
  File "/Users/igorbulgakov/Documents/vib_bot/train_model_online_enhanced.py", line 272, in run_ml_inference
    merged_result = merge_data(df_extras, df_trades, df_orderbook)
  File "/Users/igorbulgakov/Documents/vib_bot/train_model_online_enhanced.py", line 179, in merge_data
    (df_trades["TradeTime"] >= latest_candle["close_time"] - timedelta(minutes=5)) &
  File "/Users/igorbulgakov/Library/Python/3.9/lib/python/site-packages/pandas/core/frame.py", line 4102, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/igorbulgakov/Library/Python/3.9/lib/python/site-packages/pandas/core/indexes/base.py", line 3812, in get_loc
    raise KeyError(key) from err
KeyError: 'TradeTime'
/Users/igorbulgakov/Library/Python/3.9/lib/python/site-packages/urllib3/__init__.py:35: NotOpenSSLWarning: urllib3 v2 only supports OpenSSL 1.1.1+, currently the 'ssl' module is compiled with 'LibreSSL 2.8.3'. See: https://github.com/urllib3/urllib3/issues/3020
  warnings.warn(
2025-03-27 08:25:10,919 [INFO] Training database initialized (merged_training_data and feedback tables ensured).
2025-03-27 08:25:10,920 [INFO] Model loaded successfully.
2025-03-27 08:25:10,927 [INFO] Loaded extras data from DB: 2000 rows.
2025-03-27 08:25:10,935 [INFO] Loaded trades data from DB: 4495 rows.
2025-03-27 08:25:10,936 [INFO] Loaded orderbook data from DB: 12 rows.
Traceback (most recent call last):
  File "/Users/igorbulgakov/Library/Python/3.9/lib/python/site-packages/pandas/core/indexes/base.py", line 3805, in get_loc
    return self._engine.get_loc(casted_key)
  File "index.pyx", line 167, in pandas._libs.index.IndexEngine.get_loc
  File "index.pyx", line 196, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 7081, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 7089, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'TradeTime'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/igorbulgakov/Documents/vib_bot/train_model_online_enhanced.py", line 306, in <module>
    main_loop()
  File "/Users/igorbulgakov/Documents/vib_bot/train_model_online_enhanced.py", line 302, in main_loop
    run_ml_inference(model)
  File "/Users/igorbulgakov/Documents/vib_bot/train_model_online_enhanced.py", line 272, in run_ml_inference
    merged_result = merge_data(df_extras, df_trades, df_orderbook)
  File "/Users/igorbulgakov/Documents/vib_bot/train_model_online_enhanced.py", line 179, in merge_data
    (df_trades["TradeTime"] >= latest_candle["close_time"] - timedelta(minutes=5)) &
  File "/Users/igorbulgakov/Library/Python/3.9/lib/python/site-packages/pandas/core/frame.py", line 4102, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/igorbulgakov/Library/Python/3.9/lib/python/site-packages/pandas/core/indexes/base.py", line 3812, in get_loc
    raise KeyError(key) from err
KeyError: 'TradeTime'
/Users/igorbulgakov/Library/Python/3.9/lib/python/site-packages/urllib3/__init__.py:35: NotOpenSSLWarning: urllib3 v2 only supports OpenSSL 1.1.1+, currently the 'ssl' module is compiled with 'LibreSSL 2.8.3'. See: https://github.com/urllib3/urllib3/issues/3020
  warnings.warn(
2025-03-27 08:25:40,915 [INFO] Training database initialized (merged_training_data and feedback tables ensured).
2025-03-27 08:25:40,916 [INFO] Model loaded successfully.
2025-03-27 08:25:40,923 [INFO] Loaded extras data from DB: 2000 rows.
2025-03-27 08:25:40,931 [INFO] Loaded trades data from DB: 4501 rows.
2025-03-27 08:25:40,932 [INFO] Loaded orderbook data from DB: 12 rows.
Traceback (most recent call last):
  File "/Users/igorbulgakov/Library/Python/3.9/lib/python/site-packages/pandas/core/indexes/base.py", line 3805, in get_loc
    return self._engine.get_loc(casted_key)
  File "index.pyx", line 167, in pandas._libs.index.IndexEngine.get_loc
  File "index.pyx", line 196, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 7081, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 7089, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'TradeTime'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/igorbulgakov/Documents/vib_bot/train_model_online_enhanced.py", line 306, in <module>
    main_loop()
  File "/Users/igorbulgakov/Documents/vib_bot/train_model_online_enhanced.py", line 302, in main_loop
    run_ml_inference(model)
  File "/Users/igorbulgakov/Documents/vib_bot/train_model_online_enhanced.py", line 272, in run_ml_inference
    merged_result = merge_data(df_extras, df_trades, df_orderbook)
  File "/Users/igorbulgakov/Documents/vib_bot/train_model_online_enhanced.py", line 179, in merge_data
    (df_trades["TradeTime"] >= latest_candle["close_time"] - timedelta(minutes=5)) &
  File "/Users/igorbulgakov/Library/Python/3.9/lib/python/site-packages/pandas/core/frame.py", line 4102, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/igorbulgakov/Library/Python/3.9/lib/python/site-packages/pandas/core/indexes/base.py", line 3812, in get_loc
    raise KeyError(key) from err
KeyError: 'TradeTime'
/Users/igorbulgakov/Library/Python/3.9/lib/python/site-packages/urllib3/__init__.py:35: NotOpenSSLWarning: urllib3 v2 only supports OpenSSL 1.1.1+, currently the 'ssl' module is compiled with 'LibreSSL 2.8.3'. See: https://github.com/urllib3/urllib3/issues/3020
  warnings.warn(
2025-03-27 08:26:10,919 [INFO] Training database initialized (merged_training_data and feedback tables ensured).
2025-03-27 08:26:10,919 [INFO] Model loaded successfully.
2025-03-27 08:26:10,926 [INFO] Loaded extras data from DB: 2000 rows.
2025-03-27 08:26:10,934 [INFO] Loaded trades data from DB: 4528 rows.
2025-03-27 08:26:10,935 [INFO] Loaded orderbook data from DB: 12 rows.
Traceback (most recent call last):
  File "/Users/igorbulgakov/Library/Python/3.9/lib/python/site-packages/pandas/core/indexes/base.py", line 3805, in get_loc
    return self._engine.get_loc(casted_key)
  File "index.pyx", line 167, in pandas._libs.index.IndexEngine.get_loc
  File "index.pyx", line 196, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 7081, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 7089, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'TradeTime'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/igorbulgakov/Documents/vib_bot/train_model_online_enhanced.py", line 306, in <module>
    main_loop()
  File "/Users/igorbulgakov/Documents/vib_bot/train_model_online_enhanced.py", line 302, in main_loop
    run_ml_inference(model)
  File "/Users/igorbulgakov/Documents/vib_bot/train_model_online_enhanced.py", line 272, in run_ml_inference
    merged_result = merge_data(df_extras, df_trades, df_orderbook)
  File "/Users/igorbulgakov/Documents/vib_bot/train_model_online_enhanced.py", line 179, in merge_data
    (df_trades["TradeTime"] >= latest_candle["close_time"] - timedelta(minutes=5)) &
  File "/Users/igorbulgakov/Library/Python/3.9/lib/python/site-packages/pandas/core/frame.py", line 4102, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/igorbulgakov/Library/Python/3.9/lib/python/site-packages/pandas/core/indexes/base.py", line 3812, in get_loc
    raise KeyError(key) from err
KeyError: 'TradeTime'
/Users/igorbulgakov/Library/Python/3.9/lib/python/site-packages/urllib3/__init__.py:35: NotOpenSSLWarning: urllib3 v2 only supports OpenSSL 1.1.1+, currently the 'ssl' module is compiled with 'LibreSSL 2.8.3'. See: https://github.com/urllib3/urllib3/issues/3020
  warnings.warn(
2025-03-27 08:26:40,968 [INFO] Training database initialized (merged_training_data and feedback tables ensured).
2025-03-27 08:26:40,968 [INFO] Model loaded successfully.
2025-03-27 08:26:40,975 [INFO] Loaded extras data from DB: 2000 rows.
2025-03-27 08:26:40,984 [INFO] Loaded trades data from DB: 4549 rows.
2025-03-27 08:26:40,984 [INFO] Loaded orderbook data from DB: 12 rows.
Traceback (most recent call last):
  File "/Users/igorbulgakov/Library/Python/3.9/lib/python/site-packages/pandas/core/indexes/base.py", line 3805, in get_loc
    return self._engine.get_loc(casted_key)
  File "index.pyx", line 167, in pandas._libs.index.IndexEngine.get_loc
  File "index.pyx", line 196, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 7081, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 7089, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'TradeTime'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/igorbulgakov/Documents/vib_bot/train_model_online_enhanced.py", line 306, in <module>
    main_loop()
  File "/Users/igorbulgakov/Documents/vib_bot/train_model_online_enhanced.py", line 302, in main_loop
    run_ml_inference(model)
  File "/Users/igorbulgakov/Documents/vib_bot/train_model_online_enhanced.py", line 272, in run_ml_inference
    merged_result = merge_data(df_extras, df_trades, df_orderbook)
  File "/Users/igorbulgakov/Documents/vib_bot/train_model_online_enhanced.py", line 179, in merge_data
    (df_trades["TradeTime"] >= latest_candle["close_time"] - timedelta(minutes=5)) &
  File "/Users/igorbulgakov/Library/Python/3.9/lib/python/site-packages/pandas/core/frame.py", line 4102, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/igorbulgakov/Library/Python/3.9/lib/python/site-packages/pandas/core/indexes/base.py", line 3812, in get_loc
    raise KeyError(key) from err
KeyError: 'TradeTime'
/Users/igorbulgakov/Library/Python/3.9/lib/python/site-packages/urllib3/__init__.py:35: NotOpenSSLWarning: urllib3 v2 only supports OpenSSL 1.1.1+, currently the 'ssl' module is compiled with 'LibreSSL 2.8.3'. See: https://github.com/urllib3/urllib3/issues/3020
  warnings.warn(
2025-03-27 08:27:10,979 [INFO] Training database initialized (merged_training_data and feedback tables ensured).
2025-03-27 08:27:10,980 [INFO] Model loaded successfully.
2025-03-27 08:27:10,987 [INFO] Loaded extras data from DB: 2000 rows.
2025-03-27 08:27:10,995 [INFO] Loaded trades data from DB: 4559 rows.
2025-03-27 08:27:10,996 [INFO] Loaded orderbook data from DB: 12 rows.
Traceback (most recent call last):
  File "/Users/igorbulgakov/Library/Python/3.9/lib/python/site-packages/pandas/core/indexes/base.py", line 3805, in get_loc
    return self._engine.get_loc(casted_key)
  File "index.pyx", line 167, in pandas._libs.index.IndexEngine.get_loc
  File "index.pyx", line 196, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 7081, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 7089, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'TradeTime'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/igorbulgakov/Documents/vib_bot/train_model_online_enhanced.py", line 306, in <module>
    main_loop()
  File "/Users/igorbulgakov/Documents/vib_bot/train_model_online_enhanced.py", line 302, in main_loop
    run_ml_inference(model)
  File "/Users/igorbulgakov/Documents/vib_bot/train_model_online_enhanced.py", line 272, in run_ml_inference
    merged_result = merge_data(df_extras, df_trades, df_orderbook)
  File "/Users/igorbulgakov/Documents/vib_bot/train_model_online_enhanced.py", line 179, in merge_data
    (df_trades["TradeTime"] >= latest_candle["close_time"] - timedelta(minutes=5)) &
  File "/Users/igorbulgakov/Library/Python/3.9/lib/python/site-packages/pandas/core/frame.py", line 4102, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/igorbulgakov/Library/Python/3.9/lib/python/site-packages/pandas/core/indexes/base.py", line 3812, in get_loc
    raise KeyError(key) from err
KeyError: 'TradeTime'
/Users/igorbulgakov/Library/Python/3.9/lib/python/site-packages/urllib3/__init__.py:35: NotOpenSSLWarning: urllib3 v2 only supports OpenSSL 1.1.1+, currently the 'ssl' module is compiled with 'LibreSSL 2.8.3'. See: https://github.com/urllib3/urllib3/issues/3020
  warnings.warn(
2025-03-27 08:27:40,971 [INFO] Training database initialized (merged_training_data and feedback tables ensured).
2025-03-27 08:27:40,971 [INFO] Model loaded successfully.
2025-03-27 08:27:40,979 [INFO] Loaded extras data from DB: 2000 rows.
2025-03-27 08:27:40,988 [INFO] Loaded trades data from DB: 4567 rows.
2025-03-27 08:27:40,989 [INFO] Loaded orderbook data from DB: 12 rows.
Traceback (most recent call last):
  File "/Users/igorbulgakov/Library/Python/3.9/lib/python/site-packages/pandas/core/indexes/base.py", line 3805, in get_loc
    return self._engine.get_loc(casted_key)
  File "index.pyx", line 167, in pandas._libs.index.IndexEngine.get_loc
  File "index.pyx", line 196, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 7081, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 7089, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'TradeTime'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/igorbulgakov/Documents/vib_bot/train_model_online_enhanced.py", line 306, in <module>
    main_loop()
  File "/Users/igorbulgakov/Documents/vib_bot/train_model_online_enhanced.py", line 302, in main_loop
    run_ml_inference(model)
  File "/Users/igorbulgakov/Documents/vib_bot/train_model_online_enhanced.py", line 272, in run_ml_inference
    merged_result = merge_data(df_extras, df_trades, df_orderbook)
  File "/Users/igorbulgakov/Documents/vib_bot/train_model_online_enhanced.py", line 179, in merge_data
    (df_trades["TradeTime"] >= latest_candle["close_time"] - timedelta(minutes=5)) &
  File "/Users/igorbulgakov/Library/Python/3.9/lib/python/site-packages/pandas/core/frame.py", line 4102, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/igorbulgakov/Library/Python/3.9/lib/python/site-packages/pandas/core/indexes/base.py", line 3812, in get_loc
    raise KeyError(key) from err
KeyError: 'TradeTime'
/Users/igorbulgakov/Library/Python/3.9/lib/python/site-packages/urllib3/__init__.py:35: NotOpenSSLWarning: urllib3 v2 only supports OpenSSL 1.1.1+, currently the 'ssl' module is compiled with 'LibreSSL 2.8.3'. See: https://github.com/urllib3/urllib3/issues/3020
  warnings.warn(
2025-03-27 08:28:11,007 [INFO] Training database initialized (merged_training_data and feedback tables ensured).
2025-03-27 08:28:11,007 [INFO] Model loaded successfully.
2025-03-27 08:28:11,015 [INFO] Loaded extras data from DB: 2000 rows.
2025-03-27 08:28:11,023 [INFO] Loaded trades data from DB: 4573 rows.
2025-03-27 08:28:11,024 [INFO] Loaded orderbook data from DB: 12 rows.
Traceback (most recent call last):
  File "/Users/igorbulgakov/Library/Python/3.9/lib/python/site-packages/pandas/core/indexes/base.py", line 3805, in get_loc
    return self._engine.get_loc(casted_key)
  File "index.pyx", line 167, in pandas._libs.index.IndexEngine.get_loc
  File "index.pyx", line 196, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 7081, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 7089, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'TradeTime'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/igorbulgakov/Documents/vib_bot/train_model_online_enhanced.py", line 306, in <module>
    main_loop()
  File "/Users/igorbulgakov/Documents/vib_bot/train_model_online_enhanced.py", line 302, in main_loop
    run_ml_inference(model)
  File "/Users/igorbulgakov/Documents/vib_bot/train_model_online_enhanced.py", line 272, in run_ml_inference
    merged_result = merge_data(df_extras, df_trades, df_orderbook)
  File "/Users/igorbulgakov/Documents/vib_bot/train_model_online_enhanced.py", line 179, in merge_data
    (df_trades["TradeTime"] >= latest_candle["close_time"] - timedelta(minutes=5)) &
  File "/Users/igorbulgakov/Library/Python/3.9/lib/python/site-packages/pandas/core/frame.py", line 4102, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/igorbulgakov/Library/Python/3.9/lib/python/site-packages/pandas/core/indexes/base.py", line 3812, in get_loc
    raise KeyError(key) from err
KeyError: 'TradeTime'
/Users/igorbulgakov/Library/Python/3.9/lib/python/site-packages/urllib3/__init__.py:35: NotOpenSSLWarning: urllib3 v2 only supports OpenSSL 1.1.1+, currently the 'ssl' module is compiled with 'LibreSSL 2.8.3'. See: https://github.com/urllib3/urllib3/issues/3020
  warnings.warn(
2025-03-27 08:28:40,969 [INFO] Training database initialized (merged_training_data and feedback tables ensured).
2025-03-27 08:28:40,969 [INFO] Model loaded successfully.
2025-03-27 08:28:40,977 [INFO] Loaded extras data from DB: 2000 rows.
2025-03-27 08:28:40,985 [INFO] Loaded trades data from DB: 4582 rows.
2025-03-27 08:28:40,986 [INFO] Loaded orderbook data from DB: 12 rows.
Traceback (most recent call last):
  File "/Users/igorbulgakov/Library/Python/3.9/lib/python/site-packages/pandas/core/indexes/base.py", line 3805, in get_loc
    return self._engine.get_loc(casted_key)
  File "index.pyx", line 167, in pandas._libs.index.IndexEngine.get_loc
  File "index.pyx", line 196, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 7081, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 7089, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'TradeTime'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/igorbulgakov/Documents/vib_bot/train_model_online_enhanced.py", line 306, in <module>
    main_loop()
  File "/Users/igorbulgakov/Documents/vib_bot/train_model_online_enhanced.py", line 302, in main_loop
    run_ml_inference(model)
  File "/Users/igorbulgakov/Documents/vib_bot/train_model_online_enhanced.py", line 272, in run_ml_inference
    merged_result = merge_data(df_extras, df_trades, df_orderbook)
  File "/Users/igorbulgakov/Documents/vib_bot/train_model_online_enhanced.py", line 179, in merge_data
    (df_trades["TradeTime"] >= latest_candle["close_time"] - timedelta(minutes=5)) &
  File "/Users/igorbulgakov/Library/Python/3.9/lib/python/site-packages/pandas/core/frame.py", line 4102, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/igorbulgakov/Library/Python/3.9/lib/python/site-packages/pandas/core/indexes/base.py", line 3812, in get_loc
    raise KeyError(key) from err
KeyError: 'TradeTime'
/Users/igorbulgakov/Library/Python/3.9/lib/python/site-packages/urllib3/__init__.py:35: NotOpenSSLWarning: urllib3 v2 only supports OpenSSL 1.1.1+, currently the 'ssl' module is compiled with 'LibreSSL 2.8.3'. See: https://github.com/urllib3/urllib3/issues/3020
  warnings.warn(
2025-03-27 08:29:10,988 [INFO] Training database initialized (merged_training_data and feedback tables ensured).
2025-03-27 08:29:10,988 [INFO] Model loaded successfully.
2025-03-27 08:29:10,995 [INFO] Loaded extras data from DB: 2000 rows.
2025-03-27 08:29:11,004 [INFO] Loaded trades data from DB: 4590 rows.
2025-03-27 08:29:11,005 [INFO] Loaded orderbook data from DB: 12 rows.
Traceback (most recent call last):
  File "/Users/igorbulgakov/Library/Python/3.9/lib/python/site-packages/pandas/core/indexes/base.py", line 3805, in get_loc
    return self._engine.get_loc(casted_key)
  File "index.pyx", line 167, in pandas._libs.index.IndexEngine.get_loc
  File "index.pyx", line 196, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 7081, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 7089, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'TradeTime'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/igorbulgakov/Documents/vib_bot/train_model_online_enhanced.py", line 306, in <module>
    main_loop()
  File "/Users/igorbulgakov/Documents/vib_bot/train_model_online_enhanced.py", line 302, in main_loop
    run_ml_inference(model)
  File "/Users/igorbulgakov/Documents/vib_bot/train_model_online_enhanced.py", line 272, in run_ml_inference
    merged_result = merge_data(df_extras, df_trades, df_orderbook)
  File "/Users/igorbulgakov/Documents/vib_bot/train_model_online_enhanced.py", line 179, in merge_data
    (df_trades["TradeTime"] >= latest_candle["close_time"] - timedelta(minutes=5)) &
  File "/Users/igorbulgakov/Library/Python/3.9/lib/python/site-packages/pandas/core/frame.py", line 4102, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/igorbulgakov/Library/Python/3.9/lib/python/site-packages/pandas/core/indexes/base.py", line 3812, in get_loc
    raise KeyError(key) from err
KeyError: 'TradeTime'
/Users/igorbulgakov/Library/Python/3.9/lib/python/site-packages/urllib3/__init__.py:35: NotOpenSSLWarning: urllib3 v2 only supports OpenSSL 1.1.1+, currently the 'ssl' module is compiled with 'LibreSSL 2.8.3'. See: https://github.com/urllib3/urllib3/issues/3020
  warnings.warn(
2025-03-27 08:29:41,000 [INFO] Training database initialized (merged_training_data and feedback tables ensured).
2025-03-27 08:29:41,000 [INFO] Model loaded successfully.
2025-03-27 08:29:41,007 [INFO] Loaded extras data from DB: 2000 rows.
2025-03-27 08:29:41,016 [INFO] Loaded trades data from DB: 4594 rows.
2025-03-27 08:29:41,016 [INFO] Loaded orderbook data from DB: 12 rows.
Traceback (most recent call last):
  File "/Users/igorbulgakov/Library/Python/3.9/lib/python/site-packages/pandas/core/indexes/base.py", line 3805, in get_loc
    return self._engine.get_loc(casted_key)
  File "index.pyx", line 167, in pandas._libs.index.IndexEngine.get_loc
  File "index.pyx", line 196, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 7081, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 7089, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'TradeTime'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/igorbulgakov/Documents/vib_bot/train_model_online_enhanced.py", line 306, in <module>
    main_loop()
  File "/Users/igorbulgakov/Documents/vib_bot/train_model_online_enhanced.py", line 302, in main_loop
    run_ml_inference(model)
  File "/Users/igorbulgakov/Documents/vib_bot/train_model_online_enhanced.py", line 272, in run_ml_inference
    merged_result = merge_data(df_extras, df_trades, df_orderbook)
  File "/Users/igorbulgakov/Documents/vib_bot/train_model_online_enhanced.py", line 179, in merge_data
    (df_trades["TradeTime"] >= latest_candle["close_time"] - timedelta(minutes=5)) &
  File "/Users/igorbulgakov/Library/Python/3.9/lib/python/site-packages/pandas/core/frame.py", line 4102, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/igorbulgakov/Library/Python/3.9/lib/python/site-packages/pandas/core/indexes/base.py", line 3812, in get_loc
    raise KeyError(key) from err
KeyError: 'TradeTime'
/Users/igorbulgakov/Library/Python/3.9/lib/python/site-packages/urllib3/__init__.py:35: NotOpenSSLWarning: urllib3 v2 only supports OpenSSL 1.1.1+, currently the 'ssl' module is compiled with 'LibreSSL 2.8.3'. See: https://github.com/urllib3/urllib3/issues/3020
  warnings.warn(
2025-03-27 08:30:11,052 [INFO] Training database initialized (merged_training_data and feedback tables ensured).
2025-03-27 08:30:11,052 [INFO] Model loaded successfully.
2025-03-27 08:30:11,060 [INFO] Loaded extras data from DB: 2000 rows.
2025-03-27 08:30:11,068 [INFO] Loaded trades data from DB: 4604 rows.
2025-03-27 08:30:11,069 [INFO] Loaded orderbook data from DB: 12 rows.
Traceback (most recent call last):
  File "/Users/igorbulgakov/Library/Python/3.9/lib/python/site-packages/pandas/core/indexes/base.py", line 3805, in get_loc
    return self._engine.get_loc(casted_key)
  File "index.pyx", line 167, in pandas._libs.index.IndexEngine.get_loc
  File "index.pyx", line 196, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 7081, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 7089, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'TradeTime'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/igorbulgakov/Documents/vib_bot/train_model_online_enhanced.py", line 306, in <module>
    main_loop()
  File "/Users/igorbulgakov/Documents/vib_bot/train_model_online_enhanced.py", line 302, in main_loop
    run_ml_inference(model)
  File "/Users/igorbulgakov/Documents/vib_bot/train_model_online_enhanced.py", line 272, in run_ml_inference
    merged_result = merge_data(df_extras, df_trades, df_orderbook)
  File "/Users/igorbulgakov/Documents/vib_bot/train_model_online_enhanced.py", line 179, in merge_data
    (df_trades["TradeTime"] >= latest_candle["close_time"] - timedelta(minutes=5)) &
  File "/Users/igorbulgakov/Library/Python/3.9/lib/python/site-packages/pandas/core/frame.py", line 4102, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/igorbulgakov/Library/Python/3.9/lib/python/site-packages/pandas/core/indexes/base.py", line 3812, in get_loc
    raise KeyError(key) from err
KeyError: 'TradeTime'
/Users/igorbulgakov/Library/Python/3.9/lib/python/site-packages/urllib3/__init__.py:35: NotOpenSSLWarning: urllib3 v2 only supports OpenSSL 1.1.1+, currently the 'ssl' module is compiled with 'LibreSSL 2.8.3'. See: https://github.com/urllib3/urllib3/issues/3020
  warnings.warn(
2025-03-27 08:30:41,004 [INFO] Training database initialized (merged_training_data and feedback tables ensured).
2025-03-27 08:30:41,005 [INFO] Model loaded successfully.
2025-03-27 08:30:41,012 [INFO] Loaded extras data from DB: 2000 rows.
2025-03-27 08:30:41,020 [INFO] Loaded trades data from DB: 4609 rows.
2025-03-27 08:30:41,021 [INFO] Loaded orderbook data from DB: 12 rows.
Traceback (most recent call last):
  File "/Users/igorbulgakov/Library/Python/3.9/lib/python/site-packages/pandas/core/indexes/base.py", line 3805, in get_loc
    return self._engine.get_loc(casted_key)
  File "index.pyx", line 167, in pandas._libs.index.IndexEngine.get_loc
  File "index.pyx", line 196, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 7081, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 7089, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'TradeTime'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/igorbulgakov/Documents/vib_bot/train_model_online_enhanced.py", line 306, in <module>
    main_loop()
  File "/Users/igorbulgakov/Documents/vib_bot/train_model_online_enhanced.py", line 302, in main_loop
    run_ml_inference(model)
  File "/Users/igorbulgakov/Documents/vib_bot/train_model_online_enhanced.py", line 272, in run_ml_inference
    merged_result = merge_data(df_extras, df_trades, df_orderbook)
  File "/Users/igorbulgakov/Documents/vib_bot/train_model_online_enhanced.py", line 179, in merge_data
    (df_trades["TradeTime"] >= latest_candle["close_time"] - timedelta(minutes=5)) &
  File "/Users/igorbulgakov/Library/Python/3.9/lib/python/site-packages/pandas/core/frame.py", line 4102, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/igorbulgakov/Library/Python/3.9/lib/python/site-packages/pandas/core/indexes/base.py", line 3812, in get_loc
    raise KeyError(key) from err
KeyError: 'TradeTime'
/Users/igorbulgakov/Library/Python/3.9/lib/python/site-packages/urllib3/__init__.py:35: NotOpenSSLWarning: urllib3 v2 only supports OpenSSL 1.1.1+, currently the 'ssl' module is compiled with 'LibreSSL 2.8.3'. See: https://github.com/urllib3/urllib3/issues/3020
  warnings.warn(
2025-03-27 08:31:11,044 [INFO] Training database initialized (merged_training_data and feedback tables ensured).
2025-03-27 08:31:11,044 [INFO] Model loaded successfully.
2025-03-27 08:31:11,051 [INFO] Loaded extras data from DB: 2000 rows.
2025-03-27 08:31:11,060 [INFO] Loaded trades data from DB: 4616 rows.
2025-03-27 08:31:11,061 [INFO] Loaded orderbook data from DB: 12 rows.
Traceback (most recent call last):
  File "/Users/igorbulgakov/Library/Python/3.9/lib/python/site-packages/pandas/core/indexes/base.py", line 3805, in get_loc
    return self._engine.get_loc(casted_key)
  File "index.pyx", line 167, in pandas._libs.index.IndexEngine.get_loc
  File "index.pyx", line 196, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 7081, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 7089, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'TradeTime'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/igorbulgakov/Documents/vib_bot/train_model_online_enhanced.py", line 306, in <module>
    main_loop()
  File "/Users/igorbulgakov/Documents/vib_bot/train_model_online_enhanced.py", line 302, in main_loop
    run_ml_inference(model)
  File "/Users/igorbulgakov/Documents/vib_bot/train_model_online_enhanced.py", line 272, in run_ml_inference
    merged_result = merge_data(df_extras, df_trades, df_orderbook)
  File "/Users/igorbulgakov/Documents/vib_bot/train_model_online_enhanced.py", line 179, in merge_data
    (df_trades["TradeTime"] >= latest_candle["close_time"] - timedelta(minutes=5)) &
  File "/Users/igorbulgakov/Library/Python/3.9/lib/python/site-packages/pandas/core/frame.py", line 4102, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/igorbulgakov/Library/Python/3.9/lib/python/site-packages/pandas/core/indexes/base.py", line 3812, in get_loc
    raise KeyError(key) from err
KeyError: 'TradeTime'
/Users/igorbulgakov/Library/Python/3.9/lib/python/site-packages/urllib3/__init__.py:35: NotOpenSSLWarning: urllib3 v2 only supports OpenSSL 1.1.1+, currently the 'ssl' module is compiled with 'LibreSSL 2.8.3'. See: https://github.com/urllib3/urllib3/issues/3020
  warnings.warn(
2025-03-27 08:31:41,048 [INFO] Training database initialized (merged_training_data and feedback tables ensured).
2025-03-27 08:31:41,049 [INFO] Model loaded successfully.
2025-03-27 08:31:41,056 [INFO] Loaded extras data from DB: 2000 rows.
2025-03-27 08:31:41,064 [INFO] Loaded trades data from DB: 4622 rows.
2025-03-27 08:31:41,065 [INFO] Loaded orderbook data from DB: 12 rows.
Traceback (most recent call last):
  File "/Users/igorbulgakov/Library/Python/3.9/lib/python/site-packages/pandas/core/indexes/base.py", line 3805, in get_loc
    return self._engine.get_loc(casted_key)
  File "index.pyx", line 167, in pandas._libs.index.IndexEngine.get_loc
  File "index.pyx", line 196, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 7081, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 7089, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'TradeTime'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/igorbulgakov/Documents/vib_bot/train_model_online_enhanced.py", line 306, in <module>
    main_loop()
  File "/Users/igorbulgakov/Documents/vib_bot/train_model_online_enhanced.py", line 302, in main_loop
    run_ml_inference(model)
  File "/Users/igorbulgakov/Documents/vib_bot/train_model_online_enhanced.py", line 272, in run_ml_inference
    merged_result = merge_data(df_extras, df_trades, df_orderbook)
  File "/Users/igorbulgakov/Documents/vib_bot/train_model_online_enhanced.py", line 179, in merge_data
    (df_trades["TradeTime"] >= latest_candle["close_time"] - timedelta(minutes=5)) &
  File "/Users/igorbulgakov/Library/Python/3.9/lib/python/site-packages/pandas/core/frame.py", line 4102, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/igorbulgakov/Library/Python/3.9/lib/python/site-packages/pandas/core/indexes/base.py", line 3812, in get_loc
    raise KeyError(key) from err
KeyError: 'TradeTime'
/Users/igorbulgakov/Library/Python/3.9/lib/python/site-packages/urllib3/__init__.py:35: NotOpenSSLWarning: urllib3 v2 only supports OpenSSL 1.1.1+, currently the 'ssl' module is compiled with 'LibreSSL 2.8.3'. See: https://github.com/urllib3/urllib3/issues/3020
  warnings.warn(
2025-03-27 08:32:11,093 [INFO] Training database initialized (merged_training_data and feedback tables ensured).
2025-03-27 08:32:11,094 [INFO] Model loaded successfully.
2025-03-27 08:32:11,101 [INFO] Loaded extras data from DB: 2000 rows.
2025-03-27 08:32:11,109 [INFO] Loaded trades data from DB: 4633 rows.
2025-03-27 08:32:11,110 [INFO] Loaded orderbook data from DB: 12 rows.
Traceback (most recent call last):
  File "/Users/igorbulgakov/Library/Python/3.9/lib/python/site-packages/pandas/core/indexes/base.py", line 3805, in get_loc
    return self._engine.get_loc(casted_key)
  File "index.pyx", line 167, in pandas._libs.index.IndexEngine.get_loc
  File "index.pyx", line 196, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 7081, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 7089, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'TradeTime'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/igorbulgakov/Documents/vib_bot/train_model_online_enhanced.py", line 306, in <module>
    main_loop()
  File "/Users/igorbulgakov/Documents/vib_bot/train_model_online_enhanced.py", line 302, in main_loop
    run_ml_inference(model)
  File "/Users/igorbulgakov/Documents/vib_bot/train_model_online_enhanced.py", line 272, in run_ml_inference
    merged_result = merge_data(df_extras, df_trades, df_orderbook)
  File "/Users/igorbulgakov/Documents/vib_bot/train_model_online_enhanced.py", line 179, in merge_data
    (df_trades["TradeTime"] >= latest_candle["close_time"] - timedelta(minutes=5)) &
  File "/Users/igorbulgakov/Library/Python/3.9/lib/python/site-packages/pandas/core/frame.py", line 4102, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/igorbulgakov/Library/Python/3.9/lib/python/site-packages/pandas/core/indexes/base.py", line 3812, in get_loc
    raise KeyError(key) from err
KeyError: 'TradeTime'
/Users/igorbulgakov/Library/Python/3.9/lib/python/site-packages/urllib3/__init__.py:35: NotOpenSSLWarning: urllib3 v2 only supports OpenSSL 1.1.1+, currently the 'ssl' module is compiled with 'LibreSSL 2.8.3'. See: https://github.com/urllib3/urllib3/issues/3020
  warnings.warn(
2025-03-27 08:32:41,079 [INFO] Training database initialized (merged_training_data and feedback tables ensured).
2025-03-27 08:32:41,079 [INFO] Model loaded successfully.
2025-03-27 08:32:41,087 [INFO] Loaded extras data from DB: 2000 rows.
2025-03-27 08:32:41,096 [INFO] Loaded trades data from DB: 4633 rows.
2025-03-27 08:32:41,097 [INFO] Loaded orderbook data from DB: 12 rows.
Traceback (most recent call last):
  File "/Users/igorbulgakov/Library/Python/3.9/lib/python/site-packages/pandas/core/indexes/base.py", line 3805, in get_loc
    return self._engine.get_loc(casted_key)
  File "index.pyx", line 167, in pandas._libs.index.IndexEngine.get_loc
  File "index.pyx", line 196, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 7081, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 7089, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'TradeTime'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/igorbulgakov/Documents/vib_bot/train_model_online_enhanced.py", line 306, in <module>
    main_loop()
  File "/Users/igorbulgakov/Documents/vib_bot/train_model_online_enhanced.py", line 302, in main_loop
    run_ml_inference(model)
  File "/Users/igorbulgakov/Documents/vib_bot/train_model_online_enhanced.py", line 272, in run_ml_inference
    merged_result = merge_data(df_extras, df_trades, df_orderbook)
  File "/Users/igorbulgakov/Documents/vib_bot/train_model_online_enhanced.py", line 179, in merge_data
    (df_trades["TradeTime"] >= latest_candle["close_time"] - timedelta(minutes=5)) &
  File "/Users/igorbulgakov/Library/Python/3.9/lib/python/site-packages/pandas/core/frame.py", line 4102, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/igorbulgakov/Library/Python/3.9/lib/python/site-packages/pandas/core/indexes/base.py", line 3812, in get_loc
    raise KeyError(key) from err
KeyError: 'TradeTime'
/Users/igorbulgakov/Library/Python/3.9/lib/python/site-packages/urllib3/__init__.py:35: NotOpenSSLWarning: urllib3 v2 only supports OpenSSL 1.1.1+, currently the 'ssl' module is compiled with 'LibreSSL 2.8.3'. See: https://github.com/urllib3/urllib3/issues/3020
  warnings.warn(
2025-03-27 08:33:11,126 [INFO] Training database initialized (merged_training_data and feedback tables ensured).
2025-03-27 08:33:11,127 [INFO] Model loaded successfully.
Traceback (most recent call last):
  File "/Users/igorbulgakov/Documents/vib_bot/train_model_online_enhanced.py", line 294, in <module>
    main_loop()
  File "/Users/igorbulgakov/Documents/vib_bot/train_model_online_enhanced.py", line 288, in main_loop
    update_model_from_db_feedback(model)
  File "/Users/igorbulgakov/Documents/vib_bot/train_model_online_enhanced.py", line 225, in update_model_from_db_feedback
    conn = sqlite3.connect(MASTER_DB_FILE)
NameError: name 'MASTER_DB_FILE' is not defined
/Users/igorbulgakov/Library/Python/3.9/lib/python/site-packages/urllib3/__init__.py:35: NotOpenSSLWarning: urllib3 v2 only supports OpenSSL 1.1.1+, currently the 'ssl' module is compiled with 'LibreSSL 2.8.3'. See: https://github.com/urllib3/urllib3/issues/3020
  warnings.warn(
2025-03-27 08:33:41,154 [INFO] Training database initialized (merged_training_data and feedback tables ensured).
2025-03-27 08:33:41,154 [INFO] Model loaded successfully.
Traceback (most recent call last):
  File "/Users/igorbulgakov/Documents/vib_bot/train_model_online_enhanced.py", line 294, in <module>
    main_loop()
  File "/Users/igorbulgakov/Documents/vib_bot/train_model_online_enhanced.py", line 288, in main_loop
    update_model_from_db_feedback(model)
  File "/Users/igorbulgakov/Documents/vib_bot/train_model_online_enhanced.py", line 225, in update_model_from_db_feedback
    conn = sqlite3.connect(MASTER_DB_FILE)
NameError: name 'MASTER_DB_FILE' is not defined
/Users/igorbulgakov/Library/Python/3.9/lib/python/site-packages/urllib3/__init__.py:35: NotOpenSSLWarning: urllib3 v2 only supports OpenSSL 1.1.1+, currently the 'ssl' module is compiled with 'LibreSSL 2.8.3'. See: https://github.com/urllib3/urllib3/issues/3020
  warnings.warn(
2025-03-27 08:34:11,127 [INFO] Training database initialized (merged_training_data and feedback tables ensured).
2025-03-27 08:34:11,127 [INFO] Model loaded successfully.
Traceback (most recent call last):
  File "/Users/igorbulgakov/Documents/vib_bot/train_model_online_enhanced.py", line 294, in <module>
    main_loop()
  File "/Users/igorbulgakov/Documents/vib_bot/train_model_online_enhanced.py", line 288, in main_loop
    update_model_from_db_feedback(model)
  File "/Users/igorbulgakov/Documents/vib_bot/train_model_online_enhanced.py", line 225, in update_model_from_db_feedback
    conn = sqlite3.connect(MASTER_DB_FILE)
NameError: name 'MASTER_DB_FILE' is not defined
/Users/igorbulgakov/Library/Python/3.9/lib/python/site-packages/urllib3/__init__.py:35: NotOpenSSLWarning: urllib3 v2 only supports OpenSSL 1.1.1+, currently the 'ssl' module is compiled with 'LibreSSL 2.8.3'. See: https://github.com/urllib3/urllib3/issues/3020
  warnings.warn(
2025-03-27 08:34:41,130 [INFO] Training database initialized (merged_training_data and feedback tables ensured).
2025-03-27 08:34:41,130 [INFO] Model loaded successfully.
Traceback (most recent call last):
  File "/Users/igorbulgakov/Documents/vib_bot/train_model_online_enhanced.py", line 294, in <module>
    main_loop()
  File "/Users/igorbulgakov/Documents/vib_bot/train_model_online_enhanced.py", line 288, in main_loop
    update_model_from_db_feedback(model)
  File "/Users/igorbulgakov/Documents/vib_bot/train_model_online_enhanced.py", line 225, in update_model_from_db_feedback
    conn = sqlite3.connect(MASTER_DB_FILE)
NameError: name 'MASTER_DB_FILE' is not defined
/Users/igorbulgakov/Library/Python/3.9/lib/python/site-packages/urllib3/__init__.py:35: NotOpenSSLWarning: urllib3 v2 only supports OpenSSL 1.1.1+, currently the 'ssl' module is compiled with 'LibreSSL 2.8.3'. See: https://github.com/urllib3/urllib3/issues/3020
  warnings.warn(
2025-03-27 08:35:11,177 [INFO] Training database initialized (merged_training_data and feedback tables ensured).
2025-03-27 08:35:11,178 [INFO] Model loaded successfully.
Traceback (most recent call last):
  File "/Users/igorbulgakov/Documents/vib_bot/train_model_online_enhanced.py", line 294, in <module>
    main_loop()
  File "/Users/igorbulgakov/Documents/vib_bot/train_model_online_enhanced.py", line 288, in main_loop
    update_model_from_db_feedback(model)
  File "/Users/igorbulgakov/Documents/vib_bot/train_model_online_enhanced.py", line 225, in update_model_from_db_feedback
    conn = sqlite3.connect(MASTER_DB_FILE)
NameError: name 'MASTER_DB_FILE' is not defined
/Users/igorbulgakov/Library/Python/3.9/lib/python/site-packages/urllib3/__init__.py:35: NotOpenSSLWarning: urllib3 v2 only supports OpenSSL 1.1.1+, currently the 'ssl' module is compiled with 'LibreSSL 2.8.3'. See: https://github.com/urllib3/urllib3/issues/3020
  warnings.warn(
2025-03-27 08:35:41,269 [INFO] Training database initialized (merged_training_data and feedback tables ensured).
2025-03-27 08:35:41,269 [INFO] Model loaded successfully.
Traceback (most recent call last):
  File "/Users/igorbulgakov/Documents/vib_bot/train_model_online_enhanced.py", line 294, in <module>
    main_loop()
  File "/Users/igorbulgakov/Documents/vib_bot/train_model_online_enhanced.py", line 288, in main_loop
    update_model_from_db_feedback(model)
  File "/Users/igorbulgakov/Documents/vib_bot/train_model_online_enhanced.py", line 225, in update_model_from_db_feedback
    conn = sqlite3.connect(MASTER_DB_FILE)
NameError: name 'MASTER_DB_FILE' is not defined
/Users/igorbulgakov/Library/Python/3.9/lib/python/site-packages/urllib3/__init__.py:35: NotOpenSSLWarning: urllib3 v2 only supports OpenSSL 1.1.1+, currently the 'ssl' module is compiled with 'LibreSSL 2.8.3'. See: https://github.com/urllib3/urllib3/issues/3020
  warnings.warn(
2025-03-27 08:36:11,132 [INFO] Training database initialized (merged_training_data and feedback tables ensured).
2025-03-27 08:36:11,132 [INFO] Model loaded successfully.
Traceback (most recent call last):
  File "/Users/igorbulgakov/Documents/vib_bot/train_model_online_enhanced.py", line 294, in <module>
    main_loop()
  File "/Users/igorbulgakov/Documents/vib_bot/train_model_online_enhanced.py", line 288, in main_loop
    update_model_from_db_feedback(model)
  File "/Users/igorbulgakov/Documents/vib_bot/train_model_online_enhanced.py", line 225, in update_model_from_db_feedback
    conn = sqlite3.connect(MASTER_DB_FILE)
NameError: name 'MASTER_DB_FILE' is not defined
/Users/igorbulgakov/Library/Python/3.9/lib/python/site-packages/urllib3/__init__.py:35: NotOpenSSLWarning: urllib3 v2 only supports OpenSSL 1.1.1+, currently the 'ssl' module is compiled with 'LibreSSL 2.8.3'. See: https://github.com/urllib3/urllib3/issues/3020
  warnings.warn(
2025-03-27 08:36:41,164 [INFO] Training database initialized (merged_training_data and feedback tables ensured).
2025-03-27 08:36:41,165 [INFO] Model loaded successfully.
Traceback (most recent call last):
  File "/Users/igorbulgakov/Documents/vib_bot/train_model_online_enhanced.py", line 294, in <module>
    main_loop()
  File "/Users/igorbulgakov/Documents/vib_bot/train_model_online_enhanced.py", line 288, in main_loop
    update_model_from_db_feedback(model)
  File "/Users/igorbulgakov/Documents/vib_bot/train_model_online_enhanced.py", line 225, in update_model_from_db_feedback
    conn = sqlite3.connect(MASTER_DB_FILE)
NameError: name 'MASTER_DB_FILE' is not defined
/Users/igorbulgakov/Library/Python/3.9/lib/python/site-packages/urllib3/__init__.py:35: NotOpenSSLWarning: urllib3 v2 only supports OpenSSL 1.1.1+, currently the 'ssl' module is compiled with 'LibreSSL 2.8.3'. See: https://github.com/urllib3/urllib3/issues/3020
  warnings.warn(
2025-03-27 08:37:11,233 [INFO] Training database initialized (merged_training_data and feedback tables ensured).
2025-03-27 08:37:11,234 [INFO] Model loaded successfully.
Traceback (most recent call last):
  File "/Users/igorbulgakov/Documents/vib_bot/train_model_online_enhanced.py", line 294, in <module>
    main_loop()
  File "/Users/igorbulgakov/Documents/vib_bot/train_model_online_enhanced.py", line 288, in main_loop
    update_model_from_db_feedback(model)
  File "/Users/igorbulgakov/Documents/vib_bot/train_model_online_enhanced.py", line 225, in update_model_from_db_feedback
    conn = sqlite3.connect(MASTER_DB_FILE)
NameError: name 'MASTER_DB_FILE' is not defined
/Users/igorbulgakov/Library/Python/3.9/lib/python/site-packages/urllib3/__init__.py:35: NotOpenSSLWarning: urllib3 v2 only supports OpenSSL 1.1.1+, currently the 'ssl' module is compiled with 'LibreSSL 2.8.3'. See: https://github.com/urllib3/urllib3/issues/3020
  warnings.warn(
2025-03-27 08:37:41,166 [INFO] Training database initialized (merged_training_data and feedback tables ensured).
2025-03-27 08:37:41,166 [INFO] Model loaded successfully.
Traceback (most recent call last):
  File "/Users/igorbulgakov/Documents/vib_bot/train_model_online_enhanced.py", line 294, in <module>
    main_loop()
  File "/Users/igorbulgakov/Documents/vib_bot/train_model_online_enhanced.py", line 288, in main_loop
    update_model_from_db_feedback(model)
  File "/Users/igorbulgakov/Documents/vib_bot/train_model_online_enhanced.py", line 225, in update_model_from_db_feedback
    conn = sqlite3.connect(MASTER_DB_FILE)
NameError: name 'MASTER_DB_FILE' is not defined
/Users/igorbulgakov/Library/Python/3.9/lib/python/site-packages/urllib3/__init__.py:35: NotOpenSSLWarning: urllib3 v2 only supports OpenSSL 1.1.1+, currently the 'ssl' module is compiled with 'LibreSSL 2.8.3'. See: https://github.com/urllib3/urllib3/issues/3020
  warnings.warn(
2025-03-27 08:38:11,199 [INFO] Training database initialized (merged_training_data and feedback tables ensured).
2025-03-27 08:38:11,200 [INFO] Model loaded successfully.
Traceback (most recent call last):
  File "/Users/igorbulgakov/Documents/vib_bot/train_model_online_enhanced.py", line 294, in <module>
    main_loop()
  File "/Users/igorbulgakov/Documents/vib_bot/train_model_online_enhanced.py", line 288, in main_loop
    update_model_from_db_feedback(model)
  File "/Users/igorbulgakov/Documents/vib_bot/train_model_online_enhanced.py", line 225, in update_model_from_db_feedback
    conn = sqlite3.connect(MASTER_DB_FILE)
NameError: name 'MASTER_DB_FILE' is not defined
/Users/igorbulgakov/Library/Python/3.9/lib/python/site-packages/urllib3/__init__.py:35: NotOpenSSLWarning: urllib3 v2 only supports OpenSSL 1.1.1+, currently the 'ssl' module is compiled with 'LibreSSL 2.8.3'. See: https://github.com/urllib3/urllib3/issues/3020
  warnings.warn(
2025-03-27 08:38:41,237 [INFO] Training database initialized (merged_training_data and feedback tables ensured).
2025-03-27 08:38:41,237 [INFO] Model loaded successfully.
Traceback (most recent call last):
  File "/Users/igorbulgakov/Documents/vib_bot/train_model_online_enhanced.py", line 294, in <module>
    main_loop()
  File "/Users/igorbulgakov/Documents/vib_bot/train_model_online_enhanced.py", line 288, in main_loop
    update_model_from_db_feedback(model)
  File "/Users/igorbulgakov/Documents/vib_bot/train_model_online_enhanced.py", line 225, in update_model_from_db_feedback
    conn = sqlite3.connect(MASTER_DB_FILE)
NameError: name 'MASTER_DB_FILE' is not defined
/Users/igorbulgakov/Library/Python/3.9/lib/python/site-packages/urllib3/__init__.py:35: NotOpenSSLWarning: urllib3 v2 only supports OpenSSL 1.1.1+, currently the 'ssl' module is compiled with 'LibreSSL 2.8.3'. See: https://github.com/urllib3/urllib3/issues/3020
  warnings.warn(
2025-03-27 08:39:11,210 [INFO] Training database initialized (merged_training_data and feedback tables ensured).
2025-03-27 08:39:11,210 [INFO] Model loaded successfully.
Traceback (most recent call last):
  File "/Users/igorbulgakov/Documents/vib_bot/train_model_online_enhanced.py", line 294, in <module>
    main_loop()
  File "/Users/igorbulgakov/Documents/vib_bot/train_model_online_enhanced.py", line 288, in main_loop
    update_model_from_db_feedback(model)
  File "/Users/igorbulgakov/Documents/vib_bot/train_model_online_enhanced.py", line 225, in update_model_from_db_feedback
    conn = sqlite3.connect(MASTER_DB_FILE)
NameError: name 'MASTER_DB_FILE' is not defined
/Users/igorbulgakov/Library/Python/3.9/lib/python/site-packages/urllib3/__init__.py:35: NotOpenSSLWarning: urllib3 v2 only supports OpenSSL 1.1.1+, currently the 'ssl' module is compiled with 'LibreSSL 2.8.3'. See: https://github.com/urllib3/urllib3/issues/3020
  warnings.warn(
2025-03-27 08:39:41,194 [INFO] Training database initialized (merged_training_data and feedback tables ensured).
2025-03-27 08:39:41,194 [INFO] Model loaded successfully.
Traceback (most recent call last):
  File "/Users/igorbulgakov/Documents/vib_bot/train_model_online_enhanced.py", line 294, in <module>
    main_loop()
  File "/Users/igorbulgakov/Documents/vib_bot/train_model_online_enhanced.py", line 288, in main_loop
    update_model_from_db_feedback(model)
  File "/Users/igorbulgakov/Documents/vib_bot/train_model_online_enhanced.py", line 225, in update_model_from_db_feedback
    conn = sqlite3.connect(MASTER_DB_FILE)
NameError: name 'MASTER_DB_FILE' is not defined
/Users/igorbulgakov/Library/Python/3.9/lib/python/site-packages/urllib3/__init__.py:35: NotOpenSSLWarning: urllib3 v2 only supports OpenSSL 1.1.1+, currently the 'ssl' module is compiled with 'LibreSSL 2.8.3'. See: https://github.com/urllib3/urllib3/issues/3020
  warnings.warn(
2025-03-27 08:40:11,306 [INFO] Training database initialized (merged_training_data and feedback tables ensured).
2025-03-27 08:40:11,307 [INFO] Model loaded successfully.
Traceback (most recent call last):
  File "/Users/igorbulgakov/Documents/vib_bot/train_model_online_enhanced.py", line 294, in <module>
    main_loop()
  File "/Users/igorbulgakov/Documents/vib_bot/train_model_online_enhanced.py", line 288, in main_loop
    update_model_from_db_feedback(model)
  File "/Users/igorbulgakov/Documents/vib_bot/train_model_online_enhanced.py", line 225, in update_model_from_db_feedback
    conn = sqlite3.connect(MASTER_DB_FILE)
NameError: name 'MASTER_DB_FILE' is not defined
/Users/igorbulgakov/Library/Python/3.9/lib/python/site-packages/urllib3/__init__.py:35: NotOpenSSLWarning: urllib3 v2 only supports OpenSSL 1.1.1+, currently the 'ssl' module is compiled with 'LibreSSL 2.8.3'. See: https://github.com/urllib3/urllib3/issues/3020
  warnings.warn(
2025-03-27 08:40:41,234 [INFO] Training database initialized (merged_training_data and feedback tables ensured).
2025-03-27 08:40:41,234 [INFO] Model loaded successfully.
Traceback (most recent call last):
  File "/Users/igorbulgakov/Documents/vib_bot/train_model_online_enhanced.py", line 294, in <module>
    main_loop()
  File "/Users/igorbulgakov/Documents/vib_bot/train_model_online_enhanced.py", line 288, in main_loop
    update_model_from_db_feedback(model)
  File "/Users/igorbulgakov/Documents/vib_bot/train_model_online_enhanced.py", line 225, in update_model_from_db_feedback
    conn = sqlite3.connect(MASTER_DB_FILE)
NameError: name 'MASTER_DB_FILE' is not defined
/Users/igorbulgakov/Library/Python/3.9/lib/python/site-packages/urllib3/__init__.py:35: NotOpenSSLWarning: urllib3 v2 only supports OpenSSL 1.1.1+, currently the 'ssl' module is compiled with 'LibreSSL 2.8.3'. See: https://github.com/urllib3/urllib3/issues/3020
  warnings.warn(
2025-03-27 08:41:11,236 [INFO] Training database initialized (merged_training_data and feedback tables ensured).
2025-03-27 08:41:11,236 [INFO] Model loaded successfully.
Traceback (most recent call last):
  File "/Users/igorbulgakov/Documents/vib_bot/train_model_online_enhanced.py", line 294, in <module>
    main_loop()
  File "/Users/igorbulgakov/Documents/vib_bot/train_model_online_enhanced.py", line 288, in main_loop
    update_model_from_db_feedback(model)
  File "/Users/igorbulgakov/Documents/vib_bot/train_model_online_enhanced.py", line 225, in update_model_from_db_feedback
    conn = sqlite3.connect(MASTER_DB_FILE)
NameError: name 'MASTER_DB_FILE' is not defined
/Users/igorbulgakov/Library/Python/3.9/lib/python/site-packages/urllib3/__init__.py:35: NotOpenSSLWarning: urllib3 v2 only supports OpenSSL 1.1.1+, currently the 'ssl' module is compiled with 'LibreSSL 2.8.3'. See: https://github.com/urllib3/urllib3/issues/3020
  warnings.warn(
2025-03-27 08:41:41,298 [INFO] Training database initialized (merged_training_data and feedback tables ensured).
2025-03-27 08:41:41,299 [INFO] Model loaded successfully.
Traceback (most recent call last):
  File "/Users/igorbulgakov/Documents/vib_bot/train_model_online_enhanced.py", line 294, in <module>
    main_loop()
  File "/Users/igorbulgakov/Documents/vib_bot/train_model_online_enhanced.py", line 288, in main_loop
    update_model_from_db_feedback(model)
  File "/Users/igorbulgakov/Documents/vib_bot/train_model_online_enhanced.py", line 225, in update_model_from_db_feedback
    conn = sqlite3.connect(MASTER_DB_FILE)
NameError: name 'MASTER_DB_FILE' is not defined
/Users/igorbulgakov/Library/Python/3.9/lib/python/site-packages/urllib3/__init__.py:35: NotOpenSSLWarning: urllib3 v2 only supports OpenSSL 1.1.1+, currently the 'ssl' module is compiled with 'LibreSSL 2.8.3'. See: https://github.com/urllib3/urllib3/issues/3020
  warnings.warn(
2025-03-27 08:42:11,313 [INFO] Training database initialized (merged_training_data and feedback tables ensured).
2025-03-27 08:42:11,313 [INFO] Model loaded successfully.
Traceback (most recent call last):
  File "/Users/igorbulgakov/Documents/vib_bot/train_model_online_enhanced.py", line 294, in <module>
    main_loop()
  File "/Users/igorbulgakov/Documents/vib_bot/train_model_online_enhanced.py", line 288, in main_loop
    update_model_from_db_feedback(model)
  File "/Users/igorbulgakov/Documents/vib_bot/train_model_online_enhanced.py", line 225, in update_model_from_db_feedback
    conn = sqlite3.connect(MASTER_DB_FILE)
NameError: name 'MASTER_DB_FILE' is not defined
/Users/igorbulgakov/Library/Python/3.9/lib/python/site-packages/urllib3/__init__.py:35: NotOpenSSLWarning: urllib3 v2 only supports OpenSSL 1.1.1+, currently the 'ssl' module is compiled with 'LibreSSL 2.8.3'. See: https://github.com/urllib3/urllib3/issues/3020
  warnings.warn(
2025-03-27 08:42:41,319 [INFO] Training database initialized (merged_training_data and feedback tables ensured).
2025-03-27 08:42:41,319 [INFO] Model loaded successfully.
Traceback (most recent call last):
  File "/Users/igorbulgakov/Documents/vib_bot/train_model_online_enhanced.py", line 294, in <module>
    main_loop()
  File "/Users/igorbulgakov/Documents/vib_bot/train_model_online_enhanced.py", line 288, in main_loop
    update_model_from_db_feedback(model)
  File "/Users/igorbulgakov/Documents/vib_bot/train_model_online_enhanced.py", line 225, in update_model_from_db_feedback
    conn = sqlite3.connect(MASTER_DB_FILE)
NameError: name 'MASTER_DB_FILE' is not defined
/Users/igorbulgakov/Library/Python/3.9/lib/python/site-packages/urllib3/__init__.py:35: NotOpenSSLWarning: urllib3 v2 only supports OpenSSL 1.1.1+, currently the 'ssl' module is compiled with 'LibreSSL 2.8.3'. See: https://github.com/urllib3/urllib3/issues/3020
  warnings.warn(
2025-03-27 08:43:11,264 [INFO] Training database initialized (merged_training_data and feedback tables ensured).
2025-03-27 08:43:11,264 [INFO] Model loaded successfully.
Traceback (most recent call last):
  File "/Users/igorbulgakov/Documents/vib_bot/train_model_online_enhanced.py", line 294, in <module>
    main_loop()
  File "/Users/igorbulgakov/Documents/vib_bot/train_model_online_enhanced.py", line 288, in main_loop
    update_model_from_db_feedback(model)
  File "/Users/igorbulgakov/Documents/vib_bot/train_model_online_enhanced.py", line 225, in update_model_from_db_feedback
    conn = sqlite3.connect(MASTER_DB_FILE)
NameError: name 'MASTER_DB_FILE' is not defined
/Users/igorbulgakov/Library/Python/3.9/lib/python/site-packages/urllib3/__init__.py:35: NotOpenSSLWarning: urllib3 v2 only supports OpenSSL 1.1.1+, currently the 'ssl' module is compiled with 'LibreSSL 2.8.3'. See: https://github.com/urllib3/urllib3/issues/3020
  warnings.warn(
2025-03-27 08:43:41,331 [INFO] Training database initialized (merged_training_data and feedback tables ensured).
2025-03-27 08:43:41,332 [INFO] Model loaded successfully.
Traceback (most recent call last):
  File "/Users/igorbulgakov/Documents/vib_bot/train_model_online_enhanced.py", line 294, in <module>
    main_loop()
  File "/Users/igorbulgakov/Documents/vib_bot/train_model_online_enhanced.py", line 288, in main_loop
    update_model_from_db_feedback(model)
  File "/Users/igorbulgakov/Documents/vib_bot/train_model_online_enhanced.py", line 225, in update_model_from_db_feedback
    conn = sqlite3.connect(MASTER_DB_FILE)
NameError: name 'MASTER_DB_FILE' is not defined
/Users/igorbulgakov/Library/Python/3.9/lib/python/site-packages/urllib3/__init__.py:35: NotOpenSSLWarning: urllib3 v2 only supports OpenSSL 1.1.1+, currently the 'ssl' module is compiled with 'LibreSSL 2.8.3'. See: https://github.com/urllib3/urllib3/issues/3020
  warnings.warn(
2025-03-27 08:44:11,288 [INFO] Training database initialized (merged_training_data and feedback tables ensured).
2025-03-27 08:44:11,288 [INFO] Model loaded successfully.
Traceback (most recent call last):
  File "/Users/igorbulgakov/Documents/vib_bot/train_model_online_enhanced.py", line 294, in <module>
    main_loop()
  File "/Users/igorbulgakov/Documents/vib_bot/train_model_online_enhanced.py", line 288, in main_loop
    update_model_from_db_feedback(model)
  File "/Users/igorbulgakov/Documents/vib_bot/train_model_online_enhanced.py", line 225, in update_model_from_db_feedback
    conn = sqlite3.connect(MASTER_DB_FILE)
NameError: name 'MASTER_DB_FILE' is not defined
/Users/igorbulgakov/Library/Python/3.9/lib/python/site-packages/urllib3/__init__.py:35: NotOpenSSLWarning: urllib3 v2 only supports OpenSSL 1.1.1+, currently the 'ssl' module is compiled with 'LibreSSL 2.8.3'. See: https://github.com/urllib3/urllib3/issues/3020
  warnings.warn(
2025-03-27 08:44:41,342 [INFO] Training database initialized (merged_training_data and feedback tables ensured).
2025-03-27 08:44:41,342 [INFO] Model loaded successfully.
Traceback (most recent call last):
  File "/Users/igorbulgakov/Documents/vib_bot/train_model_online_enhanced.py", line 294, in <module>
    main_loop()
  File "/Users/igorbulgakov/Documents/vib_bot/train_model_online_enhanced.py", line 288, in main_loop
    update_model_from_db_feedback(model)
  File "/Users/igorbulgakov/Documents/vib_bot/train_model_online_enhanced.py", line 225, in update_model_from_db_feedback
    conn = sqlite3.connect(MASTER_DB_FILE)
NameError: name 'MASTER_DB_FILE' is not defined
/Users/igorbulgakov/Library/Python/3.9/lib/python/site-packages/urllib3/__init__.py:35: NotOpenSSLWarning: urllib3 v2 only supports OpenSSL 1.1.1+, currently the 'ssl' module is compiled with 'LibreSSL 2.8.3'. See: https://github.com/urllib3/urllib3/issues/3020
  warnings.warn(
2025-03-27 08:45:11,324 [INFO] Training database initialized (merged_training_data and feedback tables ensured).
2025-03-27 08:45:11,325 [INFO] Model loaded successfully.
Traceback (most recent call last):
  File "/Users/igorbulgakov/Documents/vib_bot/train_model_online_enhanced.py", line 294, in <module>
    main_loop()
  File "/Users/igorbulgakov/Documents/vib_bot/train_model_online_enhanced.py", line 288, in main_loop
    update_model_from_db_feedback(model)
  File "/Users/igorbulgakov/Documents/vib_bot/train_model_online_enhanced.py", line 225, in update_model_from_db_feedback
    conn = sqlite3.connect(MASTER_DB_FILE)
NameError: name 'MASTER_DB_FILE' is not defined
/Users/igorbulgakov/Library/Python/3.9/lib/python/site-packages/urllib3/__init__.py:35: NotOpenSSLWarning: urllib3 v2 only supports OpenSSL 1.1.1+, currently the 'ssl' module is compiled with 'LibreSSL 2.8.3'. See: https://github.com/urllib3/urllib3/issues/3020
  warnings.warn(
2025-03-27 08:45:41,318 [INFO] Training database initialized (merged_training_data and feedback tables ensured).
2025-03-27 08:45:41,318 [INFO] Model loaded successfully.
Traceback (most recent call last):
  File "/Users/igorbulgakov/Documents/vib_bot/train_model_online_enhanced.py", line 294, in <module>
    main_loop()
  File "/Users/igorbulgakov/Documents/vib_bot/train_model_online_enhanced.py", line 288, in main_loop
    update_model_from_db_feedback(model)
  File "/Users/igorbulgakov/Documents/vib_bot/train_model_online_enhanced.py", line 225, in update_model_from_db_feedback
    conn = sqlite3.connect(MASTER_DB_FILE)
NameError: name 'MASTER_DB_FILE' is not defined
/Users/igorbulgakov/Library/Python/3.9/lib/python/site-packages/urllib3/__init__.py:35: NotOpenSSLWarning: urllib3 v2 only supports OpenSSL 1.1.1+, currently the 'ssl' module is compiled with 'LibreSSL 2.8.3'. See: https://github.com/urllib3/urllib3/issues/3020
  warnings.warn(
2025-03-27 08:46:11,409 [INFO] Training database initialized (merged_training_data and feedback tables ensured).
2025-03-27 08:46:11,409 [INFO] Model loaded successfully.
Traceback (most recent call last):
  File "/Users/igorbulgakov/Documents/vib_bot/train_model_online_enhanced.py", line 294, in <module>
    main_loop()
  File "/Users/igorbulgakov/Documents/vib_bot/train_model_online_enhanced.py", line 288, in main_loop
    update_model_from_db_feedback(model)
  File "/Users/igorbulgakov/Documents/vib_bot/train_model_online_enhanced.py", line 225, in update_model_from_db_feedback
    conn = sqlite3.connect(MASTER_DB_FILE)
NameError: name 'MASTER_DB_FILE' is not defined
/Users/igorbulgakov/Library/Python/3.9/lib/python/site-packages/urllib3/__init__.py:35: NotOpenSSLWarning: urllib3 v2 only supports OpenSSL 1.1.1+, currently the 'ssl' module is compiled with 'LibreSSL 2.8.3'. See: https://github.com/urllib3/urllib3/issues/3020
  warnings.warn(
2025-03-27 08:46:41,442 [INFO] Training database initialized (merged_training_data and feedback tables ensured).
2025-03-27 08:46:41,442 [INFO] Model loaded successfully.
Traceback (most recent call last):
  File "/Users/igorbulgakov/Documents/vib_bot/train_model_online_enhanced.py", line 294, in <module>
    main_loop()
  File "/Users/igorbulgakov/Documents/vib_bot/train_model_online_enhanced.py", line 288, in main_loop
    update_model_from_db_feedback(model)
  File "/Users/igorbulgakov/Documents/vib_bot/train_model_online_enhanced.py", line 225, in update_model_from_db_feedback
    conn = sqlite3.connect(MASTER_DB_FILE)
NameError: name 'MASTER_DB_FILE' is not defined
/Users/igorbulgakov/Library/Python/3.9/lib/python/site-packages/urllib3/__init__.py:35: NotOpenSSLWarning: urllib3 v2 only supports OpenSSL 1.1.1+, currently the 'ssl' module is compiled with 'LibreSSL 2.8.3'. See: https://github.com/urllib3/urllib3/issues/3020
  warnings.warn(
2025-03-27 08:47:11,473 [INFO] Training database initialized (merged_training_data and feedback tables ensured).
2025-03-27 08:47:11,474 [INFO] Model loaded successfully.
Traceback (most recent call last):
  File "/Users/igorbulgakov/Documents/vib_bot/train_model_online_enhanced.py", line 294, in <module>
    main_loop()
  File "/Users/igorbulgakov/Documents/vib_bot/train_model_online_enhanced.py", line 288, in main_loop
    update_model_from_db_feedback(model)
  File "/Users/igorbulgakov/Documents/vib_bot/train_model_online_enhanced.py", line 225, in update_model_from_db_feedback
    conn = sqlite3.connect(MASTER_DB_FILE)
NameError: name 'MASTER_DB_FILE' is not defined
/Users/igorbulgakov/Library/Python/3.9/lib/python/site-packages/urllib3/__init__.py:35: NotOpenSSLWarning: urllib3 v2 only supports OpenSSL 1.1.1+, currently the 'ssl' module is compiled with 'LibreSSL 2.8.3'. See: https://github.com/urllib3/urllib3/issues/3020
  warnings.warn(
2025-03-27 08:47:41,431 [INFO] Training database initialized (merged_training_data and feedback tables ensured).
2025-03-27 08:47:41,431 [INFO] Model loaded successfully.
Traceback (most recent call last):
  File "/Users/igorbulgakov/Documents/vib_bot/train_model_online_enhanced.py", line 294, in <module>
    main_loop()
  File "/Users/igorbulgakov/Documents/vib_bot/train_model_online_enhanced.py", line 288, in main_loop
    update_model_from_db_feedback(model)
  File "/Users/igorbulgakov/Documents/vib_bot/train_model_online_enhanced.py", line 225, in update_model_from_db_feedback
    conn = sqlite3.connect(MASTER_DB_FILE)
NameError: name 'MASTER_DB_FILE' is not defined
/Users/igorbulgakov/Library/Python/3.9/lib/python/site-packages/urllib3/__init__.py:35: NotOpenSSLWarning: urllib3 v2 only supports OpenSSL 1.1.1+, currently the 'ssl' module is compiled with 'LibreSSL 2.8.3'. See: https://github.com/urllib3/urllib3/issues/3020
  warnings.warn(
2025-03-27 08:48:11,416 [INFO] Training database initialized (merged_training_data and feedback tables ensured).
2025-03-27 08:48:11,416 [INFO] Model loaded successfully.
Traceback (most recent call last):
  File "/Users/igorbulgakov/Documents/vib_bot/train_model_online_enhanced.py", line 294, in <module>
    main_loop()
  File "/Users/igorbulgakov/Documents/vib_bot/train_model_online_enhanced.py", line 288, in main_loop
    update_model_from_db_feedback(model)
  File "/Users/igorbulgakov/Documents/vib_bot/train_model_online_enhanced.py", line 225, in update_model_from_db_feedback
    conn = sqlite3.connect(MASTER_DB_FILE)
NameError: name 'MASTER_DB_FILE' is not defined
/Users/igorbulgakov/Library/Python/3.9/lib/python/site-packages/urllib3/__init__.py:35: NotOpenSSLWarning: urllib3 v2 only supports OpenSSL 1.1.1+, currently the 'ssl' module is compiled with 'LibreSSL 2.8.3'. See: https://github.com/urllib3/urllib3/issues/3020
  warnings.warn(
2025-03-27 08:48:41,454 [INFO] Training database initialized (merged_training_data and feedback tables ensured).
2025-03-27 08:48:41,454 [INFO] Model loaded successfully.
Traceback (most recent call last):
  File "/Users/igorbulgakov/Documents/vib_bot/train_model_online_enhanced.py", line 294, in <module>
    main_loop()
  File "/Users/igorbulgakov/Documents/vib_bot/train_model_online_enhanced.py", line 288, in main_loop
    update_model_from_db_feedback(model)
  File "/Users/igorbulgakov/Documents/vib_bot/train_model_online_enhanced.py", line 225, in update_model_from_db_feedback
    conn = sqlite3.connect(MASTER_DB_FILE)
NameError: name 'MASTER_DB_FILE' is not defined
/Users/igorbulgakov/Library/Python/3.9/lib/python/site-packages/urllib3/__init__.py:35: NotOpenSSLWarning: urllib3 v2 only supports OpenSSL 1.1.1+, currently the 'ssl' module is compiled with 'LibreSSL 2.8.3'. See: https://github.com/urllib3/urllib3/issues/3020
  warnings.warn(
2025-03-27 08:49:11,518 [INFO] Training database initialized (merged_training_data and feedback tables ensured).
2025-03-27 08:49:11,519 [INFO] Model loaded successfully.
Traceback (most recent call last):
  File "/Users/igorbulgakov/Documents/vib_bot/train_model_online_enhanced.py", line 294, in <module>
    main_loop()
  File "/Users/igorbulgakov/Documents/vib_bot/train_model_online_enhanced.py", line 288, in main_loop
    update_model_from_db_feedback(model)
  File "/Users/igorbulgakov/Documents/vib_bot/train_model_online_enhanced.py", line 225, in update_model_from_db_feedback
    conn = sqlite3.connect(MASTER_DB_FILE)
NameError: name 'MASTER_DB_FILE' is not defined
/Users/igorbulgakov/Library/Python/3.9/lib/python/site-packages/urllib3/__init__.py:35: NotOpenSSLWarning: urllib3 v2 only supports OpenSSL 1.1.1+, currently the 'ssl' module is compiled with 'LibreSSL 2.8.3'. See: https://github.com/urllib3/urllib3/issues/3020
  warnings.warn(
2025-03-27 08:49:41,486 [INFO] Training database initialized (merged_training_data and feedback tables ensured).
2025-03-27 08:49:41,486 [INFO] Model loaded successfully.
Traceback (most recent call last):
  File "/Users/igorbulgakov/Documents/vib_bot/train_model_online_enhanced.py", line 294, in <module>
    main_loop()
  File "/Users/igorbulgakov/Documents/vib_bot/train_model_online_enhanced.py", line 288, in main_loop
    update_model_from_db_feedback(model)
  File "/Users/igorbulgakov/Documents/vib_bot/train_model_online_enhanced.py", line 225, in update_model_from_db_feedback
    conn = sqlite3.connect(MASTER_DB_FILE)
NameError: name 'MASTER_DB_FILE' is not defined
/Users/igorbulgakov/Library/Python/3.9/lib/python/site-packages/urllib3/__init__.py:35: NotOpenSSLWarning: urllib3 v2 only supports OpenSSL 1.1.1+, currently the 'ssl' module is compiled with 'LibreSSL 2.8.3'. See: https://github.com/urllib3/urllib3/issues/3020
  warnings.warn(
2025-03-27 08:50:11,479 [INFO] Training database initialized (merged_training_data and feedback tables ensured).
2025-03-27 08:50:11,479 [INFO] Model loaded successfully.
Traceback (most recent call last):
  File "/Users/igorbulgakov/Documents/vib_bot/train_model_online_enhanced.py", line 294, in <module>
    main_loop()
  File "/Users/igorbulgakov/Documents/vib_bot/train_model_online_enhanced.py", line 288, in main_loop
    update_model_from_db_feedback(model)
  File "/Users/igorbulgakov/Documents/vib_bot/train_model_online_enhanced.py", line 225, in update_model_from_db_feedback
    conn = sqlite3.connect(MASTER_DB_FILE)
NameError: name 'MASTER_DB_FILE' is not defined
/Users/igorbulgakov/Library/Python/3.9/lib/python/site-packages/urllib3/__init__.py:35: NotOpenSSLWarning: urllib3 v2 only supports OpenSSL 1.1.1+, currently the 'ssl' module is compiled with 'LibreSSL 2.8.3'. See: https://github.com/urllib3/urllib3/issues/3020
  warnings.warn(
2025-03-27 08:50:41,525 [INFO] Training database initialized (merged_training_data and feedback tables ensured).
2025-03-27 08:50:41,525 [INFO] Model loaded successfully.
Traceback (most recent call last):
  File "/Users/igorbulgakov/Documents/vib_bot/train_model_online_enhanced.py", line 294, in <module>
    main_loop()
  File "/Users/igorbulgakov/Documents/vib_bot/train_model_online_enhanced.py", line 288, in main_loop
    update_model_from_db_feedback(model)
  File "/Users/igorbulgakov/Documents/vib_bot/train_model_online_enhanced.py", line 225, in update_model_from_db_feedback
    conn = sqlite3.connect(MASTER_DB_FILE)
NameError: name 'MASTER_DB_FILE' is not defined
/Users/igorbulgakov/Library/Python/3.9/lib/python/site-packages/urllib3/__init__.py:35: NotOpenSSLWarning: urllib3 v2 only supports OpenSSL 1.1.1+, currently the 'ssl' module is compiled with 'LibreSSL 2.8.3'. See: https://github.com/urllib3/urllib3/issues/3020
  warnings.warn(
2025-03-27 08:51:11,492 [INFO] Training database initialized (merged_training_data and feedback tables ensured).
2025-03-27 08:51:11,493 [INFO] Model loaded successfully.
Traceback (most recent call last):
  File "/Users/igorbulgakov/Documents/vib_bot/train_model_online_enhanced.py", line 294, in <module>
    main_loop()
  File "/Users/igorbulgakov/Documents/vib_bot/train_model_online_enhanced.py", line 288, in main_loop
    update_model_from_db_feedback(model)
  File "/Users/igorbulgakov/Documents/vib_bot/train_model_online_enhanced.py", line 225, in update_model_from_db_feedback
    conn = sqlite3.connect(MASTER_DB_FILE)
NameError: name 'MASTER_DB_FILE' is not defined
/Users/igorbulgakov/Library/Python/3.9/lib/python/site-packages/urllib3/__init__.py:35: NotOpenSSLWarning: urllib3 v2 only supports OpenSSL 1.1.1+, currently the 'ssl' module is compiled with 'LibreSSL 2.8.3'. See: https://github.com/urllib3/urllib3/issues/3020
  warnings.warn(
2025-03-27 08:51:41,551 [INFO] Training database initialized (merged_training_data and feedback tables ensured).
2025-03-27 08:51:41,551 [INFO] Model loaded successfully.
Traceback (most recent call last):
  File "/Users/igorbulgakov/Documents/vib_bot/train_model_online_enhanced.py", line 294, in <module>
    main_loop()
  File "/Users/igorbulgakov/Documents/vib_bot/train_model_online_enhanced.py", line 288, in main_loop
    update_model_from_db_feedback(model)
  File "/Users/igorbulgakov/Documents/vib_bot/train_model_online_enhanced.py", line 225, in update_model_from_db_feedback
    conn = sqlite3.connect(MASTER_DB_FILE)
NameError: name 'MASTER_DB_FILE' is not defined
/Users/igorbulgakov/Library/Python/3.9/lib/python/site-packages/urllib3/__init__.py:35: NotOpenSSLWarning: urllib3 v2 only supports OpenSSL 1.1.1+, currently the 'ssl' module is compiled with 'LibreSSL 2.8.3'. See: https://github.com/urllib3/urllib3/issues/3020
  warnings.warn(
2025-03-27 08:52:11,541 [INFO] Training database initialized (merged_training_data and feedback tables ensured).
2025-03-27 08:52:11,542 [INFO] Model loaded successfully.
Traceback (most recent call last):
  File "/Users/igorbulgakov/Documents/vib_bot/train_model_online_enhanced.py", line 294, in <module>
    main_loop()
  File "/Users/igorbulgakov/Documents/vib_bot/train_model_online_enhanced.py", line 288, in main_loop
    update_model_from_db_feedback(model)
  File "/Users/igorbulgakov/Documents/vib_bot/train_model_online_enhanced.py", line 225, in update_model_from_db_feedback
    conn = sqlite3.connect(MASTER_DB_FILE)
NameError: name 'MASTER_DB_FILE' is not defined
/Users/igorbulgakov/Library/Python/3.9/lib/python/site-packages/urllib3/__init__.py:35: NotOpenSSLWarning: urllib3 v2 only supports OpenSSL 1.1.1+, currently the 'ssl' module is compiled with 'LibreSSL 2.8.3'. See: https://github.com/urllib3/urllib3/issues/3020
  warnings.warn(
2025-03-27 08:52:41,545 [INFO] Training database initialized (merged_training_data and feedback tables ensured).
2025-03-27 08:52:41,545 [INFO] Model loaded successfully.
Traceback (most recent call last):
  File "/Users/igorbulgakov/Documents/vib_bot/train_model_online_enhanced.py", line 294, in <module>
    main_loop()
  File "/Users/igorbulgakov/Documents/vib_bot/train_model_online_enhanced.py", line 288, in main_loop
    update_model_from_db_feedback(model)
  File "/Users/igorbulgakov/Documents/vib_bot/train_model_online_enhanced.py", line 225, in update_model_from_db_feedback
    conn = sqlite3.connect(MASTER_DB_FILE)
NameError: name 'MASTER_DB_FILE' is not defined
/Users/igorbulgakov/Library/Python/3.9/lib/python/site-packages/urllib3/__init__.py:35: NotOpenSSLWarning: urllib3 v2 only supports OpenSSL 1.1.1+, currently the 'ssl' module is compiled with 'LibreSSL 2.8.3'. See: https://github.com/urllib3/urllib3/issues/3020
  warnings.warn(
2025-03-27 08:53:11,558 [INFO] Training database initialized (merged_training_data and feedback tables ensured).
2025-03-27 08:53:11,559 [INFO] Model loaded successfully.
Traceback (most recent call last):
  File "/Users/igorbulgakov/Documents/vib_bot/train_model_online_enhanced.py", line 294, in <module>
    main_loop()
  File "/Users/igorbulgakov/Documents/vib_bot/train_model_online_enhanced.py", line 288, in main_loop
    update_model_from_db_feedback(model)
  File "/Users/igorbulgakov/Documents/vib_bot/train_model_online_enhanced.py", line 225, in update_model_from_db_feedback
    conn = sqlite3.connect(MASTER_DB_FILE)
NameError: name 'MASTER_DB_FILE' is not defined
/Users/igorbulgakov/Library/Python/3.9/lib/python/site-packages/urllib3/__init__.py:35: NotOpenSSLWarning: urllib3 v2 only supports OpenSSL 1.1.1+, currently the 'ssl' module is compiled with 'LibreSSL 2.8.3'. See: https://github.com/urllib3/urllib3/issues/3020
  warnings.warn(
2025-03-27 08:53:41,608 [INFO] Training database initialized (merged_training_data and feedback tables ensured).
2025-03-27 08:53:41,609 [INFO] Model loaded successfully.
Traceback (most recent call last):
  File "/Users/igorbulgakov/Documents/vib_bot/train_model_online_enhanced.py", line 294, in <module>
    main_loop()
  File "/Users/igorbulgakov/Documents/vib_bot/train_model_online_enhanced.py", line 288, in main_loop
    update_model_from_db_feedback(model)
  File "/Users/igorbulgakov/Documents/vib_bot/train_model_online_enhanced.py", line 225, in update_model_from_db_feedback
    conn = sqlite3.connect(MASTER_DB_FILE)
NameError: name 'MASTER_DB_FILE' is not defined
/Users/igorbulgakov/Library/Python/3.9/lib/python/site-packages/urllib3/__init__.py:35: NotOpenSSLWarning: urllib3 v2 only supports OpenSSL 1.1.1+, currently the 'ssl' module is compiled with 'LibreSSL 2.8.3'. See: https://github.com/urllib3/urllib3/issues/3020
  warnings.warn(
2025-03-27 08:54:11,602 [INFO] Training database initialized (merged_training_data and feedback tables ensured).
2025-03-27 08:54:11,603 [INFO] Model loaded successfully.
Traceback (most recent call last):
  File "/Users/igorbulgakov/Documents/vib_bot/train_model_online_enhanced.py", line 294, in <module>
    main_loop()
  File "/Users/igorbulgakov/Documents/vib_bot/train_model_online_enhanced.py", line 288, in main_loop
    update_model_from_db_feedback(model)
  File "/Users/igorbulgakov/Documents/vib_bot/train_model_online_enhanced.py", line 225, in update_model_from_db_feedback
    conn = sqlite3.connect(MASTER_DB_FILE)
NameError: name 'MASTER_DB_FILE' is not defined
/Users/igorbulgakov/Library/Python/3.9/lib/python/site-packages/urllib3/__init__.py:35: NotOpenSSLWarning: urllib3 v2 only supports OpenSSL 1.1.1+, currently the 'ssl' module is compiled with 'LibreSSL 2.8.3'. See: https://github.com/urllib3/urllib3/issues/3020
  warnings.warn(
2025-03-27 08:54:41,585 [INFO] Training database initialized (merged_training_data and feedback tables ensured).
2025-03-27 08:54:41,586 [INFO] Model loaded successfully.
Traceback (most recent call last):
  File "/Users/igorbulgakov/Documents/vib_bot/train_model_online_enhanced.py", line 294, in <module>
    main_loop()
  File "/Users/igorbulgakov/Documents/vib_bot/train_model_online_enhanced.py", line 288, in main_loop
    update_model_from_db_feedback(model)
  File "/Users/igorbulgakov/Documents/vib_bot/train_model_online_enhanced.py", line 225, in update_model_from_db_feedback
    conn = sqlite3.connect(MASTER_DB_FILE)
NameError: name 'MASTER_DB_FILE' is not defined
/Users/igorbulgakov/Library/Python/3.9/lib/python/site-packages/urllib3/__init__.py:35: NotOpenSSLWarning: urllib3 v2 only supports OpenSSL 1.1.1+, currently the 'ssl' module is compiled with 'LibreSSL 2.8.3'. See: https://github.com/urllib3/urllib3/issues/3020
  warnings.warn(
2025-03-27 08:55:11,647 [INFO] Training database initialized (merged_training_data and feedback tables ensured).
2025-03-27 08:55:11,648 [INFO] Model loaded successfully.
Traceback (most recent call last):
  File "/Users/igorbulgakov/Documents/vib_bot/train_model_online_enhanced.py", line 294, in <module>
    main_loop()
  File "/Users/igorbulgakov/Documents/vib_bot/train_model_online_enhanced.py", line 288, in main_loop
    update_model_from_db_feedback(model)
  File "/Users/igorbulgakov/Documents/vib_bot/train_model_online_enhanced.py", line 225, in update_model_from_db_feedback
    conn = sqlite3.connect(MASTER_DB_FILE)
NameError: name 'MASTER_DB_FILE' is not defined
2025-03-27 08:55:41,620 [INFO] Model loaded for training update.
2025-03-27 08:55:41,628 [ERROR] Error processing pending feedback record 850: index 2 is out of bounds for axis 0 with size 1
2025-03-27 08:55:41,628 [ERROR] Error processing pending feedback record 851: index 2 is out of bounds for axis 0 with size 1
2025-03-27 08:55:41,628 [ERROR] Error processing pending feedback record 852: index 2 is out of bounds for axis 0 with size 1
2025-03-27 08:55:41,628 [ERROR] Error processing pending feedback record 853: index 2 is out of bounds for axis 0 with size 1
2025-03-27 08:55:41,628 [ERROR] Error processing pending feedback record 854: index 2 is out of bounds for axis 0 with size 1
2025-03-27 08:55:41,629 [ERROR] Error processing pending feedback record 855: index 2 is out of bounds for axis 0 with size 1
2025-03-27 08:55:41,629 [ERROR] Error processing pending feedback record 856: index 2 is out of bounds for axis 0 with size 1
2025-03-27 08:55:41,629 [ERROR] Error processing pending feedback record 857: index 2 is out of bounds for axis 0 with size 1
2025-03-27 08:55:41,629 [ERROR] Error processing pending feedback record 858: index 2 is out of bounds for axis 0 with size 1
2025-03-27 08:55:41,629 [ERROR] Error processing pending feedback record 859: index 2 is out of bounds for axis 0 with size 1
2025-03-27 08:55:41,629 [ERROR] Error processing pending feedback record 860: index 2 is out of bounds for axis 0 with size 1
2025-03-27 08:55:41,629 [ERROR] Error processing pending feedback record 861: index 2 is out of bounds for axis 0 with size 1
2025-03-27 08:55:41,629 [ERROR] Error processing pending feedback record 862: index 2 is out of bounds for axis 0 with size 1
2025-03-27 08:55:41,629 [ERROR] Error processing pending feedback record 863: index 2 is out of bounds for axis 0 with size 1
2025-03-27 08:55:41,629 [ERROR] Error processing pending feedback record 864: index 2 is out of bounds for axis 0 with size 1
2025-03-27 08:55:41,629 [ERROR] Error processing pending feedback record 865: index 2 is out of bounds for axis 0 with size 1
2025-03-27 08:55:41,629 [ERROR] Error processing pending feedback record 866: index 2 is out of bounds for axis 0 with size 1
2025-03-27 08:55:41,629 [ERROR] Error processing pending feedback record 867: index 2 is out of bounds for axis 0 with size 1
2025-03-27 08:55:41,629 [ERROR] Error processing pending feedback record 868: index 2 is out of bounds for axis 0 with size 1
2025-03-27 08:55:41,629 [ERROR] Error processing pending feedback record 869: index 2 is out of bounds for axis 0 with size 1
2025-03-27 08:55:41,629 [ERROR] Error processing pending feedback record 870: index 2 is out of bounds for axis 0 with size 1
2025-03-27 08:55:41,629 [ERROR] Error processing pending feedback record 871: index 2 is out of bounds for axis 0 with size 1
2025-03-27 08:55:41,629 [ERROR] Error processing pending feedback record 872: index 2 is out of bounds for axis 0 with size 1
2025-03-27 08:55:41,629 [ERROR] Error processing pending feedback record 873: index 2 is out of bounds for axis 0 with size 1
2025-03-27 08:55:41,629 [ERROR] Error processing pending feedback record 874: index 2 is out of bounds for axis 0 with size 1
2025-03-27 08:55:41,629 [ERROR] Error processing pending feedback record 875: index 2 is out of bounds for axis 0 with size 1
2025-03-27 08:55:41,629 [ERROR] Error processing pending feedback record 876: index 2 is out of bounds for axis 0 with size 1
2025-03-27 08:55:41,630 [ERROR] Error processing pending feedback record 877: index 2 is out of bounds for axis 0 with size 1
2025-03-27 08:55:41,630 [ERROR] Error processing pending feedback record 878: index 2 is out of bounds for axis 0 with size 1
2025-03-27 08:55:41,630 [ERROR] Error processing pending feedback record 879: index 2 is out of bounds for axis 0 with size 1
2025-03-27 08:55:41,630 [ERROR] Error processing pending feedback record 880: index 2 is out of bounds for axis 0 with size 1
2025-03-27 08:55:41,630 [ERROR] Error processing pending feedback record 881: index 2 is out of bounds for axis 0 with size 1
2025-03-27 08:55:41,630 [ERROR] Error processing pending feedback record 882: index 2 is out of bounds for axis 0 with size 1
2025-03-27 08:55:41,630 [ERROR] Error processing pending feedback record 883: index 2 is out of bounds for axis 0 with size 1
2025-03-27 08:55:41,630 [ERROR] Error processing pending feedback record 884: index 2 is out of bounds for axis 0 with size 1
2025-03-27 08:55:41,630 [ERROR] Error processing pending feedback record 885: index 2 is out of bounds for axis 0 with size 1
2025-03-27 08:55:41,630 [ERROR] Error processing pending feedback record 886: index 2 is out of bounds for axis 0 with size 1
2025-03-27 08:55:41,630 [ERROR] Error processing pending feedback record 887: index 2 is out of bounds for axis 0 with size 1
2025-03-27 08:55:41,630 [ERROR] Error processing pending feedback record 888: index 2 is out of bounds for axis 0 with size 1
2025-03-27 08:55:41,630 [INFO] No pending feedback records met the criteria for update.
2025-03-27 09:02:20,173 [INFO] Model loaded for training update.
2025-03-27 09:02:20,192 [ERROR] Error processing pending feedback record 850: index 2 is out of bounds for axis 0 with size 1
2025-03-27 09:02:20,192 [ERROR] Error processing pending feedback record 851: index 2 is out of bounds for axis 0 with size 1
2025-03-27 09:02:20,192 [ERROR] Error processing pending feedback record 852: index 2 is out of bounds for axis 0 with size 1
2025-03-27 09:02:20,192 [ERROR] Error processing pending feedback record 853: index 2 is out of bounds for axis 0 with size 1
2025-03-27 09:02:20,192 [ERROR] Error processing pending feedback record 854: index 2 is out of bounds for axis 0 with size 1
2025-03-27 09:02:20,192 [ERROR] Error processing pending feedback record 855: index 2 is out of bounds for axis 0 with size 1
2025-03-27 09:02:20,192 [ERROR] Error processing pending feedback record 856: index 2 is out of bounds for axis 0 with size 1
2025-03-27 09:02:20,192 [ERROR] Error processing pending feedback record 857: index 2 is out of bounds for axis 0 with size 1
2025-03-27 09:02:20,192 [ERROR] Error processing pending feedback record 858: index 2 is out of bounds for axis 0 with size 1
2025-03-27 09:02:20,192 [ERROR] Error processing pending feedback record 859: index 2 is out of bounds for axis 0 with size 1
2025-03-27 09:02:20,193 [ERROR] Error processing pending feedback record 860: index 2 is out of bounds for axis 0 with size 1
2025-03-27 09:02:20,193 [ERROR] Error processing pending feedback record 861: index 2 is out of bounds for axis 0 with size 1
2025-03-27 09:02:20,193 [ERROR] Error processing pending feedback record 862: index 2 is out of bounds for axis 0 with size 1
2025-03-27 09:02:20,193 [ERROR] Error processing pending feedback record 863: index 2 is out of bounds for axis 0 with size 1
2025-03-27 09:02:20,193 [ERROR] Error processing pending feedback record 864: index 2 is out of bounds for axis 0 with size 1
2025-03-27 09:02:20,193 [ERROR] Error processing pending feedback record 865: index 2 is out of bounds for axis 0 with size 1
2025-03-27 09:02:20,193 [ERROR] Error processing pending feedback record 866: index 2 is out of bounds for axis 0 with size 1
2025-03-27 09:02:20,193 [ERROR] Error processing pending feedback record 867: index 2 is out of bounds for axis 0 with size 1
2025-03-27 09:02:20,193 [ERROR] Error processing pending feedback record 868: index 2 is out of bounds for axis 0 with size 1
2025-03-27 09:02:20,193 [ERROR] Error processing pending feedback record 869: index 2 is out of bounds for axis 0 with size 1
2025-03-27 09:02:20,193 [ERROR] Error processing pending feedback record 870: index 2 is out of bounds for axis 0 with size 1
2025-03-27 09:02:20,193 [ERROR] Error processing pending feedback record 871: index 2 is out of bounds for axis 0 with size 1
2025-03-27 09:02:20,193 [ERROR] Error processing pending feedback record 872: index 2 is out of bounds for axis 0 with size 1
2025-03-27 09:02:20,193 [ERROR] Error processing pending feedback record 873: index 2 is out of bounds for axis 0 with size 1
2025-03-27 09:02:20,193 [ERROR] Error processing pending feedback record 874: index 2 is out of bounds for axis 0 with size 1
2025-03-27 09:02:20,193 [ERROR] Error processing pending feedback record 875: index 2 is out of bounds for axis 0 with size 1
2025-03-27 09:02:20,193 [ERROR] Error processing pending feedback record 876: index 2 is out of bounds for axis 0 with size 1
2025-03-27 09:02:20,193 [ERROR] Error processing pending feedback record 877: index 2 is out of bounds for axis 0 with size 1
2025-03-27 09:02:20,193 [ERROR] Error processing pending feedback record 878: index 2 is out of bounds for axis 0 with size 1
2025-03-27 09:02:20,193 [ERROR] Error processing pending feedback record 879: index 2 is out of bounds for axis 0 with size 1
2025-03-27 09:02:20,193 [ERROR] Error processing pending feedback record 880: index 2 is out of bounds for axis 0 with size 1
2025-03-27 09:02:20,194 [ERROR] Error processing pending feedback record 881: index 2 is out of bounds for axis 0 with size 1
2025-03-27 09:02:20,194 [ERROR] Error processing pending feedback record 882: index 2 is out of bounds for axis 0 with size 1
2025-03-27 09:02:20,194 [ERROR] Error processing pending feedback record 883: index 2 is out of bounds for axis 0 with size 1
2025-03-27 09:02:20,194 [ERROR] Error processing pending feedback record 884: index 2 is out of bounds for axis 0 with size 1
2025-03-27 09:02:20,194 [ERROR] Error processing pending feedback record 885: index 2 is out of bounds for axis 0 with size 1
2025-03-27 09:02:20,194 [ERROR] Error processing pending feedback record 886: index 2 is out of bounds for axis 0 with size 1
2025-03-27 09:02:20,194 [ERROR] Error processing pending feedback record 887: index 2 is out of bounds for axis 0 with size 1
2025-03-27 09:02:20,194 [ERROR] Error processing pending feedback record 888: index 2 is out of bounds for axis 0 with size 1
2025-03-27 09:02:20,194 [ERROR] Error processing pending feedback record 889: index 2 is out of bounds for axis 0 with size 1
2025-03-27 09:02:20,194 [ERROR] Error processing pending feedback record 890: index 2 is out of bounds for axis 0 with size 1
2025-03-27 09:02:20,194 [ERROR] Error processing pending feedback record 891: index 2 is out of bounds for axis 0 with size 1
2025-03-27 09:02:20,194 [ERROR] Error processing pending feedback record 892: index 2 is out of bounds for axis 0 with size 1
2025-03-27 09:02:20,194 [ERROR] Error processing pending feedback record 893: index 2 is out of bounds for axis 0 with size 1
2025-03-27 09:02:20,194 [ERROR] Error processing pending feedback record 894: index 2 is out of bounds for axis 0 with size 1
2025-03-27 09:02:20,194 [ERROR] Error processing pending feedback record 895: index 2 is out of bounds for axis 0 with size 1
2025-03-27 09:02:20,194 [ERROR] Error processing pending feedback record 896: index 2 is out of bounds for axis 0 with size 1
2025-03-27 09:02:20,194 [ERROR] Error processing pending feedback record 897: index 2 is out of bounds for axis 0 with size 1
2025-03-27 09:02:20,194 [ERROR] Error processing pending feedback record 898: index 2 is out of bounds for axis 0 with size 1
2025-03-27 09:02:20,194 [ERROR] Error processing pending feedback record 899: index 2 is out of bounds for axis 0 with size 1
2025-03-27 09:02:20,194 [INFO] No pending feedback records met the criteria for update.
2025-03-27 09:12:20,227 [INFO] Model loaded for training update.
2025-03-27 09:12:20,236 [ERROR] Error processing pending feedback record 850: index 2 is out of bounds for axis 0 with size 1
2025-03-27 09:12:20,237 [ERROR] Error processing pending feedback record 851: index 2 is out of bounds for axis 0 with size 1
2025-03-27 09:12:20,237 [ERROR] Error processing pending feedback record 852: index 2 is out of bounds for axis 0 with size 1
2025-03-27 09:12:20,237 [ERROR] Error processing pending feedback record 853: index 2 is out of bounds for axis 0 with size 1
2025-03-27 09:12:20,237 [ERROR] Error processing pending feedback record 854: index 2 is out of bounds for axis 0 with size 1
2025-03-27 09:12:20,237 [ERROR] Error processing pending feedback record 855: index 2 is out of bounds for axis 0 with size 1
2025-03-27 09:12:20,237 [ERROR] Error processing pending feedback record 856: index 2 is out of bounds for axis 0 with size 1
2025-03-27 09:12:20,237 [ERROR] Error processing pending feedback record 857: index 2 is out of bounds for axis 0 with size 1
2025-03-27 09:12:20,237 [ERROR] Error processing pending feedback record 858: index 2 is out of bounds for axis 0 with size 1
2025-03-27 09:12:20,237 [ERROR] Error processing pending feedback record 859: index 2 is out of bounds for axis 0 with size 1
2025-03-27 09:12:20,238 [ERROR] Error processing pending feedback record 860: index 2 is out of bounds for axis 0 with size 1
2025-03-27 09:12:20,238 [ERROR] Error processing pending feedback record 861: index 2 is out of bounds for axis 0 with size 1
2025-03-27 09:12:20,238 [ERROR] Error processing pending feedback record 862: index 2 is out of bounds for axis 0 with size 1
2025-03-27 09:12:20,238 [ERROR] Error processing pending feedback record 863: index 2 is out of bounds for axis 0 with size 1
2025-03-27 09:12:20,238 [ERROR] Error processing pending feedback record 864: index 2 is out of bounds for axis 0 with size 1
2025-03-27 09:12:20,238 [ERROR] Error processing pending feedback record 865: index 2 is out of bounds for axis 0 with size 1
2025-03-27 09:12:20,238 [ERROR] Error processing pending feedback record 866: index 2 is out of bounds for axis 0 with size 1
2025-03-27 09:12:20,238 [ERROR] Error processing pending feedback record 867: index 2 is out of bounds for axis 0 with size 1
2025-03-27 09:12:20,238 [ERROR] Error processing pending feedback record 868: index 2 is out of bounds for axis 0 with size 1
2025-03-27 09:12:20,238 [ERROR] Error processing pending feedback record 869: index 2 is out of bounds for axis 0 with size 1
2025-03-27 09:12:20,238 [ERROR] Error processing pending feedback record 870: index 2 is out of bounds for axis 0 with size 1
2025-03-27 09:12:20,239 [ERROR] Error processing pending feedback record 871: index 2 is out of bounds for axis 0 with size 1
2025-03-27 09:12:20,239 [ERROR] Error processing pending feedback record 872: index 2 is out of bounds for axis 0 with size 1
2025-03-27 09:12:20,239 [ERROR] Error processing pending feedback record 873: index 2 is out of bounds for axis 0 with size 1
2025-03-27 09:12:20,239 [ERROR] Error processing pending feedback record 874: index 2 is out of bounds for axis 0 with size 1
2025-03-27 09:12:20,239 [ERROR] Error processing pending feedback record 875: index 2 is out of bounds for axis 0 with size 1
2025-03-27 09:12:20,239 [ERROR] Error processing pending feedback record 876: index 2 is out of bounds for axis 0 with size 1
2025-03-27 09:12:20,239 [ERROR] Error processing pending feedback record 877: index 2 is out of bounds for axis 0 with size 1
2025-03-27 09:12:20,239 [ERROR] Error processing pending feedback record 878: index 2 is out of bounds for axis 0 with size 1
2025-03-27 09:12:20,239 [ERROR] Error processing pending feedback record 879: index 2 is out of bounds for axis 0 with size 1
2025-03-27 09:12:20,240 [ERROR] Error processing pending feedback record 880: index 2 is out of bounds for axis 0 with size 1
2025-03-27 09:12:20,240 [ERROR] Error processing pending feedback record 881: index 2 is out of bounds for axis 0 with size 1
2025-03-27 09:12:20,240 [ERROR] Error processing pending feedback record 882: index 2 is out of bounds for axis 0 with size 1
2025-03-27 09:12:20,240 [ERROR] Error processing pending feedback record 883: index 2 is out of bounds for axis 0 with size 1
2025-03-27 09:12:20,240 [ERROR] Error processing pending feedback record 884: index 2 is out of bounds for axis 0 with size 1
2025-03-27 09:12:20,240 [ERROR] Error processing pending feedback record 885: index 2 is out of bounds for axis 0 with size 1
2025-03-27 09:12:20,240 [ERROR] Error processing pending feedback record 886: index 2 is out of bounds for axis 0 with size 1
2025-03-27 09:12:20,240 [ERROR] Error processing pending feedback record 887: index 2 is out of bounds for axis 0 with size 1
2025-03-27 09:12:20,240 [ERROR] Error processing pending feedback record 888: index 2 is out of bounds for axis 0 with size 1
2025-03-27 09:12:20,240 [ERROR] Error processing pending feedback record 889: index 2 is out of bounds for axis 0 with size 1
2025-03-27 09:12:20,240 [ERROR] Error processing pending feedback record 890: index 2 is out of bounds for axis 0 with size 1
2025-03-27 09:12:20,241 [ERROR] Error processing pending feedback record 891: index 2 is out of bounds for axis 0 with size 1
2025-03-27 09:12:20,241 [ERROR] Error processing pending feedback record 892: index 2 is out of bounds for axis 0 with size 1
2025-03-27 09:12:20,241 [ERROR] Error processing pending feedback record 893: index 2 is out of bounds for axis 0 with size 1
2025-03-27 09:12:20,241 [ERROR] Error processing pending feedback record 894: index 2 is out of bounds for axis 0 with size 1
2025-03-27 09:12:20,241 [ERROR] Error processing pending feedback record 895: index 2 is out of bounds for axis 0 with size 1
2025-03-27 09:12:20,241 [ERROR] Error processing pending feedback record 896: index 2 is out of bounds for axis 0 with size 1
2025-03-27 09:12:20,241 [ERROR] Error processing pending feedback record 897: index 2 is out of bounds for axis 0 with size 1
2025-03-27 09:12:20,241 [ERROR] Error processing pending feedback record 898: index 2 is out of bounds for axis 0 with size 1
2025-03-27 09:12:20,241 [ERROR] Error processing pending feedback record 899: index 2 is out of bounds for axis 0 with size 1
2025-03-27 09:12:20,241 [ERROR] Error processing pending feedback record 900: index 2 is out of bounds for axis 0 with size 1
2025-03-27 09:12:20,241 [ERROR] Error processing pending feedback record 901: index 2 is out of bounds for axis 0 with size 1
2025-03-27 09:12:20,241 [ERROR] Error processing pending feedback record 902: index 2 is out of bounds for axis 0 with size 1
2025-03-27 09:12:20,242 [ERROR] Error processing pending feedback record 903: index 2 is out of bounds for axis 0 with size 1
2025-03-27 09:12:20,242 [ERROR] Error processing pending feedback record 904: index 2 is out of bounds for axis 0 with size 1
2025-03-27 09:12:20,242 [ERROR] Error processing pending feedback record 905: index 2 is out of bounds for axis 0 with size 1
2025-03-27 09:12:20,242 [ERROR] Error processing pending feedback record 906: index 2 is out of bounds for axis 0 with size 1
2025-03-27 09:12:20,242 [ERROR] Error processing pending feedback record 907: index 2 is out of bounds for axis 0 with size 1
2025-03-27 09:12:20,242 [ERROR] Error processing pending feedback record 908: index 2 is out of bounds for axis 0 with size 1
2025-03-27 09:12:20,242 [ERROR] Error processing pending feedback record 909: index 2 is out of bounds for axis 0 with size 1
2025-03-27 09:12:20,242 [ERROR] Error processing pending feedback record 910: index 2 is out of bounds for axis 0 with size 1
2025-03-27 09:12:20,242 [ERROR] Error processing pending feedback record 911: index 2 is out of bounds for axis 0 with size 1
2025-03-27 09:12:20,242 [ERROR] Error processing pending feedback record 912: index 2 is out of bounds for axis 0 with size 1
2025-03-27 09:12:20,242 [ERROR] Error processing pending feedback record 913: index 2 is out of bounds for axis 0 with size 1
2025-03-27 09:12:20,242 [ERROR] Error processing pending feedback record 914: index 2 is out of bounds for axis 0 with size 1
2025-03-27 09:12:20,243 [ERROR] Error processing pending feedback record 915: index 2 is out of bounds for axis 0 with size 1
2025-03-27 09:12:20,243 [ERROR] Error processing pending feedback record 916: index 2 is out of bounds for axis 0 with size 1
2025-03-27 09:12:20,243 [ERROR] Error processing pending feedback record 917: index 2 is out of bounds for axis 0 with size 1
2025-03-27 09:12:20,243 [ERROR] Error processing pending feedback record 918: index 2 is out of bounds for axis 0 with size 1
2025-03-27 09:12:20,243 [ERROR] Error processing pending feedback record 919: index 2 is out of bounds for axis 0 with size 1
2025-03-27 09:12:20,243 [INFO] No pending feedback records met the criteria for update.
